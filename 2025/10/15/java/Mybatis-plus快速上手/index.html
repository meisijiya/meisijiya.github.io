<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="è€æ±Ÿæ¹–">


    <meta name="subtitle" content="è®°å½•è¿›å…¥æˆ¿é—´é—¨åçš„ç¾å¥½">


    <meta name="description" content="ä¸€å¹´å‰ï¼Œå­¤è‹¦ä¼¶ä»ƒçš„è€æ±Ÿæ¹–ï¼Œå¶ç„¶é—´å‘ç°ä¸€å¤„æˆ¿é—´é—¨ï¼Œæ¨é—¨è€Œå…¥ï¼Œä»æ­¤è¿›å…¥äº†å……æ»¡å¹¸ç¦çš„ä¸–ç•Œã€‚">


    <meta name="keywords" content="è€æ±Ÿæ¹–,åšå®¢,æˆ¿é—´é—¨">


<title>Mybatis-pluså¿«é€Ÿä¸Šæ‰‹ | æ¬¢è¿æ¥åˆ°è€æ±Ÿæ¹–çš„åšå®¢</title>



    <link rel="icon" href="/images/%E9%87%91%E6%AF%9B.png?_t=1758006391547">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    
    <link rel="stylesheet" href="/css/search.css">
    

<!-- highlight.js æ ·å¼ï¼ˆé»˜è®¤äº®è‰²ï¼‰ -->
<link id="hljs-theme" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/github.css">
<!-- highlight.js è‡ªåŠ¨ä¸Šè‰²åŠŸèƒ½ -->
<script src="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/lib/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<link rel="stylesheet" href="/css/custom.css">



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const pagebody = document.getElementsByTagName('body')[0]

            function setTheme(status) {

                if (status === 'dark') {
                    window.sessionStorage.theme = 'dark'
                    pagebody.classList.add('dark-theme');

                } else if (status === 'light') {
                    window.sessionStorage.theme = 'light'
                    pagebody.classList.remove('dark-theme');
                }
            };

            setTheme(window.sessionStorage.theme)
        })();
    </script>

    <div class="wrapper">
        <header>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-header header-logo">
        <a href="/">è€æ±Ÿæ¹–çš„åšå®¢</a>
      </div>
      <div class="menu navbar-right">
        <!-- åœ¨ç”µè„‘ç«¯çš„å¯¼èˆªé“¾æ¥åŒºåŸŸæ·»åŠ æœç´¢åŠŸèƒ½ -->
        <div class="search-container">
          <a href="javascript:;" onclick="toggleSearchInput()">ğŸ”</a>
          <input
            type="text"
            id="nav-search-input-desktop"
            class="nav-search-input"
            placeholder="æƒ³çŸ¥é“æˆ‘ä»€ä¹ˆç§˜å¯†å‘¢ï¼Œæœæœçœ‹å§"
            oninput="navSearch(this)"
          />
          <div id="nav-search-result-desktop" class="nav-search-result"></div>
        </div>

        
        <a class="menu-item" href="/archives">å½’æ¡£</a>
        
        <a class="menu-item" href="/category">åˆ†ç±»</a>
        
        <a class="menu-item" href="/tag">æ ‡ç­¾</a>
        
        <a class="menu-item" href="/Timer">ä»»åŠ¡è®¡æ—¶å™¨</a>
        
        <a class="menu-item" href="/timeLine">æ—¶é—´çº¿</a>
        
        <a class="menu-item" href="/tongji">ç½‘ç«™ç»Ÿè®¡</a>
        
        <a class="menu-item" href="/about">å…³äº</a>
        

        <input id="switch_default" type="checkbox" class="switch_default" />
        <label for="switch_default" class="toggleBtn"></label>
      </div>
    </div>
  </nav>

  
  <nav class="navbar-mobile" id="nav-mobile">
    <div class="container">
      <div class="navbar-header">
        <div>
          <a href="/">è€æ±Ÿæ¹–çš„åšå®¢</a
          ><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
        </div>

        <div class="menu-toggle" onclick="mobileBtn()">
          <svg
            class="menu-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="32"
            height="32"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M4.5 17.27q-.213 0-.356-.145T4 16.768t.144-.356t.356-.143h15q.213 0 .356.144q.144.144.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.144T4 11.999t.144-.356t.356-.143h15q.213 0 .356.144t.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.143Q4 7.443 4 7.23t.144-.356t.356-.143h15q.213 0 .356.144T20 7.23t-.144.356t-.356.144z"
            />
          </svg>
          <svg
            class="close-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="32"
            height="32"
            viewBox="0 0 24 24"
          >
            <!-- Icon from Material Symbols Light by Google - https://github.com/google/material-design-icons/blob/master/LICENSE -->
            <path
              fill="currentColor"
              d="m12 12.708l-5.246 5.246q-.14.14-.344.15t-.364-.15t-.16-.354t.16-.354L11.292 12L6.046 6.754q-.14-.14-.15-.344t.15-.364t.354-.16t.354.16L12 11.292l5.246-5.246q.14-.14.345-.15q.203-.01.363.15t.16.354t-.16.354L12.708 12l5.246 5.246q.14.14.15.345q.01.203-.15.363t-.354.16t-.354-.16z"
            />
          </svg>
        </div>
      </div>

      <div class="menu" id="mobile-menu">
        
        <a class="menu-item" href="/archives">å½’æ¡£</a>
        
        <a class="menu-item" href="/category">åˆ†ç±»</a>
        
        <a class="menu-item" href="/tag">æ ‡ç­¾</a>
        
        <a class="menu-item" href="/Timer">ä»»åŠ¡è®¡æ—¶å™¨</a>
        
        <a class="menu-item" href="/timeLine">æ—¶é—´çº¿</a>
        
        <a class="menu-item" href="/tongji">ç½‘ç«™ç»Ÿè®¡</a>
        
        <a class="menu-item" href="/about">å…³äº</a>
        
        <!-- æ‰‹æœºæ¨¡å¼æœç´¢æ¡† -->
        <div class="search-container mobile-container">
          <a class="menu-item" href="javascript:;" onclick="toggleSearchInput()"
            >ğŸ”</a
          >
          <input
            type="text"
            id="nav-search-input-mobile"
            class="nav-search-input"
            placeholder="æƒ³çŸ¥é“æˆ‘ä»€ä¹ˆç§˜å¯†å‘¢ï¼Œæœæœçœ‹å§"
            oninput="navSearch(this)"
          />
          <div id="nav-search-result-mobile" class="nav-search-result"></div>
        </div>
      </div>
    </div>
  </nav>
</header>
<script>
  var mobileBtn = function f() {
    var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
    var mobileMenu = document.getElementById("mobile-menu");
    if (toggleMenu.classList.contains("active")) {
      toggleMenu.classList.remove("active");
      mobileMenu.classList.remove("active");
    } else {
      toggleMenu.classList.add("active");
      mobileMenu.classList.add("active");
    }
  };

  function toggleSearchInput() {
    const inputs = document.querySelectorAll(".nav-search-input");
    const results = document.querySelectorAll(".nav-search-result");
    inputs.forEach((input) => {
      input.classList.toggle("active");
      if (input.classList.contains("active")) input.focus();
    });
    results.forEach((r) => (r.style.display = "none"));
  }

  // ç‚¹å‡»å¤–éƒ¨åŒºåŸŸéšè—æœç´¢æ¡†å’Œç»“æœå®¹å™¨çš„å‡½æ•°
  function handleClickOutsideSearch(event) {
    const searchContainers = document.querySelectorAll(".search-container");
    searchContainers.forEach((container) => {
      const searchInput = container.querySelector(".nav-search-input");
      const searchIcon = container.querySelector("a");

      // å¦‚æœç‚¹å‡»çš„å…ƒç´ ä¸æ˜¯æœç´¢è¾“å…¥æ¡†æˆ–æœç´¢å›¾æ ‡ï¼Œåˆ™éšè—æœç´¢æ¡†å’Œç»“æœå®¹å™¨
      if (
        !searchInput.contains(event.target) &&
        !searchIcon.contains(event.target)
      ) {
        searchInput.classList.remove("active");
        searchInput.value = ""
        // æ ¹æ®è¾“å…¥æ¡†IDç¡®å®šå¯¹åº”çš„ç»“æœå®¹å™¨
        let resultContainer;
        if (searchInput.id === "nav-search-input-mobile") {
          // ç§»åŠ¨ç«¯ç»“æœå®¹å™¨
          resultContainer = document.querySelector(
            ".navbar-mobile .nav-search-result"
          );
        } else {
          // æ¡Œé¢ç«¯ç»“æœå®¹å™¨
          resultContainer = document.getElementById(
            "nav-search-result-desktop"
          );
        }

        if (resultContainer) {
          resultContainer.style.display = "none";
          resultContainer.innerHTML = ""; // æ¸…ç©ºç»“æœå®¹å™¨å†…å®¹
        }
      }
    });
  }

  // æ·»åŠ å…¨å±€ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
  document.addEventListener("click", function (event) {
    handleClickOutsideSearch(event);
  });

  // æ–°å¢ï¼šæœç´¢åŠŸèƒ½å®ç°
  let searchData = []; // å…¨å±€å˜é‡å­˜å‚¨æœç´¢æ•°æ®

  // é¡µé¢åŠ è½½å®Œæˆåè·å–æœç´¢æ•°æ®
  document.addEventListener("DOMContentLoaded", function () {
    fetch("/search.xml")
      .then((res) => res.text())
      .then((xmlText) => {
        const parser = new DOMParser();
        const xml = parser.parseFromString(xmlText, "text/xml");
        const entries = xml.getElementsByTagName("entry");
        for (let entry of entries) {
          searchData.push({
            title: entry.getElementsByTagName("title")[0]?.textContent || "",
            content:
              entry.getElementsByTagName("content")[0]?.textContent || "",
            url: entry.getElementsByTagName("url")[0]?.textContent || "",
          });
        }
      })
      .catch((err) => {
        console.error("Failed to load search data:", err);
      });
  });

  // æ–°å¢ï¼šå¯¼èˆªæœç´¢æ–¹æ³•
  function navSearch(inputElement) {
    const keyword = inputElement.value.trim().toLowerCase();
    // æŸ¥æ‰¾å¯¹åº”çš„æœç´¢ç»“æœå®¹å™¨
    let resultContainer;

    if (inputElement.id === "nav-search-input-desktop") {
      // æ¡Œé¢ç«¯
      resultContainer = document.getElementById("nav-search-result-desktop");
    } else if (inputElement.id === "nav-search-input-mobile") {
      // ç§»åŠ¨ç«¯
      resultContainer =
        inputElement.parentNode.querySelector(".nav-search-result");
    }

    if (!resultContainer) return;

    resultContainer.innerHTML = "";

    if (!keyword) {
      resultContainer.style.display = "none";
      return;
    }

    // æ˜¾ç¤ºç»“æœå®¹å™¨
    resultContainer.style.display = "block";

    // è¿‡æ»¤æœç´¢æ•°æ®
    const results = searchData.filter(
      (data) =>
        (data.title && data.title.toLowerCase().includes(keyword)) ||
        (data.content && data.content.toLowerCase().includes(keyword))
    );

    if (results.length === 0) {
      resultContainer.innerHTML =
        '<p class="no-result">æ²¡æœ‰ç»“æœå“Ÿï¼Œæ¢ä¸ªå…³é”®è¯è¯•è¯•å§</p>';
      return;
    }

    // é™åˆ¶æ˜¾ç¤ºç»“æœæ•°é‡
    const maxResults = 10;
    const limitedResults = results.slice(0, maxResults);

    // æ„å»ºç»“æœHTML
    const html = limitedResults
      .map((item) => {
        // æå–åŒ…å«å…³é”®å­—çš„å†…å®¹ç‰‡æ®µ
        let contentSnippet = "";
        if (item.content) {
          // æ‰¾åˆ°åŒ…å«å…³é”®å­—çš„å†…å®¹ç‰‡æ®µ
          const contentLower = item.content.toLowerCase();
          const keywordIndex = contentLower.indexOf(keyword);

          // æå–å…³é”®å­—å‰åçš„å†…å®¹
          const start = Math.max(0, keywordIndex - 3 * keyword.length);
          const end = Math.min(
            item.content.length,
            keywordIndex + 3 * keyword.length
          );
          contentSnippet = item.content.substring(start, end);
        // é«˜äº®å…³é”®å­—
      const keywordRegex = new RegExp(`(${keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
      contentSnippet = contentSnippet.replace(
        keywordRegex,
        "<mark>$1</mark>"
      );
        }

        return `<div class="search-result-item">
  <a href="${item.url}">
    <div>æ ‡é¢˜ï¼š${item.title}</div>
    <div>å†…å®¹ï¼š${contentSnippet}</div>
  </a>
</div>`;
      })
      .join("");
    resultContainer.innerHTML = html;
  }
</script>
<style>
  /* æ‰‹æœºç«¯ä½¿ç”¨flexboxå¸ƒå±€æœç´¢å®¹å™¨ */
  .mobile-container {
    display: flex;
    align-items: center;
    flex-direction: row;
    margin-bottom: 10px;
    margin-left: 10px;
    flex-grow: 1;
    max-width: calc(100% - 40px);
  }


  .search-result-item {
  border: 1px solid #ddd; /* è¾¹æ¡† */
  margin: 4px 0; /* å¤–å±‚é—´è· */
  padding: 0; /* æ— å†…è¾¹è· */
  background: #fff; /* èƒŒæ™¯è‰² */
}

.search-result-item a {
  display: block;
  text-decoration: none;
  color: inherit;
}

.search-result-item div {
  padding: 3px 8px; /* ç´§å‡‘çš„å†…è¾¹è· */
  margin: 0; /* æ— å¤–è¾¹è· */
  line-height: 1.3; /* ç´§å‡‘çš„è¡Œé«˜ */
  word-wrap: break-word; /* å…è®¸é•¿å•è¯æ¢è¡Œ */
  white-space: normal; /* å…è®¸æ­£å¸¸æ¢è¡Œ */
}

.search-result-item div:first-child {
  border-bottom: 1px solid #eee; /* æ ‡é¢˜å’Œå†…å®¹ä¹‹é—´çš„åˆ†éš”çº¿ */
}


</style>

            <div class="main">
                <div class="container">
    <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">å±•å¼€æ‰€æœ‰</a>
        <a onclick="go_top()">è¿”å›é¡¶éƒ¨</a>
        <a onclick="go_bottom()">è¿”å›åº•éƒ¨</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // ä¸º 6 æ—¶å±•å¼€æ‰€æœ‰
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // è¿™ä¸ªå€¼æ˜¯ç”± tocbot æºç é‡Œå®šä¹‰çš„ scrollSmoothDuration å¾—æ¥çš„
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'å±•å¼€æ‰€æœ‰' : 'æŠ˜å æ‰€æœ‰';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>  
  <article class="post-wrap">
    <header class="post-header">
      <h1 class="post-title">Mybatis-pluså¿«é€Ÿä¸Šæ‰‹</h1>
      
      <div class="post-meta">
         ä½œè€…:
        <a itemprop="author" rel="author" href="/">è€æ±Ÿæ¹–</a>
         
        <span class="post-time">
          <br />æ—¥æœŸ:
          <a href="#"
            >åæœˆ 15, 2025&nbsp;&nbsp;1:03:45</a
          >
        </span>
         
        <span class="post-category"
          ><br />
          åˆ†ç±»: 
          <a href="/categories/java/">java</a>
          
        </span>
        
      </div>
      
    </header>

    <div class="post-content"><hr>
<h2 id="ä¸€ã€ç¯å¢ƒè¯´æ˜"><a href="#ä¸€ã€ç¯å¢ƒè¯´æ˜" class="headerlink" title="ä¸€ã€ç¯å¢ƒè¯´æ˜"></a>ä¸€ã€ç¯å¢ƒè¯´æ˜</h2><ul>
<li><strong>æŠ€æœ¯æ ˆç‰ˆæœ¬</strong>ï¼šSpringBoot3ã€JDK17ã€IntelliJ IDEAã€MyBatisPlus 3.5.11</li>
<li>æ ¸å¿ƒä¾èµ–ï¼ˆå…³é”®ç‰ˆæœ¬ï¼‰ï¼š<ul>
<li><code>mybatis-plus-spring-boot3-starter:3.5.11</code></li>
<li><code>mysql-connector-java:8.0.33</code></li>
<li><code>hutool-all:5.8.22</code></li>
<li><code>lombok</code>ï¼ˆç®€åŒ–å®ä½“ç±»ï¼‰</li>
</ul>
</li>
</ul>
<h2 id="äºŒã€æ ¸å¿ƒç« èŠ‚å†…å®¹ï¼ˆ12-ç« ï¼‰"><a href="#äºŒã€æ ¸å¿ƒç« èŠ‚å†…å®¹ï¼ˆ12-ç« ï¼‰" class="headerlink" title="äºŒã€æ ¸å¿ƒç« èŠ‚å†…å®¹ï¼ˆ12 ç« ï¼‰"></a>äºŒã€æ ¸å¿ƒç« èŠ‚å†…å®¹ï¼ˆ12 ç« ï¼‰</h2><h3 id="ç¬¬-1-ç« ï¼šå¿«é€Ÿå…¥é—¨"><a href="#ç¬¬-1-ç« ï¼šå¿«é€Ÿå…¥é—¨" class="headerlink" title="ç¬¬ 1 ç« ï¼šå¿«é€Ÿå…¥é—¨"></a>ç¬¬ 1 ç« ï¼šå¿«é€Ÿå…¥é—¨</h3><h4 id="1-1-MyBatis-Plus-ç®€ä»‹"><a href="#1-1-MyBatis-Plus-ç®€ä»‹" class="headerlink" title="1.1 MyBatis-Plus ç®€ä»‹"></a>1.1 MyBatis-Plus ç®€ä»‹</h4><p>æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ul>
<li>æ— ä¾µå…¥ï¼šä¸æ”¹å˜ç°æœ‰å·¥ç¨‹ç»“æ„</li>
<li>æŸè€—å°ï¼šå¯åŠ¨è‡ªåŠ¨æ³¨å…¥åŸºç¡€ CRUDï¼Œæ€§èƒ½æ— æ„ŸçŸ¥æŸè€—</li>
<li>å¼º CRUDï¼šå†…ç½®é€šç”¨ Mapperã€é€šç”¨ Service</li>
<li>æ”¯æŒ Lambda è°ƒç”¨ï¼šé¿å…å­—æ®µç¡¬ç¼–ç </li>
<li>å†…ç½®ä»£ç ç”Ÿæˆå™¨ã€åˆ†é¡µæ’ä»¶ï¼ˆæ”¯æŒå¤šæ•°æ®åº“ï¼‰</li>
</ul>
<h4 id="1-2-ç¯å¢ƒå‡†å¤‡"><a href="#1-2-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1.2 ç¯å¢ƒå‡†å¤‡"></a>1.2 ç¯å¢ƒå‡†å¤‡</h4><ol>
<li><p>å»ºåº“å»ºè¡¨ SQLï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE `mybatis_plus_demo` <span class="keyword">DEFAULT</span> <span class="keyword">CHARACTER SET</span> utf8mb4;</span><br><span class="line"><span class="keyword">CREATE TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `email` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `status` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `update_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">1571093847</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®æ–‡ä»¶ï¼ˆapplication.ymlï¼‰ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://ä½ çš„æ•°æ®åº“åœ°å€?useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="string">log-impl:org.apache.ibatis.logging.stdout.StdOutImpl</span> <span class="comment"># æ‰“å°SQL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ ¸å¿ƒä»£ç ï¼š</p>
<ul>
<li><p><strong>å®ä½“ç±»</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(value = &quot;user&quot;, autoResultMap = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"> 	<span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">     <span class="keyword">private</span> Integer id;</span><br><span class="line">     <span class="keyword">private</span> String name;</span><br><span class="line">     <span class="keyword">private</span> Integer age;</span><br><span class="line">     <span class="keyword">private</span> String email;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Mapper æ¥å£</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>å¯åŠ¨ç±»</strong>ï¼šæ·»åŠ <code>@MapperScan(&quot;com.lglbc.mybatisplusdemo.mapper&quot;)</code></p>
</li>
</ul>
</li>
</ol>
<h4 id="1-3-åŸºç¡€-CRUD-æ“ä½œï¼ˆæµ‹è¯•ç”¨ä¾‹ï¼‰"><a href="#1-3-åŸºç¡€-CRUD-æ“ä½œï¼ˆæµ‹è¯•ç”¨ä¾‹ï¼‰" class="headerlink" title="1.3 åŸºç¡€ CRUD æ“ä½œï¼ˆæµ‹è¯•ç”¨ä¾‹ï¼‰"></a>1.3 åŸºç¡€ CRUD æ“ä½œï¼ˆæµ‹è¯•ç”¨ä¾‹ï¼‰</h4><ul>
<li><p>æ’å…¥ï¼š<code>userMapper.insert(user)</code></p>
<ul>
<li><pre><code class="java">@Test
 public void testInsert() &#123;
 User user = new User();
        user.setAge(10);
        user.setName(&quot;ljh&quot;);
        user.setEmail(&quot;ljh@fjm&quot;);
        userMapper.insert(user);
 &#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- æŸ¥è¯¢ï¼š`selectById(id)`ã€`selectList(null)`ï¼ˆæŸ¥æ‰€æœ‰ï¼‰</span><br><span class="line"></span><br><span class="line">  - ```java</span><br><span class="line">    // æ ¹æ®IDæŸ¥è¯¢</span><br><span class="line">    @Test</span><br><span class="line">     public void testSelectById() &#123;</span><br><span class="line">     User user = userMapper.selectById(12);</span><br><span class="line">     System.out.println(user);</span><br><span class="line">     &#125;</span><br><span class="line">     // æŸ¥è¯¢æ‰€æœ‰</span><br><span class="line">    @Test</span><br><span class="line">     public void testSelect() &#123;</span><br><span class="line">     List&lt;User&gt; users = userMapper.selectList(null);</span><br><span class="line">            users.forEach(System.out::println);</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
<li><p>æ›´æ–°ï¼š<code>updateById(user)</code></p>
<ul>
<li><pre><code class="java">@Test
 public void testUpdate() &#123;
 User user = userMapper.selectById(12);
        user.setName(&quot;æ›´æ–°&quot;);
        userMapper.updateById(user);
 &#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- åˆ é™¤ï¼š`deleteById(id)`</span><br><span class="line"></span><br><span class="line">  - ```java</span><br><span class="line">    @Test</span><br><span class="line">     public void testDelete() &#123;</span><br><span class="line">            userMapper.deleteById(1);</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="ç¬¬-2-ç« ï¼šIService-æ¥å£"><a href="#ç¬¬-2-ç« ï¼šIService-æ¥å£" class="headerlink" title="ç¬¬ 2 ç« ï¼šIService æ¥å£"></a>ç¬¬ 2 ç« ï¼šIService æ¥å£</h3><h4 id="2-1-åŸºç¡€é…ç½®"><a href="#2-1-åŸºç¡€é…ç½®" class="headerlink" title="2.1 åŸºç¡€é…ç½®"></a>2.1 åŸºç¡€é…ç½®</h4><ul>
<li><p>Service æ¥å£ï¼š</p>
<ul>
<li><pre><code class="java">public interface UserService extends IService&lt;User&gt; &#123;
     // å¯ä»¥åœ¨æ­¤æ·»åŠ â¾ƒå®šä¹‰â½…æ³•
    List&lt;User&gt; selectByAgeRange(Integer minAge, Integer maxAge);
&#125;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- Service å®ç°ç±»ï¼š</span><br><span class="line"></span><br><span class="line">  - ```java</span><br><span class="line">    @Service</span><br><span class="line">     public class UserServiceImpl extends ServiceImpl&lt;UserMapper, User&gt; implements UserService &#123;</span><br><span class="line">         @Override</span><br><span class="line">         public List&lt;User&gt; selectByAgeRange(Integer minAge, Integer maxAge) &#123;</span><br><span class="line">             LambdaQueryWrapper&lt;User&gt; wrapper = new LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">             wrapper.between(User::getAge, minAge, maxAge);</span><br><span class="line">             return this.list(wrapper);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 id="2-2-IService-æ ¸å¿ƒæ–¹æ³•æ¼”ç¤ºï¼ˆå«æ‰¹é‡-é“¾å¼ï¼‰"><a href="#2-2-IService-æ ¸å¿ƒæ–¹æ³•æ¼”ç¤ºï¼ˆå«æ‰¹é‡-é“¾å¼ï¼‰" class="headerlink" title="2.2 IService æ ¸å¿ƒæ–¹æ³•æ¼”ç¤ºï¼ˆå«æ‰¹é‡ &#x2F; é“¾å¼ï¼‰"></a>2.2 IService æ ¸å¿ƒæ–¹æ³•æ¼”ç¤ºï¼ˆå«æ‰¹é‡ &#x2F; é“¾å¼ï¼‰</h4><table>
<thead>
<tr>
<th>æ“ä½œç±»å‹</th>
<th>å…³é”®æ–¹æ³•</th>
</tr>
</thead>
<tbody><tr>
<td>ä¿å­˜</td>
<td><code>save(user)</code>ï¼ˆå•æ¡ï¼‰ã€<code>saveBatch(users, 1000)</code>ï¼ˆæ‰¹é‡ï¼Œæ¯ 1000 æ¡ä¸€æ‰¹ï¼‰</td>
</tr>
<tr>
<td>ä¿å­˜æˆ–æ›´æ–°</td>
<td><code>saveOrUpdate(user)</code>ï¼ˆæŒ‰ ID åˆ¤æ–­ï¼‰ã€<code>saveOrUpdateBatch(users)</code></td>
</tr>
<tr>
<td>åˆ é™¤</td>
<td><code>removeById(id)</code>ã€<code>removeByMap(map)</code>ã€<code>remove(wrapper)</code>ã€<code>removeByIds(ids)</code></td>
</tr>
<tr>
<td>æ›´æ–°</td>
<td><code>updateById(user)</code>ã€<code>update(wrapper)</code>ï¼ˆæ¡ä»¶æ›´æ–°ï¼‰ã€<code>updateBatchById(users)</code></td>
</tr>
<tr>
<td>æŸ¥è¯¢</td>
<td><code>getById(id)</code>ã€<code>getOne(wrapper)</code>ã€<code>list()</code>ã€<code>list(wrapper)</code>ã€<code>count(wrapper)</code></td>
</tr>
<tr>
<td>åˆ†é¡µ</td>
<td>é…ç½®<code>PaginationInnerInterceptor</code>åï¼Œè°ƒç”¨<code>page(new Page&lt;&gt;(1,2), wrapper)</code></td>
</tr>
</tbody></table>
<p>IService æ¥å£æä¾›äº†æ¯” BaseMapper æ›´ä¸°å¯Œçš„ CRUD æ“ä½œï¼Œä»¥ä¸‹é€šè¿‡å…·ä½“æµ‹è¯•ç”¨ä¾‹ï¼ˆåŸºäº JUnitï¼‰æ¼”ç¤ºå„æ ¸å¿ƒæ–¹æ³•çš„ä½¿ç”¨ï¼Œæ‰€æœ‰ç¤ºä¾‹å‡æ¥è‡ªè¯¾ç¨‹æ–‡æ¡£ä¸­çš„å®æˆ˜ä»£ç ã€‚</p>
<h5 id="ä¸€ã€ä¿å­˜æ“ä½œ"><a href="#ä¸€ã€ä¿å­˜æ“ä½œ" class="headerlink" title="ä¸€ã€ä¿å­˜æ“ä½œ"></a>ä¸€ã€ä¿å­˜æ“ä½œ</h5><p>åŒ…å«å•æ¡æ•°æ®ä¿å­˜ä¸æ‰¹é‡æ•°æ®ä¿å­˜ï¼Œæ‰¹é‡ä¿å­˜å¯æŒ‡å®šæ¯æ‰¹å¤„ç†æ¡æ•°ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. æµ‹è¯•ä¿å­˜å•ä¸ªå®ä½“</span></span><br><span class="line"><span class="meta">@Test</span> </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSave</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(); </span><br><span class="line">    user.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>); </span><br><span class="line">    user.setAge(<span class="number">25</span>); </span><br><span class="line">    user.setEmail(<span class="string">&quot;zhangsan@example.com&quot;</span>); </span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.save(user); <span class="comment">// å•æ¡ä¿å­˜æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;ä¿å­˜ç»“æœ: &quot;</span> + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æµ‹è¯•æ‰¹é‡ä¿å­˜ï¼ˆæ¯1000æ¡ä¸ºä¸€æ‰¹ï¼Œé¿å…å†…å­˜æº¢å‡ºï¼‰</span></span><br><span class="line"><span class="meta">@Test</span> </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSaveBatch</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(); </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setName(<span class="string">&quot;ç”¨æˆ·&quot;</span> + i); </span><br><span class="line">        user.setAge(<span class="number">20</span> + i); </span><br><span class="line">        users.add(user);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.saveBatch(users, <span class="number">1000</span>); <span class="comment">// æ‰¹é‡ä¿å­˜æ ¸å¿ƒæ–¹æ³•ï¼ˆæŒ‡å®šæ‰¹æ¬¡å¤§å°ï¼‰</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ‰¹é‡ä¿å­˜ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="äºŒã€ä¿å­˜æˆ–æ›´æ–°æ“ä½œ"><a href="#äºŒã€ä¿å­˜æˆ–æ›´æ–°æ“ä½œ" class="headerlink" title="äºŒã€ä¿å­˜æˆ–æ›´æ–°æ“ä½œ"></a>äºŒã€ä¿å­˜æˆ–æ›´æ–°æ“ä½œ</h5><p>æ ¹æ®å®ä½“æ˜¯å¦åŒ…å« ID è‡ªåŠ¨åˆ¤æ–­ï¼šID å­˜åœ¨åˆ™æ‰§è¡Œæ›´æ–°ï¼ŒID ä¸å­˜åœ¨åˆ™æ‰§è¡Œæ’å…¥ï¼Œæ”¯æŒå•æ¡ä¸æ‰¹é‡æ“ä½œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. å•æ¡ä¿å­˜æˆ–æ›´æ–°ï¼ˆæŒ‰IDåˆ¤æ–­ï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSaveOrUpdate</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(); </span><br><span class="line">    user.setId(<span class="number">1L</span>); <span class="comment">// IDå­˜åœ¨ï¼Œæ‰§è¡Œæ›´æ–°ï¼›IDä¸å­˜åœ¨ï¼Œæ‰§è¡Œæ’å…¥</span></span><br><span class="line">    user.setName(<span class="string">&quot;æ›´æ–°åçš„åå­—&quot;</span>);</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.saveOrUpdate(user); <span class="comment">// å•æ¡ä¿å­˜æˆ–æ›´æ–°æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;ä¿å­˜æˆ–æ›´æ–°ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ‰¹é‡ä¿å­˜æˆ–æ›´æ–°</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testSaveOrUpdateBatch</span><span class="params">()</span> &#123; </span><br><span class="line">    List&lt;User&gt; users = userService.list(); <span class="comment">// å…ˆæŸ¥è¯¢å·²æœ‰æ•°æ®</span></span><br><span class="line">    users.forEach(user -&gt; user.setName(user.getName() + <span class="string">&quot;_updated&quot;</span>)); <span class="comment">// æ‰¹é‡ä¿®æ”¹å­—æ®µ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.saveOrUpdateBatch(users); <span class="comment">// æ‰¹é‡ä¿å­˜æˆ–æ›´æ–°æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ‰¹é‡ä¿å­˜æˆ–æ›´æ–°ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ä¸‰ã€åˆ é™¤æ“ä½œ"><a href="#ä¸‰ã€åˆ é™¤æ“ä½œ" class="headerlink" title="ä¸‰ã€åˆ é™¤æ“ä½œ"></a>ä¸‰ã€åˆ é™¤æ“ä½œ</h5><p>æ”¯æŒæŒ‰ IDã€æŒ‰æ¡ä»¶ï¼ˆMap &#x2F; æ¡ä»¶æ„é€ å™¨ï¼‰ã€æ‰¹é‡åˆ é™¤ï¼Œè¦†ç›–å¤šç§åˆ é™¤åœºæ™¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. æ ¹æ®IDåˆ é™¤</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testRemoveById</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.removeById(<span class="number">1L</span>); <span class="comment">// æŒ‰IDåˆ é™¤æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;åˆ é™¤ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ ¹æ®Mapæ¡ä»¶åˆ é™¤ï¼ˆMapçš„keyä¸ºå­—æ®µåï¼Œvalueä¸ºå­—æ®µå€¼ï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testRemoveByMap</span><span class="params">()</span> &#123; </span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>); </span><br><span class="line">    map.put(<span class="string">&quot;age&quot;</span>, <span class="number">25</span>); <span class="comment">// æ¡ä»¶ï¼šname=å¼ ä¸‰ ä¸” age=25</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.removeByMap(map); <span class="comment">// æŒ‰Mapæ¡ä»¶åˆ é™¤æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ ¹æ®Mapæ¡ä»¶åˆ é™¤ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æ ¹æ®æ¡ä»¶æ„é€ å™¨åˆ é™¤ï¼ˆæ”¯æŒå¤æ‚æ¡ä»¶ï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testRemove</span><span class="params">()</span> &#123; </span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;(); </span><br><span class="line">    wrapper.eq(User::getName, <span class="string">&quot;å¼ ä¸‰&quot;</span>).gt(User::getAge, <span class="number">20</span>); <span class="comment">// æ¡ä»¶ï¼šname=å¼ ä¸‰ ä¸” age&gt;20</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.remove(wrapper); <span class="comment">// æŒ‰æ¡ä»¶æ„é€ å™¨åˆ é™¤æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ ¹æ®æ¡ä»¶æ„é€ å™¨åˆ é™¤ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. æ‰¹é‡åˆ é™¤ï¼ˆæŒ‰IDé›†åˆï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testRemoveByIds</span><span class="params">()</span> &#123; </span><br><span class="line">    List&lt;Long&gt; ids = Arrays.asList(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">3L</span>); <span class="comment">// å¾…åˆ é™¤çš„IDé›†åˆ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.removeByIds(ids); <span class="comment">// æ‰¹é‡åˆ é™¤æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ‰¹é‡åˆ é™¤ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="å››ã€æ›´æ–°æ“ä½œ"><a href="#å››ã€æ›´æ–°æ“ä½œ" class="headerlink" title="å››ã€æ›´æ–°æ“ä½œ"></a>å››ã€æ›´æ–°æ“ä½œ</h5><p>æ”¯æŒæŒ‰ IDã€æŒ‰æ¡ä»¶ï¼ˆæ¡ä»¶æ„é€ å™¨ï¼‰ã€æ‰¹é‡æ›´æ–°ï¼Œæ»¡è¶³ä¸åŒæ›´æ–°éœ€æ±‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. æ ¹æ®IDæ›´æ–°</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateById</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getById(<span class="number">1L</span>); <span class="comment">// å…ˆæŸ¥è¯¢å¾…æ›´æ–°æ•°æ®</span></span><br><span class="line">    user.setName(<span class="string">&quot;æ–°åå­—&quot;</span>); <span class="comment">// ä¿®æ”¹å­—æ®µ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.updateById(user); <span class="comment">// æŒ‰IDæ›´æ–°æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ›´æ–°ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ ¹æ®æ¡ä»¶æ›´æ–°ï¼ˆç»Ÿä¸€ä¿®æ”¹ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdate</span><span class="params">()</span> &#123; </span><br><span class="line">    UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;&gt;(); </span><br><span class="line">    wrapper.set(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;ç»Ÿä¸€æ–°åå­—&quot;</span>).gt(<span class="string">&quot;age&quot;</span>, <span class="number">20</span>); <span class="comment">// æ“ä½œï¼šnameè®¾ä¸º&quot;ç»Ÿä¸€æ–°åå­—&quot;ï¼›æ¡ä»¶ï¼šage&gt;20</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.update(wrapper); <span class="comment">// æŒ‰æ¡ä»¶æ›´æ–°æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ¡ä»¶æ›´æ–°ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æ‰¹é‡æ›´æ–°ï¼ˆæŒ‰IDé›†åˆæ‰¹é‡ä¿®æ”¹ï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testUpdateBatchById</span><span class="params">()</span> &#123; </span><br><span class="line">    List&lt;User&gt; users = userService.list(); <span class="comment">// å…ˆæŸ¥è¯¢å·²æœ‰æ•°æ®</span></span><br><span class="line">    users.forEach(user -&gt; user.setAge(user.getAge() + <span class="number">1</span>)); <span class="comment">// æ‰¹é‡ä¿®æ”¹ageå­—æ®µï¼ˆ+1ï¼‰</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.updateBatchById(users); <span class="comment">// æ‰¹é‡æ›´æ–°æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ‰¹é‡æ›´æ–°ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="äº”ã€æŸ¥è¯¢æ“ä½œ"><a href="#äº”ã€æŸ¥è¯¢æ“ä½œ" class="headerlink" title="äº”ã€æŸ¥è¯¢æ“ä½œ"></a>äº”ã€æŸ¥è¯¢æ“ä½œ</h5><p>è¦†ç›–å•æ¡æŸ¥è¯¢ã€åˆ—è¡¨æŸ¥è¯¢ã€æ•°é‡ç»Ÿè®¡ç­‰åœºæ™¯ï¼Œæ”¯æŒæŒ‰ IDã€æŒ‰æ¡ä»¶æŸ¥è¯¢ï¼Œä¸”å…¼å®¹ Lambda æ¡ä»¶æ„é€ å™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. æ ¹æ®IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testGetById</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getById(<span class="number">1L</span>); <span class="comment">// æŒ‰IDæŸ¥è¯¢æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ ¹æ®æ¡ä»¶æŸ¥è¯¢å•æ¡æ•°æ®ï¼ˆè‹¥æœ‰å¤šæ¡ï¼Œé»˜è®¤æŠ›å¼‚å¸¸ï¼Œå¯è®¾ç½®allowMultipleResults=trueå…è®¸è¿”å›ç¬¬ä¸€æ¡ï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testGetOne</span><span class="params">()</span> &#123; </span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;(); </span><br><span class="line">    wrapper.gt(User::getAge, <span class="number">20</span>); <span class="comment">// æ¡ä»¶ï¼šage&gt;20</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getOne(wrapper); <span class="comment">// æŒ‰æ¡ä»¶æŸ¥è¯¢å•æ¡æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æŸ¥è¯¢åˆ—è¡¨ï¼ˆæŸ¥è¯¢æ‰€æœ‰/æŒ‰æ¡ä»¶æŸ¥è¯¢ï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testList</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="comment">// 3.1 æŸ¥è¯¢æ‰€æœ‰æ•°æ®</span></span><br><span class="line">    List&lt;User&gt; users = userService.list(); <span class="comment">// æŸ¥è¯¢æ‰€æœ‰æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3.2 æŒ‰æ¡ä»¶æŸ¥è¯¢åˆ—è¡¨</span></span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;(); </span><br><span class="line">    wrapper.like(User::getName, <span class="string">&quot;å¼ &quot;</span>); <span class="comment">// æ¡ä»¶ï¼šnameåŒ…å«&quot;å¼ &quot;</span></span><br><span class="line">    List&lt;User&gt; filteredUsers = userService.list(wrapper); <span class="comment">// æŒ‰æ¡ä»¶æŸ¥è¯¢åˆ—è¡¨æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    filteredUsers.forEach(System.out::println);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. æŸ¥è¯¢è®°å½•æ€»æ•°ï¼ˆç»Ÿè®¡æ‰€æœ‰/æŒ‰æ¡ä»¶ç»Ÿè®¡ï¼‰</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testCount</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="comment">// 4.1 ç»Ÿè®¡æ‰€æœ‰è®°å½•æ•°</span></span><br><span class="line">    <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> userService.count(); <span class="comment">// ç»Ÿè®¡æ‰€æœ‰æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ€»è®°å½•æ•°: &quot;</span> + count);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 4.2 æŒ‰æ¡ä»¶ç»Ÿè®¡è®°å½•æ•°</span></span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;(); </span><br><span class="line">    wrapper.gt(User::getAge, <span class="number">20</span>); <span class="comment">// æ¡ä»¶ï¼šage&gt;20</span></span><br><span class="line">    <span class="type">long</span> <span class="variable">filteredCount</span> <span class="operator">=</span> userService.count(wrapper); <span class="comment">// æŒ‰æ¡ä»¶ç»Ÿè®¡æ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;å¹´é¾„å¤§äº20çš„è®°å½•æ•°:&quot;</span> + filteredCount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="å…­ã€åˆ†é¡µæŸ¥è¯¢æ“ä½œ"><a href="#å…­ã€åˆ†é¡µæŸ¥è¯¢æ“ä½œ" class="headerlink" title="å…­ã€åˆ†é¡µæŸ¥è¯¢æ“ä½œ"></a>å…­ã€åˆ†é¡µæŸ¥è¯¢æ“ä½œ</h5><p>éœ€å…ˆé…ç½®åˆ†é¡µæ’ä»¶ï¼ˆ<code>PaginationInnerInterceptor</code>ï¼‰ï¼Œå†é€šè¿‡ <code>page()</code> æ–¹æ³•å®ç°åˆ†é¡µï¼Œæ”¯æŒæ— æ¡ä»¶ &#x2F; æœ‰æ¡ä»¶åˆ†é¡µã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. é…ç½®åˆ†é¡µæ’ä»¶ï¼ˆå…¨å±€é…ç½®ï¼Œéœ€åœ¨é…ç½®ç±»ä¸­å£°æ˜ï¼‰</span></span><br><span class="line"><span class="meta">@Configuration</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123; </span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>()); <span class="comment">// æ³¨å†Œåˆ†é¡µæ’ä»¶</span></span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åˆ†é¡µæŸ¥è¯¢æµ‹è¯•</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testPage</span><span class="params">()</span> &#123; </span><br><span class="line">    Page&lt;User&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// æ„å»ºåˆ†é¡µå¯¹è±¡ï¼šå½“å‰é¡µï¼ˆ1ï¼‰ã€æ¯é¡µæ¡æ•°ï¼ˆ2ï¼‰</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2.1 æ— æ¡ä»¶åˆ†é¡µ</span></span><br><span class="line">    Page&lt;User&gt; result1 = userService.page(page); <span class="comment">// æ— æ¡ä»¶åˆ†é¡µæ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;æ€»è®°å½•æ•°:&quot;</span> + result1.getTotal()); </span><br><span class="line">    result1.getRecords().forEach(System.out::println); <span class="comment">// æ‰“å°å½“å‰é¡µæ•°æ®</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2.2 æœ‰æ¡ä»¶åˆ†é¡µ</span></span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;(); </span><br><span class="line">    wrapper.gt(User::getAge, <span class="number">20</span>); <span class="comment">// æ¡ä»¶ï¼šage&gt;20</span></span><br><span class="line">    Page&lt;User&gt; result2 = userService.page(page, wrapper); <span class="comment">// æœ‰æ¡ä»¶åˆ†é¡µæ ¸å¿ƒæ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">&quot;å¹´é¾„å¤§äº20çš„è®°å½•æ•°:&quot;</span> + result2.getTotal());</span><br><span class="line">    result2.getRecords().forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ä¸ƒã€é“¾å¼è°ƒç”¨æ“ä½œ"><a href="#ä¸ƒã€é“¾å¼è°ƒç”¨æ“ä½œ" class="headerlink" title="ä¸ƒã€é“¾å¼è°ƒç”¨æ“ä½œ"></a>ä¸ƒã€é“¾å¼è°ƒç”¨æ“ä½œ</h5><p>é€šè¿‡ Lambda é“¾å¼è¯­æ³•ç®€åŒ–æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤é€»è¾‘ï¼Œä»£ç æ›´ç®€æ´æ˜“è¯»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testChain</span><span class="params">()</span> &#123; </span><br><span class="line">    <span class="comment">// 1. æŸ¥è¯¢é“¾å¼è°ƒç”¨ï¼šage&gt;20 ä¸” nameåŒ…å«&quot;å¼ &quot;ï¼Œç›´æ¥è¿”å›åˆ—è¡¨</span></span><br><span class="line">    List&lt;User&gt; users = userService.lambdaQuery()</span><br><span class="line">                                  .gt(User::getAge, <span class="number">20</span>)</span><br><span class="line">                                  .like(User::getName, <span class="string">&quot;å¼ &quot;</span>)</span><br><span class="line">                                  .list();</span><br><span class="line">    users.forEach(System.out::println);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. æ›´æ–°é“¾å¼è°ƒç”¨ï¼šname=å¼ ä¸‰ çš„ç”¨æˆ·ï¼Œå°†ageè®¾ä¸º30</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">updateResult</span> <span class="operator">=</span> userService.lambdaUpdate()</span><br><span class="line">                                      .eq(User::getName, <span class="string">&quot;å¼ ä¸‰&quot;</span>)</span><br><span class="line">                                      .set(User::getAge, <span class="number">30</span>)</span><br><span class="line">                                      .update();</span><br><span class="line">    System.out.println(<span class="string">&quot;æ›´æ–°ç»“æœ:&quot;</span> + updateResult);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3. åˆ é™¤é“¾å¼è°ƒç”¨ï¼šname=æå›› çš„ç”¨æˆ·ï¼Œç›´æ¥æ‰§è¡Œåˆ é™¤</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">removeResult</span> <span class="operator">=</span> userService.lambdaUpdate() </span><br><span class="line">                                      .eq(User::getName, <span class="string">&quot;æå››&quot;</span>)</span><br><span class="line">                                      .remove();</span><br><span class="line">    System.out.println(<span class="string">&quot;åˆ é™¤ç»“æœ:&quot;</span> + removeResult);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-é“¾å¼è°ƒç”¨ç¤ºä¾‹"><a href="#2-3-é“¾å¼è°ƒç”¨ç¤ºä¾‹" class="headerlink" title="2.3 é“¾å¼è°ƒç”¨ç¤ºä¾‹"></a>2.3 é“¾å¼è°ƒç”¨ç¤ºä¾‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢ï¼šå¹´é¾„&gt;20ä¸”åå­—å«â€œå¼ â€</span></span><br><span class="line">userService</span><br><span class="line">    .lambdaQuery()</span><br><span class="line">    .gt(User::getAge, <span class="number">20</span>)</span><br><span class="line">    .like(User::getName, <span class="string">&quot;å¼ &quot;</span>)</span><br><span class="line">    .list();</span><br><span class="line"><span class="comment">// æ›´æ–°ï¼šåå­—=â€œå¼ ä¸‰â€çš„ç”¨æˆ·å¹´é¾„è®¾ä¸º30</span></span><br><span class="line">userService</span><br><span class="line">    .lambdaUpdate()</span><br><span class="line">    .eq(User::getName, <span class="string">&quot;å¼ ä¸‰&quot;</span>)</span><br><span class="line">    .set(User::getAge, <span class="number">30</span>)</span><br><span class="line">    .update();</span><br><span class="line"><span class="comment">//åˆ é™¤ï¼šåˆ é™¤åå­—=â€œæå››â€çš„ç”¨æˆ·</span></span><br><span class="line"> userService</span><br><span class="line">     .lambdaUpdate()</span><br><span class="line">     .eq(User::getName, <span class="string">&quot;æå››&quot;</span>)</span><br><span class="line">     .remove();</span><br></pre></td></tr></table></figure>

<h4 id="2-4-è‡ªå®šä¹‰æ–¹æ³•"><a href="#2-4-è‡ªå®šä¹‰æ–¹æ³•" class="headerlink" title="2.4 è‡ªå®šä¹‰æ–¹æ³•"></a>2.4 è‡ªå®šä¹‰æ–¹æ³•</h4><p>åœ¨ Service æ¥å£å®šä¹‰<code>List&lt;User&gt; selectByAgeRange(Integer minAge, Integer maxAge)</code>ï¼Œå®ç°ç±»ç”¨<code>LambdaQueryWrapper</code>å®ç°æ¡ä»¶æŸ¥è¯¢ã€‚</p>
<h5 id="ä¸€ã€Service-æ¥å£å®šä¹‰ï¼ˆè‡ªå®šä¹‰æ–¹æ³•å£°æ˜ï¼‰"><a href="#ä¸€ã€Service-æ¥å£å®šä¹‰ï¼ˆè‡ªå®šä¹‰æ–¹æ³•å£°æ˜ï¼‰" class="headerlink" title="ä¸€ã€Service æ¥å£å®šä¹‰ï¼ˆè‡ªå®šä¹‰æ–¹æ³•å£°æ˜ï¼‰"></a>ä¸€ã€Service æ¥å£å®šä¹‰ï¼ˆè‡ªå®šä¹‰æ–¹æ³•å£°æ˜ï¼‰</h5><p>åœ¨ <code>UserService</code> æ¥å£ä¸­ç»§æ‰¿ <code>IService&lt;User&gt;</code>ï¼Œå¹¶æ·»åŠ è‡ªå®šä¹‰æ–¹æ³• <code>selectByAgeRange</code>ï¼Œç”¨äºæ ¹æ®ä¼ å…¥çš„æœ€å°å¹´é¾„å’Œæœ€å¤§å¹´é¾„æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»§æ‰¿IService&lt;User&gt;è·å¾—åŸºç¡€CRUDèƒ½åŠ›ï¼ŒåŒæ—¶å£°æ˜è‡ªå®šä¹‰æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;User&gt; &#123;</span><br><span class="line">    <span class="comment">// è‡ªå®šä¹‰æ–¹æ³•ï¼šæ ¹æ®å¹´é¾„èŒƒå›´ï¼ˆminAge~maxAgeï¼‰æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">selectByAgeRange</span><span class="params">(Integer minAge, Integer maxAge)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="äºŒã€Service-å®ç°ç±»ï¼ˆè‡ªå®šä¹‰æ–¹æ³•é€»è¾‘å®ç°ï¼‰"><a href="#äºŒã€Service-å®ç°ç±»ï¼ˆè‡ªå®šä¹‰æ–¹æ³•é€»è¾‘å®ç°ï¼‰" class="headerlink" title="äºŒã€Service å®ç°ç±»ï¼ˆè‡ªå®šä¹‰æ–¹æ³•é€»è¾‘å®ç°ï¼‰"></a>äºŒã€Service å®ç°ç±»ï¼ˆè‡ªå®šä¹‰æ–¹æ³•é€»è¾‘å®ç°ï¼‰</h5><p>åˆ›å»º <code>UserServiceImpl</code> ç±»ï¼Œç»§æ‰¿ <code>ServiceImpl&lt;UserMapper, User&gt;</code> å¹¶å®ç° <code>UserService</code> æ¥å£ï¼Œåœ¨è‡ªå®šä¹‰æ–¹æ³•ä¸­é€šè¿‡ <code>LambdaQueryWrapper</code> æ„å»º â€œå¹´é¾„åœ¨ minAge å’Œ maxAge ä¹‹é—´â€ çš„æŸ¥è¯¢æ¡ä»¶ï¼Œæœ€ç»ˆè°ƒç”¨ <code>this.list(wrapper)</code> æ‰§è¡ŒæŸ¥è¯¢ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span> <span class="comment">// äº¤ç»™Springå®¹å™¨ç®¡ç†ï¼Œç¡®ä¿èƒ½è¢«æ³¨å…¥ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ç°è‡ªå®šä¹‰æ–¹æ³•ï¼šæŒ‰å¹´é¾„èŒƒå›´æŸ¥è¯¢</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">selectByAgeRange</span><span class="params">(Integer minAge, Integer maxAge)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. åˆ›å»ºLambdaQueryWrapperï¼ˆç±»å‹å®‰å…¨ï¼Œé¿å…å­—æ®µç¡¬ç¼–ç ï¼‰</span></span><br><span class="line">        LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æ„å»ºæ¡ä»¶ï¼šå¹´é¾„ between minAge å’Œ maxAgeï¼ˆåŒ…å«è¾¹ç•Œå€¼ï¼‰</span></span><br><span class="line">        wrapper.between(User::getAge, minAge, maxAge);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. è°ƒç”¨list()æ–¹æ³•æ‰§è¡ŒæŸ¥è¯¢ï¼Œè¿”å›ç¬¦åˆæ¡ä»¶çš„ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.list(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-5æ‰¹é‡æ“ä½œæ€§èƒ½ä¼˜åŒ–"><a href="#2-5æ‰¹é‡æ“ä½œæ€§èƒ½ä¼˜åŒ–" class="headerlink" title="2.5æ‰¹é‡æ“ä½œæ€§èƒ½ä¼˜åŒ–"></a>2.5æ‰¹é‡æ“ä½œæ€§èƒ½ä¼˜åŒ–</h4><p>åœ¨å¤„ç†å¤§æ‰¹é‡æ•°æ®æ—¶ï¼Œç›´æ¥æ‰§è¡Œå…¨é‡æ‰¹é‡æ“ä½œå¯èƒ½å¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ï¼ˆç”šè‡³ OOMï¼‰ã€æ•°æ®åº“è¿æ¥å‹åŠ›è¿‡å¤§ç­‰é—®é¢˜ã€‚IService æ¥å£çš„æ‰¹é‡æ“ä½œæ€§èƒ½ä¼˜åŒ–æ ¸å¿ƒæ–¹æ¡ˆä¸º<strong>åˆ†æ‰¹å¤„ç†</strong>ï¼Œé€šè¿‡æ§åˆ¶å•æ¬¡æ‰¹é‡æ“ä½œçš„æ•°æ®é‡ï¼Œå¹³è¡¡å†…å­˜æ¶ˆè€—ä¸æ•°æ®åº“äº¤äº’æ•ˆç‡ã€‚</p>
<p>é’ˆå¯¹å¤§æ‰¹é‡æ•°æ®ï¼ˆå¦‚ä¸‡çº§ã€åä¸‡çº§æ•°æ®ï¼‰çš„æ‰¹é‡æ–°å¢ã€æ›´æ–°ç­‰æ“ä½œï¼Œä¸ç›´æ¥è°ƒç”¨æ— æ‰¹æ¬¡é™åˆ¶çš„æ‰¹é‡æ–¹æ³•ï¼ˆå¦‚ <code>saveBatch(users)</code>ï¼‰ï¼Œè€Œæ˜¯æ‰‹åŠ¨æŒ‡å®š<strong>å•æ¬¡æ‰¹æ¬¡å¤§å°</strong>ï¼Œå°†å…¨é‡æ•°æ®æ‹†åˆ†ä¸ºå¤šæ‰¹é€æ­¥æ‰§è¡Œï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®åˆ°å†…å­˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span> </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">testBatchPerformance</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 1. æ¨¡æ‹Ÿå¤§æ‰¹é‡æ•°æ®ï¼ˆç¤ºä¾‹ï¼š10ä¸‡æ¡ç”¨æˆ·æ•°æ®ï¼‰</span></span><br><span class="line">    List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(); </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000</span>; i++) &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setName(<span class="string">&quot;ç”¨æˆ·_&quot;</span> + i); <span class="comment">// æ„é€ ç”¨æˆ·å§“å</span></span><br><span class="line">        user.setAge(i % <span class="number">100</span>); <span class="comment">// æ„é€ ç”¨æˆ·å¹´é¾„ï¼ˆ0-99éšæœºåˆ†å¸ƒï¼‰</span></span><br><span class="line">        users.add(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. åˆ†æ‰¹æ‰§è¡Œæ‰¹é‡æ’å…¥ï¼šæ¯1000æ¡æ•°æ®ä¸ºä¸€æ‰¹</span></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.saveBatch(users, <span class="number">1000</span>); </span><br><span class="line">    System.out.println(<span class="string">&quot;æ‰¹é‡æ’å…¥ç»“æœ:&quot;</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>saveBatch(users, 1000)</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•° <code>1000</code> å³ä¸º<strong>å•æ¬¡æ‰¹æ¬¡å¤§å°</strong>ï¼Œè¡¨ç¤ºæ¯ç§¯ç´¯ 1000 æ¡æ•°æ®æ‰§è¡Œä¸€æ¬¡æ‰¹é‡æ’å…¥æ“ä½œï¼Œ10 ä¸‡æ¡æ•°æ®æœ€ç»ˆä¼šæ‹†åˆ†ä¸º 100 æ‰¹é€æ­¥å¤„ç†ã€‚</p>
<h3 id="ç¬¬-3-ç« ï¼šæ¡ä»¶æ„é€ å™¨ï¼ˆWrapperï¼‰"><a href="#ç¬¬-3-ç« ï¼šæ¡ä»¶æ„é€ å™¨ï¼ˆWrapperï¼‰" class="headerlink" title="ç¬¬ 3 ç« ï¼šæ¡ä»¶æ„é€ å™¨ï¼ˆWrapperï¼‰"></a>ç¬¬ 3 ç« ï¼šæ¡ä»¶æ„é€ å™¨ï¼ˆWrapperï¼‰</h3><h4 id="3-1-æ„é€ å™¨ç±»å‹"><a href="#3-1-æ„é€ å™¨ç±»å‹" class="headerlink" title="3.1 æ„é€ å™¨ç±»å‹"></a>3.1 æ„é€ å™¨ç±»å‹</h4><ul>
<li><code>QueryWrapper</code>ï¼šé€šç”¨æŸ¥è¯¢æ„é€ å™¨ï¼ˆéœ€ç¡¬ç¼–ç å­—æ®µåï¼Œæ˜“å‡ºé”™ï¼‰</li>
<li><code>LambdaQueryWrapper</code>ï¼šLambda è¯­æ³•æŸ¥è¯¢ï¼ˆç±»å‹å®‰å…¨ï¼Œæ¨èï¼‰</li>
<li><code>UpdateWrapper</code>&#x2F;<code>LambdaUpdateWrapper</code>ï¼šæ›´æ–°æ“ä½œæ„é€ å™¨</li>
</ul>
<h4 id="3-2-æ ¸å¿ƒæŸ¥è¯¢æ¡ä»¶ï¼ˆLambda-æ–¹å¼ç¤ºä¾‹ï¼‰"><a href="#3-2-æ ¸å¿ƒæŸ¥è¯¢æ¡ä»¶ï¼ˆLambda-æ–¹å¼ç¤ºä¾‹ï¼‰" class="headerlink" title="3.2 æ ¸å¿ƒæŸ¥è¯¢æ¡ä»¶ï¼ˆLambda æ–¹å¼ç¤ºä¾‹ï¼‰"></a>3.2 æ ¸å¿ƒæŸ¥è¯¢æ¡ä»¶ï¼ˆLambda æ–¹å¼ç¤ºä¾‹ï¼‰</h4><table>
<thead>
<tr>
<th>æ¡ä»¶ç±»å‹</th>
<th>ä»£ç ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>ç­‰å€¼ &#x2F; ä¸ç­‰å€¼</td>
<td><code>eq(User::getName, &quot;å¼ ä¸‰&quot;).ne(User::getAge, 18)</code></td>
</tr>
<tr>
<td>èŒƒå›´</td>
<td><code>gt(User::getAge, 18).between(User::getAge, 20, 30)</code></td>
</tr>
<tr>
<td>æ¨¡ç³ŠæŸ¥è¯¢</td>
<td><code>like(User::getName, &quot;å¼ &quot;).likeLeft(User::getName, &quot;å¼ &quot;)</code>ï¼ˆ% å¼ ï¼‰</td>
</tr>
<tr>
<td>AND&#x2F;OR åµŒå¥—</td>
<td><code>and(w -&gt; w.eq(User::getName, &quot;å¼ ä¸‰&quot;).or().eq(User::getName, &quot;æå››&quot;))</code></td>
</tr>
<tr>
<td>å­—æ®µé€‰æ‹©</td>
<td><code>select(User::getId, User::getName, User::getAge)</code>ï¼ˆåªæŸ¥æŒ‡å®šå­—æ®µï¼‰</td>
</tr>
<tr>
<td>åŠ¨æ€æ¡ä»¶</td>
<td><code>eq(StringUtils.isNotBlank(name), User::getName, name)</code>ï¼ˆéç©ºæ‰åŠ æ¡ä»¶ï¼‰</td>
</tr>
<tr>
<td>å­æŸ¥è¯¢</td>
<td><code>inSql(User::getId, &quot;select id from user where age &gt; 20&quot;)</code></td>
</tr>
</tbody></table>
<h5 id="ä¸€ã€åŸºç¡€æŸ¥è¯¢æ¡ä»¶"><a href="#ä¸€ã€åŸºç¡€æŸ¥è¯¢æ¡ä»¶" class="headerlink" title="ä¸€ã€åŸºç¡€æŸ¥è¯¢æ¡ä»¶"></a>ä¸€ã€åŸºç¡€æŸ¥è¯¢æ¡ä»¶</h5><h6 id="ä¸€ã€ç­‰å€¼-ä¸ç­‰å€¼æŸ¥è¯¢"><a href="#ä¸€ã€ç­‰å€¼-ä¸ç­‰å€¼æŸ¥è¯¢" class="headerlink" title="ä¸€ã€ç­‰å€¼ &#x2F; ä¸ç­‰å€¼æŸ¥è¯¢"></a>ä¸€ã€ç­‰å€¼ &#x2F; ä¸ç­‰å€¼æŸ¥è¯¢</h6><p>é€šè¿‡ <code>eq</code>ï¼ˆç­‰äºï¼‰ã€<code>ne</code>ï¼ˆä¸ç­‰äºï¼‰æ–¹æ³•æ„å»ºå­—æ®µä¸å€¼çš„åŒ¹é…æ¡ä»¶ï¼ŒLambda æ–¹å¼ç›´æ¥å¼•ç”¨å®ä½“ç±»å­—æ®µï¼ˆå¦‚ <code>User::getName</code>ï¼‰ï¼Œé¿å…ç¡¬ç¼–ç å­—æ®µåå¯¼è‡´çš„é”™è¯¯ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Lambdaæ–¹å¼ï¼šæŸ¥è¯¢å§“åä¸ºâ€œå¼ ä¸‰â€ä¸”å¹´é¾„ä¸ç­‰äº18çš„ç”¨æˆ·</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; lambdaWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">lambdaWrapper.eq(User::getName, <span class="string">&quot;å¼ ä¸‰&quot;</span>) <span class="comment">// ç­‰å€¼æ¡ä»¶ï¼šname = &quot;å¼ ä¸‰&quot;</span></span><br><span class="line">             .ne(User::getAge, <span class="number">18</span>);    <span class="comment">// ä¸ç­‰å€¼æ¡ä»¶ï¼šage != 18</span></span><br></pre></td></tr></table></figure>

<h6 id="äºŒã€èŒƒå›´æŸ¥è¯¢"><a href="#äºŒã€èŒƒå›´æŸ¥è¯¢" class="headerlink" title="äºŒã€èŒƒå›´æŸ¥è¯¢"></a>äºŒã€èŒƒå›´æŸ¥è¯¢</h6><p>é€šè¿‡ <code>gt</code>ï¼ˆå¤§äºï¼‰ã€<code>ge</code>ï¼ˆå¤§äºç­‰äºï¼‰ã€<code>lt</code>ï¼ˆå°äºï¼‰ã€<code>le</code>ï¼ˆå°äºç­‰äºï¼‰ã€<code>between</code>ï¼ˆåŒºé—´åŒ…å«ï¼‰æ–¹æ³•æ„å»ºæ•°å€¼å‹å­—æ®µçš„èŒƒå›´æ¡ä»¶ï¼Œé€‚ç”¨äºå¹´é¾„ã€æ—¶é—´ç­‰å­—æ®µçš„èŒƒå›´ç­›é€‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Lambdaæ–¹å¼ï¼šæŸ¥è¯¢å¹´é¾„å¤§äº18ã€å¤§äºç­‰äº20ã€å°äº30ã€å°äºç­‰äº25ï¼Œä¸”åœ¨20-30åŒºé—´å†…çš„ç”¨æˆ·</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; lambdaWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">lambdaWrapper.gt(User::getAge, <span class="number">18</span>)     <span class="comment">// èŒƒå›´æ¡ä»¶ï¼šage &gt; 18</span></span><br><span class="line">             .ge(User::getAge, <span class="number">20</span>)     <span class="comment">// èŒƒå›´æ¡ä»¶ï¼šage &gt;= 20</span></span><br><span class="line">             .lt(User::getAge, <span class="number">30</span>)     <span class="comment">// èŒƒå›´æ¡ä»¶ï¼šage &lt; 30</span></span><br><span class="line">             .le(User::getAge, <span class="number">25</span>)     <span class="comment">// èŒƒå›´æ¡ä»¶ï¼šage &lt;= 25</span></span><br><span class="line">             .between(User::getAge, <span class="number">20</span>, <span class="number">30</span>); <span class="comment">// åŒºé—´æ¡ä»¶ï¼šage BETWEEN 20 AND 30</span></span><br></pre></td></tr></table></figure>

<h6 id="ä¸‰ã€æ¨¡ç³ŠæŸ¥è¯¢"><a href="#ä¸‰ã€æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="ä¸‰ã€æ¨¡ç³ŠæŸ¥è¯¢"></a>ä¸‰ã€æ¨¡ç³ŠæŸ¥è¯¢</h6><p>é€šè¿‡ <code>like</code>ï¼ˆå…¨æ¨¡ç³Šï¼Œ% å€¼ %ï¼‰ã€<code>likeLeft</code>ï¼ˆå·¦æ¨¡ç³Šï¼Œ% å€¼ï¼‰ã€<code>likeRight</code>ï¼ˆå³æ¨¡ç³Šï¼Œå€¼ %ï¼‰ã€<code>notLike</code>ï¼ˆä¸åŒ…å«ï¼ŒNOT LIKE % å€¼ %ï¼‰æ–¹æ³•æ„å»ºå­—ç¬¦ä¸²å­—æ®µçš„æ¨¡ç³ŠåŒ¹é…æ¡ä»¶ï¼Œé€‚ç”¨äºå§“åã€é‚®ç®±ç­‰å­—æ®µçš„æ¨¡ç³Šæœç´¢ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Lambdaæ–¹å¼ï¼šæŸ¥è¯¢å§“ååŒ…å«â€œå¼ â€ã€ä»¥â€œå¼ â€ç»“å°¾ã€ä»¥â€œå¼ â€å¼€å¤´ï¼Œä¸”ä¸åŒ…å«â€œæâ€çš„ç”¨æˆ·</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; lambdaWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">lambdaWrapper.like(User::getName, <span class="string">&quot;å¼ &quot;</span>)     <span class="comment">// å…¨æ¨¡ç³Šï¼šname LIKE %å¼ %</span></span><br><span class="line">             .likeLeft(User::getName, <span class="string">&quot;å¼ &quot;</span>) <span class="comment">// å·¦æ¨¡ç³Šï¼šname LIKE %å¼ </span></span><br><span class="line">             .likeRight(User::getName, <span class="string">&quot;å¼ &quot;</span>)<span class="comment">// å³æ¨¡ç³Šï¼šname LIKE å¼ %</span></span><br><span class="line">             .notLike(User::getName, <span class="string">&quot;æ&quot;</span>); <span class="comment">// ä¸åŒ…å«ï¼šname NOT LIKE %æ%</span></span><br></pre></td></tr></table></figure>

<h5 id="äºŒã€å¤æ‚æ¡ä»¶ç»„åˆ"><a href="#äºŒã€å¤æ‚æ¡ä»¶ç»„åˆ" class="headerlink" title="äºŒã€å¤æ‚æ¡ä»¶ç»„åˆ"></a>äºŒã€å¤æ‚æ¡ä»¶ç»„åˆ</h5><h6 id="ä¸€ã€AND-OR-æ¡ä»¶ç»„åˆï¼ˆå¤šæ¡ä»¶å¹¶åˆ—ä¸åˆ†æ”¯ï¼‰"><a href="#ä¸€ã€AND-OR-æ¡ä»¶ç»„åˆï¼ˆå¤šæ¡ä»¶å¹¶åˆ—ä¸åˆ†æ”¯ï¼‰" class="headerlink" title="ä¸€ã€AND&#x2F;OR æ¡ä»¶ç»„åˆï¼ˆå¤šæ¡ä»¶å¹¶åˆ—ä¸åˆ†æ”¯ï¼‰"></a>ä¸€ã€AND&#x2F;OR æ¡ä»¶ç»„åˆï¼ˆå¤šæ¡ä»¶å¹¶åˆ—ä¸åˆ†æ”¯ï¼‰</h6><p>é€šè¿‡ <code>and()</code> å’Œ <code>or()</code> æ–¹æ³•å®ç°å¤šæ¡ä»¶çš„å¹¶åˆ—æˆ–åˆ†æ”¯ç»„åˆï¼ŒLambda è¡¨è¾¾å¼å†…å¯åµŒå¥—å­æ¡ä»¶ï¼Œç¡®ä¿æŸ¥è¯¢é€»è¾‘ä¸ä¸šåŠ¡éœ€æ±‚ä¸€è‡´ã€‚é€‚ç”¨äº â€œæ»¡è¶³ A æ¡ä»¶ä¸”ï¼ˆæ»¡è¶³ B æˆ– C æ¡ä»¶ï¼‰â€â€œæ»¡è¶³ A æ¡ä»¶æˆ–ï¼ˆæ»¡è¶³ B ä¸” C æ¡ä»¶ï¼‰â€ ç­‰åœºæ™¯ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼ˆæŸ¥è¯¢é€»è¾‘ï¼šå§“åä¸º â€œå¼ ä¸‰â€ æˆ– â€œæå››â€ï¼Œ<strong>ä¸”</strong> å¹´é¾„å¤§äº 20ï¼›<strong>æˆ–</strong> å¹´é¾„å¤§äº 20 ä¸”å°äº 30ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LambdaQueryWrapper&lt;User&gt; lambdaWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// 1. and() å†…åµŒå¥— OR åˆ†æ”¯ï¼šæ•´ä½“ä¸ºâ€œï¼ˆå§“å=å¼ ä¸‰ æˆ– å§“å=æå››ï¼‰â€çš„æ¡ä»¶ï¼Œä¸åç»­æ¡ä»¶ç”¨ AND è¿æ¥</span></span><br><span class="line">lambdaWrapper.and(w -&gt; w.eq(User::getName, <span class="string">&quot;å¼ ä¸‰&quot;</span>).or().eq(User::getName, <span class="string">&quot;æå››&quot;</span>))</span><br><span class="line">             <span class="comment">// 2. or() å†…åµŒå¥— AND åˆ†æ”¯ï¼šæ•´ä½“ä¸ºâ€œï¼ˆå¹´é¾„&gt;20 ä¸” å¹´é¾„&lt;30ï¼‰â€çš„æ¡ä»¶ï¼Œä¸å‰é¢æ¡ä»¶ç”¨ OR è¿æ¥</span></span><br><span class="line">             .or(w -&gt; w.gt(User::getAge, <span class="number">20</span>).lt(User::getAge, <span class="number">30</span>));</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>and()</code> å’Œ <code>or()</code> æ–¹æ³•çš„å‚æ•°ä¸º Lambda è¡¨è¾¾å¼ï¼Œç”¨äºå®šä¹‰åˆ†æ”¯å†…çš„å­æ¡ä»¶ï¼Œé¿å…å› æ¡ä»¶ä¼˜å…ˆçº§æ··ä¹±å¯¼è‡´çš„æŸ¥è¯¢é”™è¯¯ï¼Œä¸”å­—æ®µå¼•ç”¨ï¼ˆå¦‚ <code>User::getName</code>ï¼‰æ— ç¡¬ç¼–ç é£é™©ã€‚</p>
<h6 id="äºŒã€åµŒå¥—æ¡ä»¶ï¼ˆå¼ºåˆ¶æ¡ä»¶ä¼˜å…ˆçº§ï¼‰"><a href="#äºŒã€åµŒå¥—æ¡ä»¶ï¼ˆå¼ºåˆ¶æ¡ä»¶ä¼˜å…ˆçº§ï¼‰" class="headerlink" title="äºŒã€åµŒå¥—æ¡ä»¶ï¼ˆå¼ºåˆ¶æ¡ä»¶ä¼˜å…ˆçº§ï¼‰"></a>äºŒã€åµŒå¥—æ¡ä»¶ï¼ˆå¼ºåˆ¶æ¡ä»¶ä¼˜å…ˆçº§ï¼‰</h6><p>é€šè¿‡ <code>nested()</code> æ–¹æ³•å°†ä¸€ç»„å­æ¡ä»¶åŒ…è£¹ä¸º â€œåµŒå¥—å—â€ï¼Œå¼ºåˆ¶è¯¥ç»„å­æ¡ä»¶ä¼˜å…ˆæ‰§è¡Œï¼Œé€‚ç”¨äº â€œï¼ˆæ»¡è¶³ A æˆ– B æ¡ä»¶ï¼‰ä¸”ï¼ˆæ»¡è¶³ C ä¸” D æ¡ä»¶ï¼‰â€ ç­‰éœ€è¦æ˜ç¡®ä¼˜å…ˆçº§çš„åœºæ™¯ï¼ˆç±»ä¼¼ SQL ä¸­çš„æ‹¬å·åˆ†ç»„ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼ˆæŸ¥è¯¢é€»è¾‘ï¼šï¼ˆå§“åä¸º â€œå¼ ä¸‰â€ æˆ– â€œæå››â€ï¼‰<strong>ä¸”</strong>ï¼ˆå¹´é¾„å¤§äº 20 ä¸”å°äº 30ï¼‰ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LambdaQueryWrapper&lt;User&gt; lambdaWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// 1. nested() åŒ…è£¹ç¬¬ä¸€ä¸ªå­æ¡ä»¶å—ï¼šï¼ˆå§“å=å¼ ä¸‰ æˆ– å§“å=æå››ï¼‰ï¼Œä¼˜å…ˆæ‰§è¡Œ</span></span><br><span class="line">lambdaWrapper.nested(w -&gt; w.eq(User::getName, <span class="string">&quot;å¼ ä¸‰&quot;</span>).or().eq(User::getName, <span class="string">&quot;æå››&quot;</span>))</span><br><span class="line">             <span class="comment">// 2. and() è¿æ¥ç¬¬äºŒä¸ªå­æ¡ä»¶å—ï¼šï¼ˆå¹´é¾„&gt;20 ä¸” å¹´é¾„&lt;30ï¼‰ï¼Œä¸åµŒå¥—å—ç”¨ AND è¿æ¥</span></span><br><span class="line">             .and(w -&gt; w.gt(User::getAge, <span class="number">20</span>).lt(User::getAge, <span class="number">30</span>));</span><br></pre></td></tr></table></figure>

<p>ä¸æ™®é€š <code>and()</code>&#x2F;<code>or()</code> ç»„åˆä¸åŒï¼Œ<code>nested()</code> æ˜ç¡®æ ‡è¯†å­æ¡ä»¶å—çš„ä¼˜å…ˆçº§ï¼Œå³ä½¿åç»­æ¡ä»¶å¤æ‚ï¼Œä¹Ÿèƒ½ä¿è¯åµŒå¥—å—å†…çš„é€»è¾‘ä¼˜å…ˆæ‰§è¡Œï¼Œé¿å… SQL è§£ææ—¶çš„ä¼˜å…ˆçº§é”™ä¹±ã€‚</p>
<h5 id="ä¸‰ã€æ’åºä¸åˆ†é¡µ"><a href="#ä¸‰ã€æ’åºä¸åˆ†é¡µ" class="headerlink" title="ä¸‰ã€æ’åºä¸åˆ†é¡µ"></a>ä¸‰ã€æ’åºä¸åˆ†é¡µ</h5><h6 id="ä¸€ã€æ’åºï¼ˆæ§åˆ¶ç»“æœé›†é¡ºåºï¼‰"><a href="#ä¸€ã€æ’åºï¼ˆæ§åˆ¶ç»“æœé›†é¡ºåºï¼‰" class="headerlink" title="ä¸€ã€æ’åºï¼ˆæ§åˆ¶ç»“æœé›†é¡ºåºï¼‰"></a>ä¸€ã€æ’åºï¼ˆæ§åˆ¶ç»“æœé›†é¡ºåºï¼‰</h6><p>é€šè¿‡ <code>orderByAsc</code>ï¼ˆå‡åºï¼‰å’Œ <code>orderByDesc</code>ï¼ˆé™åºï¼‰æ–¹æ³•æŒ‡å®šæ’åºå­—æ®µï¼Œæ”¯æŒå•å­—æ®µæˆ–å¤šå­—æ®µæ’åºï¼ŒLambda æ–¹å¼ç›´æ¥å¼•ç”¨å®ä½“ç±»å­—æ®µï¼Œé¿å…å­—æ®µåç¡¬ç¼–ç é”™è¯¯ã€‚</p>
<ol>
<li><strong>æ ¸å¿ƒé€»è¾‘</strong></li>
</ol>
<ul>
<li>å‡åºï¼š<code>orderByAsc(å®ä½“ç±»::å­—æ®µå1, å®ä½“ç±»::å­—æ®µå2)</code>ï¼ˆæŒ‰å­—æ®µ 1 å‡åºï¼Œå­—æ®µ 1 ç›¸åŒåˆ™æŒ‰å­—æ®µ 2 å‡åºï¼‰</li>
<li>é™åºï¼š<code>orderByDesc(å®ä½“ç±»::å­—æ®µå)</code></li>
<li>å¯ç»„åˆä½¿ç”¨å‡åºä¸é™åºæ–¹æ³•ï¼Œæ»¡è¶³å¤æ‚æ’åºéœ€æ±‚ã€‚</li>
</ul>
<ol start="2">
<li><strong>ç¤ºä¾‹ä»£ç </strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Lambdaæ–¹å¼ï¼šæŒ‰å¹´é¾„å‡åºã€IDå‡åºï¼Œå†æŒ‰åˆ›å»ºæ—¶é—´é™åºæ’åº</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; lambdaWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">lambdaWrapper.orderByAsc(User::getAge, User::getId)  <span class="comment">// å¤šå­—æ®µå‡åºï¼šå…ˆageï¼Œå†id</span></span><br><span class="line">             .orderByDesc(User::getCreateTime);       <span class="comment">// å•å­—æ®µé™åºï¼šcreate_time</span></span><br><span class="line"><span class="comment">// æ‰§è¡ŒæŸ¥è¯¢ï¼Œç»“æœæŒ‰ä¸Šè¿°è§„åˆ™æ’åº</span></span><br><span class="line">List&lt;User&gt; sortedUsers = userMapper.selectList(lambdaWrapper);</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°æ’åºé€»è¾‘å¯¹åº”æ–‡æ¡£ä¸­ Lambda æ–¹å¼çš„æ’åºå®ç°ï¼Œé€šè¿‡é“¾å¼è°ƒç”¨æ˜ç¡®æ’åºè§„åˆ™ï¼Œå¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§æ›´å¼ºã€‚</p>
<h6 id="äºŒã€åˆ†é¡µï¼ˆå¤§æ•°æ®é‡åˆ†æ‰¹è·å–ï¼‰"><a href="#äºŒã€åˆ†é¡µï¼ˆå¤§æ•°æ®é‡åˆ†æ‰¹è·å–ï¼‰" class="headerlink" title="äºŒã€åˆ†é¡µï¼ˆå¤§æ•°æ®é‡åˆ†æ‰¹è·å–ï¼‰"></a>äºŒã€åˆ†é¡µï¼ˆå¤§æ•°æ®é‡åˆ†æ‰¹è·å–ï¼‰</h6><p>åˆ†é¡µéœ€å…ˆé…ç½®åˆ†é¡µæ’ä»¶ï¼Œå†é€šè¿‡ <code>Page</code> å¯¹è±¡æŒ‡å®šåˆ†é¡µå‚æ•°ï¼ˆå½“å‰é¡µã€æ¯é¡µå¤§å°ï¼‰ï¼Œç»“åˆ LambdaQueryWrapper å®ç°æ¡ä»¶åˆ†é¡µæŸ¥è¯¢ï¼Œæ”¯æŒè·å–æ€»è®°å½•æ•°ã€å½“å‰é¡µæ•°æ®ç­‰å…³é”®ä¿¡æ¯ã€‚</p>
<p><strong>1. å‰ç½®æ­¥éª¤ï¼šé…ç½®åˆ†é¡µæ’ä»¶</strong></p>
<p>éœ€åœ¨é…ç½®ç±»ä¸­æ³¨å†Œ <code>PaginationInnerInterceptor</code> æ’ä»¶ï¼ˆæŒ‡å®šæ•°æ®åº“ç±»å‹ï¼‰ï¼Œç¡®ä¿åˆ†é¡µåŠŸèƒ½ç”Ÿæ•ˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        <span class="comment">// æ³¨å†Œåˆ†é¡µæ’ä»¶ï¼ŒæŒ‡å®šæ•°æ®åº“ç±»å‹ï¼ˆå¦‚MySQLï¼‰</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°åˆ†é¡µæ’ä»¶é…ç½®ä¸ºæ–‡æ¡£ä¸­ç”Ÿäº§ç¯å¢ƒçš„æ ‡å‡†é…ç½®ï¼Œæ˜¯åˆ†é¡µæŸ¥è¯¢çš„å‰æã€‚</p>
<p><strong>2. åˆ†é¡µæŸ¥è¯¢ç¤ºä¾‹ï¼ˆLambda æ–¹å¼ï¼‰</strong></p>
<p>é€šè¿‡ <code>Page</code> å¯¹è±¡å®šä¹‰åˆ†é¡µå‚æ•°ï¼Œç»“åˆ <code>selectPage</code> æ–¹æ³•æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Œè¿”å›çš„ <code>Page</code> å¯¹è±¡åŒ…å«æ€»è®°å½•æ•°ã€å½“å‰é¡µæ•°æ®ç­‰ä¿¡æ¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. æ„å»ºåˆ†é¡µå¯¹è±¡ï¼šå‚æ•°1=å½“å‰é¡µï¼ˆä»1å¼€å§‹ï¼‰ï¼Œå‚æ•°2=æ¯é¡µå¤§å°</span></span><br><span class="line">Page&lt;User&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(<span class="number">1</span>, <span class="number">10</span>);  <span class="comment">// ç¬¬1é¡µï¼Œæ¯é¡µ10æ¡æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ„å»ºLambdaæŸ¥è¯¢æ¡ä»¶ï¼šæŸ¥è¯¢å¹´é¾„&gt;20çš„ç”¨æˆ·</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; lambdaWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">lambdaWrapper.gt(User::getAge, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ï¼šè°ƒç”¨selectPageæ–¹æ³•ï¼Œä¼ å…¥åˆ†é¡µå¯¹è±¡ä¸æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">Page&lt;User&gt; resultPage = userMapper.selectPage(page, lambdaWrapper);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. è§£æåˆ†é¡µç»“æœ</span></span><br><span class="line"><span class="type">long</span> <span class="variable">total</span> <span class="operator">=</span> resultPage.getTotal();  <span class="comment">// è·å–æ€»è®°å½•æ•°</span></span><br><span class="line">List&lt;User&gt; currentPageUsers = resultPage.getRecords();  <span class="comment">// è·å–å½“å‰é¡µæ•°æ®</span></span><br><span class="line">System.out.println(<span class="string">&quot;æ€»è®°å½•æ•°ï¼š&quot;</span> + total);</span><br><span class="line">System.out.println(<span class="string">&quot;ç¬¬1é¡µæ•°æ®ï¼š&quot;</span> + currentPageUsers);</span><br></pre></td></tr></table></figure>

<p>è¯¥åˆ†é¡µé€»è¾‘ä¸æ–‡æ¡£ä¸­ Lambda æ–¹å¼çš„åˆ†é¡µå®ç°ä¸€è‡´ï¼Œé€šè¿‡åˆ†é¡µæ’ä»¶ä¸ <code>Page</code> å¯¹è±¡é…åˆï¼Œé«˜æ•ˆå¤„ç†å¤§æ•°æ®é‡æŸ¥è¯¢ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½è¿‡å¤šæ•°æ®å¯¼è‡´å†…å­˜æº¢å‡ºã€‚</p>
<h5 id="å››ã€å­—æ®µé€‰æ‹©ï¼ˆç­›é€‰è¿”å›å­—æ®µï¼‰"><a href="#å››ã€å­—æ®µé€‰æ‹©ï¼ˆç­›é€‰è¿”å›å­—æ®µï¼‰" class="headerlink" title="å››ã€å­—æ®µé€‰æ‹©ï¼ˆç­›é€‰è¿”å›å­—æ®µï¼‰"></a>å››ã€å­—æ®µé€‰æ‹©ï¼ˆç­›é€‰è¿”å›å­—æ®µï¼‰</h5><p>é€šè¿‡ <code>select</code> æ–¹æ³•æŒ‡å®šéœ€è¦æŸ¥è¯¢çš„å®ä½“ç±»å­—æ®µï¼Œä»…è¿”å›ç›®æ ‡å­—æ®µæ•°æ®ï¼ˆè€Œéå…¨è¡¨å­—æ®µï¼‰ï¼Œå‡å°‘æ•°æ®ä¼ è¾“é‡ä¸æ•°æ®åº“æŸ¥è¯¢å¼€é”€ï¼Œé€‚ç”¨äºåªéœ€è¦éƒ¨åˆ†å­—æ®µçš„åœºæ™¯ã€‚</p>
<ol>
<li><strong>æ ¸å¿ƒé€»è¾‘</strong></li>
</ol>
<ul>
<li>è¯­æ³•ï¼š<code>select(å®ä½“ç±»::ç›®æ ‡å­—æ®µ1, å®ä½“ç±»::ç›®æ ‡å­—æ®µ2, ...)</code></li>
<li>ä½œç”¨ï¼šä»…æŸ¥è¯¢æŒ‡å®šå­—æ®µï¼Œä¾‹å¦‚åªæŸ¥ <code>id</code>ã€<code>name</code>ã€<code>age</code>ï¼Œä¸æŸ¥ <code>email</code>ã€<code>createTime</code> ç­‰æ— å…³å­—æ®µã€‚</li>
</ul>
<ol start="2">
<li><strong>ç¤ºä¾‹ä»£ç </strong></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Lambdaæ–¹å¼ï¼šä»…æŸ¥è¯¢ç”¨æˆ·çš„idã€nameã€ageå­—æ®µï¼Œæ’é™¤å…¶ä»–å­—æ®µ</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; lambdaWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">lambdaWrapper.select(User::getId, User::getName, User::getAge)  <span class="comment">// æŒ‡å®šè¿”å›å­—æ®µ</span></span><br><span class="line">             .eq(User::getAge, <span class="number">25</span>);  <span class="comment">// é™„åŠ æŸ¥è¯¢æ¡ä»¶ï¼šå¹´é¾„=25</span></span><br><span class="line"><span class="comment">// æ‰§è¡ŒæŸ¥è¯¢ï¼Œè¿”å›çš„Userå¯¹è±¡ä¸­ä»…idã€nameã€ageæœ‰å€¼ï¼Œå…¶ä»–å­—æ®µä¸ºnull</span></span><br><span class="line">List&lt;User&gt; partialUsers = userMapper.selectList(lambdaWrapper);</span><br></pre></td></tr></table></figure>

<p>è¯¥å®ç°ä¸æ–‡æ¡£ä¸­ Lambda æ–¹å¼çš„å­—æ®µé€‰æ‹©é€»è¾‘å®Œå…¨ä¸€è‡´ï¼Œé€šè¿‡ <code>select</code> æ–¹æ³•ç²¾å‡†æ§åˆ¶è¿”å›å­—æ®µï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<h4 id="3-3-æ›´æ–°æ„é€ å™¨ç¤ºä¾‹"><a href="#3-3-æ›´æ–°æ„é€ å™¨ç¤ºä¾‹" class="headerlink" title="3.3 æ›´æ–°æ„é€ å™¨ç¤ºä¾‹"></a>3.3 æ›´æ–°æ„é€ å™¨ç¤ºä¾‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// LambdaUpdateWrapperï¼šæ›´æ–°åå­—=â€œå¼ ä¸‰â€çš„ç”¨æˆ·</span></span><br><span class="line">LambdaUpdateWrapper&lt;User&gt; lambdaUpdate = <span class="keyword">new</span> <span class="title class_">LambdaUpdateWrapper</span>&lt;&gt;();</span><br><span class="line">lambdaUpdate.set(User::getAge,<span class="number">30</span>)</span><br><span class="line">    .set(User::getEmail,<span class="string">&quot;new@example.com&quot;</span>)</span><br><span class="line">    .eq(User::getName, <span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">userMapper.update(<span class="literal">null</span>, lambdaUpdate);</span><br><span class="line"><span class="comment">//UpdateWrapper</span></span><br><span class="line">UpdateWrapper&lt;User&gt; updateWrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;&gt;();</span><br><span class="line"> updateWrapper.set(<span class="string">&quot;age&quot;</span>, <span class="number">30</span>)</span><br><span class="line">     .set(<span class="string">&quot;email&quot;</span>, <span class="string">&quot;new@example.com&quot;</span>)</span><br><span class="line">     .eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line"> userMapper.update(<span class="literal">null</span>, updateWrapper);</span><br></pre></td></tr></table></figure>

<h4 id="3-4åŠ¨æ€æ¡ä»¶æ„å»º"><a href="#3-4åŠ¨æ€æ¡ä»¶æ„å»º" class="headerlink" title="3.4åŠ¨æ€æ¡ä»¶æ„å»º"></a>3.4åŠ¨æ€æ¡ä»¶æ„å»º</h4><p><strong>æ ¹æ®å‚æ•°æœ‰æ•ˆæ€§ï¼ˆéç©º &#x2F; éç©ºç™½ï¼‰å†³å®šæ˜¯å¦æ·»åŠ æŸ¥è¯¢æ¡ä»¶</strong>ï¼Œé¿å…å› å‚æ•°æ— æ•ˆå¯¼è‡´çš„å†—ä½™ SQL æˆ–é”™è¯¯æŸ¥è¯¢ï¼Œé€šè¿‡å‚æ•°æœ‰æ•ˆæ€§åˆ¤æ–­å®ç°æ¡ä»¶çš„åŠ¨æ€å¼€å…³ï¼Œé¿å…ç¼–å†™å¤§é‡ <code>if-else</code> é€»è¾‘ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰å¯èƒ½ä¸ºç©ºçš„æŸ¥è¯¢å‚æ•°</span></span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;å¼ ä¸‰&quot;</span>;    <span class="comment">// ç¤ºä¾‹ï¼šå§“åå‚æ•°ï¼ˆéç©ºï¼‰</span></span><br><span class="line"><span class="type">Integer</span> <span class="variable">minAge</span> <span class="operator">=</span> <span class="number">20</span>;    <span class="comment">// ç¤ºä¾‹ï¼šæœ€å°å¹´é¾„å‚æ•°ï¼ˆéç©ºï¼‰</span></span><br><span class="line"><span class="type">Integer</span> <span class="variable">maxAge</span> <span class="operator">=</span> <span class="number">30</span>;    <span class="comment">// ç¤ºä¾‹ï¼šæœ€å¤§å¹´é¾„å‚æ•°ï¼ˆéç©ºï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. åˆ›å»ºLambdaQueryWrapper</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åŠ¨æ€æ·»åŠ æ¡ä»¶ï¼šä»…å½“å‚æ•°æœ‰æ•ˆæ—¶ï¼Œæ¡ä»¶æ‰ç”Ÿæ•ˆ</span></span><br><span class="line">wrapper.eq(StringUtils.isNotBlank(name), User::getName, name)  <span class="comment">// å§“åéç©ºç™½æ—¶ï¼Œæ·»åŠ â€œname=å¼ ä¸‰â€</span></span><br><span class="line">       .gt(minAge != <span class="literal">null</span>, User::getAge, minAge)              <span class="comment">// æœ€å°å¹´é¾„éç©ºæ—¶ï¼Œæ·»åŠ â€œage&gt;20â€</span></span><br><span class="line">       .lt(maxAge != <span class="literal">null</span>, User::getAge, maxAge);             <span class="comment">// æœ€å¤§å¹´é¾„éç©ºæ—¶ï¼Œæ·»åŠ â€œage&lt;30â€</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰§è¡ŒæŸ¥è¯¢ï¼šæœ€ç»ˆæ¡ä»¶ä¸ºâ€œname=å¼ ä¸‰ AND age&gt;20 AND age&lt;30â€</span></span><br><span class="line">List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br></pre></td></tr></table></figure>

<h4 id="3-5å­æŸ¥è¯¢ï¼ˆLambda-æ–¹å¼ï¼‰"><a href="#3-5å­æŸ¥è¯¢ï¼ˆLambda-æ–¹å¼ï¼‰" class="headerlink" title="3.5å­æŸ¥è¯¢ï¼ˆLambda æ–¹å¼ï¼‰"></a>3.5å­æŸ¥è¯¢ï¼ˆLambda æ–¹å¼ï¼‰</h4><p>å­æŸ¥è¯¢æ˜¯å°†ä¸€ä¸ªæŸ¥è¯¢ç»“æœä½œä¸ºå¦ä¸€ä¸ªæŸ¥è¯¢çš„æ¡ä»¶ï¼ˆå¦‚ <code>IN</code> å­å¥ï¼‰ï¼ŒMyBatis-Plus æ”¯æŒä¼ ç»Ÿå­—ç¬¦ä¸²æ‹¼æ¥ã€Lambda è¯­æ³•åŠæ›´å®‰å…¨çš„ â€œå­ Wrapperâ€ ä¸‰ç§æ–¹å¼ï¼Œå…¶ä¸­ Lambda æ–¹å¼é¿å…å­—æ®µç¡¬ç¼–ç ï¼Œâ€œå­ Wrapperâ€ æ–¹å¼è¿›ä¸€æ­¥å‡å°‘ SQL æ³¨å…¥é£é™©ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼ ç»Ÿâ½…å¼</span></span><br><span class="line">queryWrapper.inSql(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;select id from user where age &gt; 20&quot;</span>);</span><br><span class="line"> <span class="comment">// Lambdaâ½…å¼</span></span><br><span class="line">lambdaWrapper.inSql(User::getId, <span class="string">&quot;select id from user where age &gt; 20&quot;</span>);</span><br><span class="line"> <span class="comment">// æ›´å®‰å…¨çš„â¼¦æŸ¥è¯¢â½…å¼</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; subWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line"> subWrapper</span><br><span class="line">     .select(User::getId)</span><br><span class="line">     .gt(User::getAge, <span class="number">20</span>);</span><br><span class="line"> lambdaWrapper</span><br><span class="line">     .in(User::getId, userMapper.selectObjs(subWrapper))</span><br></pre></td></tr></table></figure>

<h4 id="3-6-æœ€ä½³å®è·µ"><a href="#3-6-æœ€ä½³å®è·µ" class="headerlink" title="3.6 æœ€ä½³å®è·µ"></a>3.6 æœ€ä½³å®è·µ</h4><ul>
<li>ä¼˜å…ˆä½¿â½¤Lambdaâ½…å¼ï¼šç±»å‹å®‰å…¨ï¼Œé‡æ„å‹å¥½</li>
<li>åˆç†ä½¿â½¤åŠ¨æ€æ¡ä»¶ï¼šé¿å…æ„å»ºè¿‡äºå¤æ‚çš„æ¡ä»¶ </li>
<li>æ³¨æ„SQLæ³¨â¼Šâ»›é™©ï¼šé¿å…ç›´æ¥æ‹¼æ¥â½¤æˆ·è¾“â¼Š </li>
<li>æ‰¹é‡æ“ä½œä¼˜åŒ–ï¼šå¯¹äºâ¼¤æ‰¹é‡æ•°æ®ï¼Œä½¿â½¤åˆ†æ‰¹å¤„ç†</li>
</ul>
<h3 id="ç¬¬-4-ç« ï¼šæµå¼æŸ¥è¯¢ï¼ˆå¤„ç†å¤§æ•°æ®ï¼‰"><a href="#ç¬¬-4-ç« ï¼šæµå¼æŸ¥è¯¢ï¼ˆå¤„ç†å¤§æ•°æ®ï¼‰" class="headerlink" title="ç¬¬ 4 ç« ï¼šæµå¼æŸ¥è¯¢ï¼ˆå¤„ç†å¤§æ•°æ®ï¼‰"></a>ç¬¬ 4 ç« ï¼šæµå¼æŸ¥è¯¢ï¼ˆå¤„ç†å¤§æ•°æ®ï¼‰</h3><h4 id="4-1-ä¸¤ç§å®ç°æ–¹å¼"><a href="#4-1-ä¸¤ç§å®ç°æ–¹å¼" class="headerlink" title="4.1 ä¸¤ç§å®ç°æ–¹å¼"></a>4.1 ä¸¤ç§å®ç°æ–¹å¼</h4><ol>
<li><p>ResultHandler æ–¹å¼ï¼ˆæ¨èï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Mapperæ¥å£å®šä¹‰</span></span><br><span class="line"><span class="meta">@Select(&quot;SELECT * FROM user $&#123;ew.customSqlSegment&#125;&quot;)</span></span><br><span class="line"><span class="meta">@Options(resultSetType = ResultSetType.FORWARD_ONLY)</span></span><br><span class="line"><span class="meta">@ResultType(User.class)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">selectStream</span><span class="params">(<span class="meta">@Param(Constants.WRAPPER)</span> Wrapper&lt;User&gt; wrapper, ResultHandler&lt;User&gt; handler)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ï¼šé€è¡Œå¤„ç†æ•°æ®ï¼Œé¿å…OOM</span></span><br><span class="line">userMapper.selectStream(Wrappers.emptyWrapper(), context -&gt; &#123;</span><br><span class="line">  <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> context.getResultObject();</span><br><span class="line">  <span class="comment">// å¤„ç†é€»è¾‘</span></span><br><span class="line">  System.out.println(<span class="string">&quot;å·²å¤„ç†ç¬¬&quot;</span> + context.getResultCount() + <span class="string">&quot;æ¡&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Cursor æ–¹å¼ï¼ˆJava8+ï¼Œéœ€äº‹åŠ¡ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Mapperå®šä¹‰</span></span><br><span class="line"><span class="meta">@Select(&quot;SELECT * FROM user LIMIT #&#123;limit&#125;&quot;)</span></span><br><span class="line">Cursor&lt;User&gt; <span class="title function_">scan</span><span class="params">(<span class="meta">@Param(&quot;limit&quot;)</span> <span class="type">int</span> limit)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ï¼ˆtry-with-resourcesè‡ªåŠ¨å…³é—­ï¼‰</span></span><br><span class="line"><span class="meta">@Transactional</span> <span class="comment">// å¿…é¡»åŠ äº‹åŠ¡ï¼Œä¿æŒè¿æ¥</span></span><br><span class="line"><span class="keyword">try</span> (Cursor&lt;User&gt; cursor = userMapper.scan(<span class="number">100000</span>)) &#123;</span><br><span class="line">  cursor.forEach(user -&gt; &#123; <span class="comment">/* å¤„ç†é€»è¾‘ */</span> &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šå¿…é¡»â¼¿åŠ¨å…³é—­Cursoræˆ–ä½¿â½¤try-with-resources</p>
</li>
</ol>
<h4 id="4-2ç»“åˆMyBatis-Plus-ç‰¹æ€§çš„å®ç°"><a href="#4-2ç»“åˆMyBatis-Plus-ç‰¹æ€§çš„å®ç°" class="headerlink" title="4.2ç»“åˆMyBatis-Plus ç‰¹æ€§çš„å®ç°"></a>4.2ç»“åˆMyBatis-Plus ç‰¹æ€§çš„å®ç°</h4><p>ç»“åˆ MyBatis-Plus ç‰¹æ€§çš„æµå¼æŸ¥è¯¢ä¸»è¦åŒ…å«<strong>é€šç”¨ BaseMapper æµå¼æŸ¥è¯¢</strong>ä¸<strong>å¸¦æ¡ä»¶çš„åˆ†é¡µæµå¼å¤„ç†</strong>ä¸¤ç±»ï¼Œæ ¸å¿ƒæ˜¯å€ŸåŠ© BaseMapper åŸç”Ÿæ–¹æ³• + ResultHandler å®ç°æ•°æ®é€è¡Œ &#x2F; åˆ†æ‰¹å¤„ç†ï¼Œé¿å…å¤§æ•°æ®é‡åŠ è½½å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼ˆOOMï¼‰ã€‚</p>
<h5 id="1ã€é€šç”¨-BaseMapper-æµå¼æŸ¥è¯¢"><a href="#1ã€é€šç”¨-BaseMapper-æµå¼æŸ¥è¯¢" class="headerlink" title="1ã€é€šç”¨ BaseMapper æµå¼æŸ¥è¯¢"></a>1ã€é€šç”¨ BaseMapper æµå¼æŸ¥è¯¢</h5><p>æ— éœ€è‡ªå®šä¹‰ Mapper æ¥å£æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨ BaseMapper è‡ªå¸¦çš„<code>selectList</code>æ–¹æ³•ï¼Œé€šè¿‡ä¼ å…¥<code>Wrappers.emptyWrapper()</code>ï¼ˆæ— é¢å¤–æŸ¥è¯¢æ¡ä»¶æ—¶ï¼‰å’Œ<code>ResultHandler</code>æ¥å£ï¼Œå®ç°å¯¹æŸ¥è¯¢ç»“æœçš„é€è¡Œæµå¼å¤„ç†ã€‚è¯¥æ–¹å¼æ”¯æŒ BaseMapper çš„æ‰€æœ‰æŸ¥è¯¢æ–¹æ³•ï¼ˆå¦‚å¸¦æ¡ä»¶çš„<code>selectList</code>ï¼‰ï¼Œæ— éœ€é¢å¤–æ‰©å±•ï¼Œç®€åŒ–å¼€å‘æµç¨‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥è°ƒç”¨BaseMapperçš„selectListæ–¹æ³•ï¼Œå®ç°æµå¼æŸ¥è¯¢</span></span><br><span class="line">userMapper.selectList(</span><br><span class="line">    Wrappers.emptyWrapper(), <span class="comment">// æ— é¢å¤–æŸ¥è¯¢æ¡ä»¶ï¼ˆè‹¥éœ€æ¡ä»¶ï¼Œå¯æ›¿æ¢ä¸ºLambdaQueryWrapperï¼‰</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ResultHandler</span>&lt;User&gt;() &#123; <span class="comment">// ç»“æœå¤„ç†å™¨ï¼šé€è¡Œå¤„ç†æŸ¥è¯¢åˆ°çš„æ•°æ®</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleResult</span><span class="params">(ResultContext&lt;? extends User&gt; context)</span> &#123;</span><br><span class="line">            <span class="comment">// 1. è·å–å½“å‰æµå¼å¤„ç†çš„å•æ¡æ•°æ®</span></span><br><span class="line">            <span class="type">User</span> <span class="variable">currentUser</span> <span class="operator">=</span> context.getResultObject();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 2. è‡ªå®šä¹‰æ•°æ®å¤„ç†é€»è¾‘ï¼ˆå¦‚æ•°æ®æ ¡éªŒã€æ ¼å¼è½¬æ¢ã€å†™å…¥æ–‡ä»¶ç­‰ï¼‰</span></span><br><span class="line">            <span class="comment">// ç¤ºä¾‹ï¼šæ‰“å°å½“å‰å¤„ç†çš„æ•°æ®ID</span></span><br><span class="line">            System.out.println(<span class="string">&quot;æ­£åœ¨å¤„ç†ç”¨æˆ·IDï¼š&quot;</span> + currentUser.getId());</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼šæ­¤å¤„é€»è¾‘éœ€è½»é‡åŒ–ï¼Œé¿å…é˜»å¡æµå¼å¤„ç†</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>**<code>Wrappers.emptyWrapper()</code>**ï¼šå½“æ— éœ€ç­›é€‰æ¡ä»¶ï¼ˆæŸ¥è¯¢å…¨è¡¨æ•°æ®ï¼‰æ—¶ä½¿ç”¨ï¼Œè‹¥éœ€æ·»åŠ æŸ¥è¯¢æ¡ä»¶ï¼ˆå¦‚å¹´é¾„ &gt; 20ï¼‰ï¼Œå¯æ›¿æ¢ä¸º<code>Wrappers.lambdaQuery().gt(User::getAge, 20)</code>ï¼Œå…¼å®¹æ‰€æœ‰ Lambda æ¡ä»¶æ„é€ å™¨ç”¨æ³•ï¼›</li>
<li>**<code>ResultContext</code>**ï¼šç”¨äºè·å–æµå¼å¤„ç†çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ ¸å¿ƒæ–¹æ³•<code>getResultObject()</code>è·å–å½“å‰è¡Œæ•°æ®ï¼Œè¿˜å¯é€šè¿‡<code>getResultCount()</code>è·å–å·²å¤„ç†çš„æ•°æ®æ€»æ•°ï¼›</li>
<li><strong>æ”¯æŒèŒƒå›´</strong>ï¼šæ–‡æ¡£æ˜ç¡®è¯´æ˜ â€œæ”¯æŒæ‰€æœ‰ BaseMapper çš„æŸ¥è¯¢æ–¹æ³•â€ï¼Œå³ BaseMapper ä¸­å¸¦<code>ResultHandler</code>å‚æ•°çš„æŸ¥è¯¢æ–¹æ³•ï¼ˆå¦‚<code>selectByMap</code>ã€<code>selectOne</code>ç­‰ï¼‰ï¼Œå‡å¯ç”¨æ­¤æ–¹å¼å®ç°æµå¼å¤„ç†ã€‚</li>
</ul>
<h5 id="2ã€å¸¦æ¡ä»¶çš„åˆ†é¡µæµå¼å¤„ç†"><a href="#2ã€å¸¦æ¡ä»¶çš„åˆ†é¡µæµå¼å¤„ç†" class="headerlink" title="2ã€å¸¦æ¡ä»¶çš„åˆ†é¡µæµå¼å¤„ç†"></a>2ã€å¸¦æ¡ä»¶çš„åˆ†é¡µæµå¼å¤„ç†</h5><p>é’ˆå¯¹ â€œéœ€ç­›é€‰æ¡ä»¶ + å¤§æ•°æ®é‡åˆ†æ‰¹å¤„ç†â€ åœºæ™¯ï¼Œç»“åˆ<strong>åˆ†é¡µï¼ˆæ§åˆ¶æ¯æ‰¹æ•°æ®é‡ï¼‰</strong> ä¸<strong>Lambda æ¡ä»¶ï¼ˆç­›é€‰ç›®æ ‡æ•°æ®ï¼‰</strong>ï¼Œé€šè¿‡ BaseMapper çš„<code>selectList</code>æ–¹æ³•ä¼ å…¥<code>Page</code>ï¼ˆåˆ†é¡µå‚æ•°ï¼‰ã€<code>LambdaQueryWrapper</code>ï¼ˆæŸ¥è¯¢æ¡ä»¶ï¼‰å’Œ<code>ResultHandler</code>ï¼ˆæ‰¹é‡å¤„ç†é€»è¾‘ï¼‰ï¼Œå®ç° â€œæŒ‰æ‰¹æ¬¡æµå¼å¤„ç†ç¬¦åˆæ¡ä»¶çš„æ•°æ®â€ï¼Œç²¾å‡†æ§åˆ¶å†…å­˜å ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. æ„å»ºåˆ†é¡µå¯¹è±¡ï¼šæ§åˆ¶æ¯æ‰¹å¤„ç†çš„æ•°æ®é‡ï¼ˆå½“å‰é¡µ=1ï¼Œæ¯é¡µå¤§å°=10000ï¼Œå³æ¯æ‰¹å¤„ç†1ä¸‡æ¡ï¼‰</span></span><br><span class="line">Page&lt;User&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(<span class="number">1</span>, <span class="number">10000</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ„å»ºLambdaæŸ¥è¯¢æ¡ä»¶ï¼šç­›é€‰â€œå¹´é¾„&gt;20â€çš„ç”¨æˆ·ï¼ˆå¯æ ¹æ®ä¸šåŠ¡æ‰©å±•æ¡ä»¶ï¼‰</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; wrapper = Wrappers.lambdaQuery();</span><br><span class="line">wrapper.gt(User::getAge, <span class="number">20</span>); <span class="comment">// ç­›é€‰æ¡ä»¶ï¼šage &gt; 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. è°ƒç”¨BaseMapperçš„selectListï¼Œå®ç°åˆ†é¡µæµå¼å¤„ç†</span></span><br><span class="line">userMapper.selectList(</span><br><span class="line">    page,          <span class="comment">// åˆ†é¡µå‚æ•°ï¼šæ§åˆ¶æ¯æ‰¹æ•°æ®é‡</span></span><br><span class="line">    wrapper,       <span class="comment">// æ¡ä»¶æ„é€ å™¨ï¼šç­›é€‰ç›®æ ‡æ•°æ®</span></span><br><span class="line">    context -&gt; &#123;   <span class="comment">// ç»“æœå¤„ç†å™¨ï¼šæ‰¹é‡å¤„ç†å½“å‰æ‰¹æ¬¡çš„æ•°æ®</span></span><br><span class="line">        <span class="comment">// 1. è·å–å½“å‰æ‰¹æ¬¡ä¸­çš„å•æ¡æ•°æ®</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> context.getResultObject();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æ‰¹é‡å¤„ç†é€»è¾‘ï¼ˆå¦‚æ‰¹é‡å†™å…¥æ•°æ®åº“ã€æ‰¹é‡å¯¼å‡ºExcelç­‰ï¼‰</span></span><br><span class="line">        <span class="comment">// ç¤ºä¾‹ï¼šå°†å½“å‰ç”¨æˆ·æ•°æ®æ·»åŠ åˆ°ä¸´æ—¶é›†åˆï¼Œç´¯è®¡åˆ°1000æ¡æ—¶ç»Ÿä¸€å¤„ç†</span></span><br><span class="line">        tempUserList.add(user);</span><br><span class="line">        <span class="keyword">if</span> (tempUserList.size() &gt;= <span class="number">1000</span>) &#123;</span><br><span class="line">            batchExport(tempUserList); <span class="comment">// è‡ªå®šä¹‰æ‰¹é‡å¯¼å‡ºæ–¹æ³•</span></span><br><span class="line">            tempUserList.clear(); <span class="comment">// æ¸…ç©ºé›†åˆï¼Œé‡Šæ”¾å†…å­˜</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>åˆ†é¡µå‚æ•°ä½œç”¨</strong>ï¼š<code>Page&lt;&gt;(1, 10000)</code>ä¸­ â€œ10000â€ ä¸º<strong>æ¯æ‰¹å¤„ç†çš„æœ€å¤§æ¡æ•°</strong>ï¼Œå³ä½¿å¾…å¤„ç†æ•°æ®æ€»é‡ä¸º 100 ä¸‡æ¡ï¼Œä¹Ÿä¼šè‡ªåŠ¨æ‹†åˆ†ä¸º 100 æ‰¹ï¼ˆæ¯æ‰¹ 1 ä¸‡æ¡ï¼‰é€æ­¥å¤„ç†ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½ 100 ä¸‡æ¡æ•°æ®åˆ°å†…å­˜ï¼›</li>
<li><strong>æ¡ä»¶ä¸æµå¼ç»“åˆ</strong>ï¼šLambda æ¡ä»¶ï¼ˆ<code>gt(User::getAge, 20)</code>ï¼‰å…ˆç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼Œå†æŒ‰åˆ†é¡µæ‰¹é‡æµå¼å¤„ç†ï¼Œé¿å…å¯¹æ— å…³æ•°æ®è¿›è¡Œæ— æ•ˆå¤„ç†ï¼Œæå‡æ•ˆç‡ï¼›</li>
<li><strong>æ‰¹é‡å¤„ç†ä¼˜åŠ¿</strong>ï¼šç›¸æ¯” â€œé€è¡Œå¤„ç†â€ï¼Œâ€œæ¯æ‰¹ 1 ä¸‡æ¡ + æ‰¹é‡é€»è¾‘â€ å‡å°‘ IO æ¬¡æ•°ï¼ˆå¦‚æ‰¹é‡å†™å…¥æ–‡ä»¶ &#x2F; æ•°æ®åº“ï¼‰ï¼Œå¹³è¡¡å†…å­˜å ç”¨ä¸å¤„ç†æ•ˆç‡ã€‚</li>
</ul>
<h4 id="4-3-åœºæ™¯é€‰æ‹©"><a href="#4-3-åœºæ™¯é€‰æ‹©" class="headerlink" title="4.3 åœºæ™¯é€‰æ‹©"></a>4.3 åœºæ™¯é€‰æ‹©</h4><table>
<thead>
<tr>
<th align="center">åœºæ™¯</th>
<th>æ¨èæ–¹æ¡ˆ</th>
<th>ç‰¹ç‚¹</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ç®€å•æµå¼å¤„ç†</td>
<td>ResultHandler</td>
<td>é…ç½®ç®€å•ï¼Œæ— éœ€äº‹åŠ¡</td>
</tr>
<tr>
<td align="center">Java8 æµå¼æ“ä½œ</td>
<td>Cursor</td>
<td>æ”¯æŒ Stream API</td>
</tr>
<tr>
<td align="center">å¤§æ•°æ®é‡æ‰¹å¤„ç†</td>
<td>åˆ†é¡µ + æµå¼</td>
<td>å†…å­˜æ§åˆ¶æ›´ç²¾ç¡®ï¼ˆæ¯æ‰¹ 1 ä¸‡æ¡ï¼‰</td>
</tr>
<tr>
<td align="center">å¤æ‚äº‹åŠ¡åœºæ™¯</td>
<td>@Transactional</td>
<td>ä¿è¯æ•°æ®ä¸€è‡´æ€§</td>
</tr>
</tbody></table>
<h4 id="4-4-æ³¨æ„äº‹é¡¹"><a href="#4-4-æ³¨æ„äº‹é¡¹" class="headerlink" title="4.4 æ³¨æ„äº‹é¡¹"></a>4.4 æ³¨æ„äº‹é¡¹</h4><ul>
<li>æµå¼æŸ¥è¯¢æœŸé—´ä¿æŒæ•°æ®åº“è¿æ¥æ‰“å¼€ï¼Œé¿å…ä¸­é€”æ–­è¿ï¼›</li>
<li>åˆç†è®¾ç½®<code>fetchSize</code>ï¼ˆ500-5000ï¼‰ï¼Œé¿å…é¢‘ç¹ IOï¼›</li>
<li>ä¸å»ºè®®åœ¨æµå¼å¤„ç†ä¸­æ‰§è¡Œå…¶ä»–æ•°æ®åº“æ“ä½œã€‚</li>
<li>ç»“æœé›†ç±»å‹å¿…é¡»ä¸º<code>FORWARD_ONLY</code></li>
</ul>
<h3 id="ç¬¬-5-ç« ï¼šæšä¸¾æ˜ å°„ï¼ˆè‡ªåŠ¨è½¬æ¢ï¼‰"><a href="#ç¬¬-5-ç« ï¼šæšä¸¾æ˜ å°„ï¼ˆè‡ªåŠ¨è½¬æ¢ï¼‰" class="headerlink" title="ç¬¬ 5 ç« ï¼šæšä¸¾æ˜ å°„ï¼ˆè‡ªåŠ¨è½¬æ¢ï¼‰"></a>ç¬¬ 5 ç« ï¼šæšä¸¾æ˜ å°„ï¼ˆè‡ªåŠ¨è½¬æ¢ï¼‰</h3><h4 id="5-1-ä¸¤ç§å®ç°æ–¹å¼"><a href="#5-1-ä¸¤ç§å®ç°æ–¹å¼" class="headerlink" title="5.1 ä¸¤ç§å®ç°æ–¹å¼"></a>5.1 ä¸¤ç§å®ç°æ–¹å¼</h4><ol>
<li><p><strong>@EnumValue æ³¨è§£ï¼ˆæ¨èï¼‰ï¼š</strong><br>é€šè¿‡ <code>@EnumValue</code> ç›´æ¥æ ‡è®°æšä¸¾ä¸­ â€œéœ€å­˜å…¥æ•°æ®åº“çš„å±æ€§â€ï¼ŒMyBatis-Plus ä¼šè‡ªåŠ¨å°†è¯¥å±æ€§å€¼ä¸æ•°æ®åº“å­—æ®µå…³è”ï¼Œæ”¯æŒ Stringã€Integer ç­‰å¤šç§ç±»å‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">GenderEnum</span> &#123;</span><br><span class="line">  MALE(<span class="string">&quot;M&quot;</span>, <span class="string">&quot;ç”·æ€§&quot;</span>), FEMALE(<span class="string">&quot;F&quot;</span>, <span class="string">&quot;å¥³æ€§&quot;</span>);</span><br><span class="line">  <span class="meta">@EnumValue</span> <span class="comment">// æ ‡è®°å­˜å…¥æ•°æ®åº“çš„å€¼</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> String code;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> String desc;</span><br><span class="line">  <span class="comment">// æ„é€ å™¨+getter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>å®ç° IEnum æ¥å£ï¼š</strong><br>é€šè¿‡å®ç° MyBatis-Plus æä¾›çš„ <code>IEnum</code> æ¥å£ï¼Œå¹¶è¦†å†™ <code>getValue()</code> æ–¹æ³•ï¼ŒæŒ‡å®š â€œå­˜å…¥æ•°æ®åº“çš„æšä¸¾å€¼â€ã€‚è¯¥æ–¹å¼éœ€å¼ºç»‘å®šæ¥å£ï¼Œçµæ´»æ€§ç•¥ä½äº <code>@EnumValue</code> æ³¨è§£ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">StatusEnum</span> <span class="keyword">implements</span> <span class="title class_">IEnum</span>&lt;Integer&gt; &#123;</span><br><span class="line">  LOCK(<span class="number">1</span>, <span class="string">&quot;é”å®š&quot;</span>), DISABLE(<span class="number">2</span>, <span class="string">&quot;ç¦ç”¨&quot;</span>);</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> String desc;</span><br><span class="line">  <span class="meta">@Override</span> <span class="keyword">public</span> Integer <span class="title function_">getValue</span><span class="params">()</span> &#123; <span class="keyword">return</span> <span class="built_in">this</span>.value; &#125; <span class="comment">// å¿…é¡»å®ç°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="5-2-é…ç½®å·®å¼‚"><a href="#5-2-é…ç½®å·®å¼‚" class="headerlink" title="5.2 é…ç½®å·®å¼‚"></a>5.2 é…ç½®å·®å¼‚</h4><ul>
<li><p><strong>3.5.2 + ç‰ˆæœ¬</strong>ï¼šæ— éœ€é¢å¤–é…ç½®ï¼Œç›´æ¥åœ¨å®ä½“ç±»ç”¨æšä¸¾å­—æ®µå³å¯ï¼›</p>
</li>
<li><p>3.5.2 ä¹‹å‰ï¼šéœ€åœ¨ application.yml é…ç½®æšä¸¾åŒ…è·¯å¾„ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">type-enums-package:</span> <span class="string">com.example.enums</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="5-3å®ä½“ç±»ä¸æ•°æ®åº“è®¾è®¡ï¼ˆå¯¹åº”å…³ç³»ï¼‰"><a href="#5-3å®ä½“ç±»ä¸æ•°æ®åº“è®¾è®¡ï¼ˆå¯¹åº”å…³ç³»ï¼‰" class="headerlink" title="5.3å®ä½“ç±»ä¸æ•°æ®åº“è®¾è®¡ï¼ˆå¯¹åº”å…³ç³»ï¼‰"></a>5.3å®ä½“ç±»ä¸æ•°æ®åº“è®¾è®¡ï¼ˆå¯¹åº”å…³ç³»ï¼‰</h4><h5 id="1-å®ä½“ç±»ä¸­ä½¿ç”¨æšä¸¾"><a href="#1-å®ä½“ç±»ä¸­ä½¿ç”¨æšä¸¾" class="headerlink" title="1. å®ä½“ç±»ä¸­ä½¿ç”¨æšä¸¾"></a>1. å®ä½“ç±»ä¸­ä½¿ç”¨æšä¸¾</h5><p>åœ¨å®ä½“ç±»ï¼ˆå¦‚ <code>User</code>ï¼‰ä¸­ç›´æ¥å£°æ˜æšä¸¾ç±»å‹å±æ€§ï¼Œæ— éœ€é¢å¤–æ³¨è§£ï¼ˆé™¤ <code>@Data</code> ç­‰ Lombok æ³¨è§£ï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(&quot;user&quot;)</span> <span class="comment">// å…³è”æ•°æ®åº“è¡¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id; <span class="comment">// ä¸»é”®</span></span><br><span class="line">    <span class="keyword">private</span> String name; <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æšä¸¾å±æ€§1ï¼šä½¿ç”¨IEnumæ¥å£çš„æšä¸¾ï¼ˆå¯¹åº”æ•°æ®åº“statuså­—æ®µï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> StatusEnum status; </span><br><span class="line">    <span class="comment">// æšä¸¾å±æ€§2ï¼šä½¿ç”¨@EnumValueæ³¨è§£çš„æšä¸¾ï¼ˆå¯¹åº”æ•°æ®åº“genderå­—æ®µï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> GenderEnum gender; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-æ•°æ®åº“è¡¨è®¾è®¡"><a href="#2-æ•°æ®åº“è¡¨è®¾è®¡" class="headerlink" title="2. æ•°æ®åº“è¡¨è®¾è®¡"></a>2. æ•°æ®åº“è¡¨è®¾è®¡</h5><p>æ•°æ®åº“è¡¨å­—æ®µç±»å‹éœ€ä¸æšä¸¾çš„ â€œæ˜ å°„å€¼ç±»å‹â€ ä¸€è‡´ï¼ˆå¦‚ <code>StatusEnum</code> çš„ <code>value</code> ä¸º <code>int</code>ï¼Œæ•°æ®åº“å­—æ®µè®¾ä¸º <code>INT</code>ï¼›<code>GenderEnum</code> çš„ <code>code</code> ä¸º <code>String</code>ï¼Œæ•°æ®åº“å­—æ®µè®¾ä¸º <code>CHAR(1)</code>ï¼‰ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> <span class="keyword">user</span> (</span><br><span class="line">    id <span class="type">BIGINT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT, <span class="comment">-- ä¸»é”®è‡ªå¢</span></span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>, <span class="comment">-- ç”¨æˆ·å</span></span><br><span class="line">    status <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> COMMENT <span class="string">&#x27;çŠ¶æ€ï¼ˆ1=é”å®šï¼Œ2=ç¦ç”¨ï¼‰&#x27;</span>, <span class="comment">-- å¯¹åº”StatusEnumçš„valueï¼ˆintç±»å‹ï¼‰</span></span><br><span class="line">    gender <span class="type">CHAR</span>(<span class="number">1</span>) COMMENT <span class="string">&#x27;æ€§åˆ«ï¼ˆM=ç”·æ€§ï¼ŒF=å¥³æ€§ï¼‰&#x27;</span> <span class="comment">-- å¯¹åº”GenderEnumçš„codeï¼ˆchar(1)ç±»å‹ï¼‰</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>

<h4 id="5-4-å¸¸è§é—®é¢˜"><a href="#5-4-å¸¸è§é—®é¢˜" class="headerlink" title="5.4 å¸¸è§é—®é¢˜"></a>5.4 å¸¸è§é—®é¢˜</h4><ul>
<li><strong>æšä¸¾å€¼ä¸º null</strong>ï¼šæ£€æŸ¥æ•°æ®åº“å­—æ®µç±»å‹ä¸æšä¸¾å€¼ç±»å‹åŒ¹é…ï¼ˆå¦‚ tinyint ä¸èƒ½æ˜ å°„ booleanï¼‰ï¼›</li>
<li><strong>JSON åºåˆ—åŒ–</strong>ï¼šç”¨ Jackson æ—¶æ·»åŠ <code>@JsonValue</code>æ³¨è§£æŒ‡å®šåºåˆ—åŒ–å€¼ï¼ˆå¦‚<code>@JsonValue private final String code</code>ï¼‰ã€‚</li>
</ul>
<h3 id="ç¬¬-6-ç« ï¼šè‡ªåŠ¨å¡«å……ï¼ˆå®¡è®¡å­—æ®µï¼‰"><a href="#ç¬¬-6-ç« ï¼šè‡ªåŠ¨å¡«å……ï¼ˆå®¡è®¡å­—æ®µï¼‰" class="headerlink" title="ç¬¬ 6 ç« ï¼šè‡ªåŠ¨å¡«å……ï¼ˆå®¡è®¡å­—æ®µï¼‰"></a>ç¬¬ 6 ç« ï¼šè‡ªåŠ¨å¡«å……ï¼ˆå®¡è®¡å­—æ®µï¼‰</h3><p>MyBatis-Plus æä¾›äº†å¼ºâ¼¤çš„â¾ƒåŠ¨å¡«å……åŠŸèƒ½ï¼Œå¯ä»¥â¾ƒåŠ¨ä¸ºåˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ç­‰å…¬å…±å­—æ®µèµ‹å€¼ï¼Œæâ¼¤ç®€åŒ–äº†å¼€å‘â¼¯ä½œã€‚ä»¥ä¸‹æ˜¯å®Œ æ•´çš„å®ç°â½…æ¡ˆï¼š</p>
<h4 id="6-1-åŸºç¡€é…ç½®"><a href="#6-1-åŸºç¡€é…ç½®" class="headerlink" title="6.1 åŸºç¡€é…ç½®"></a>6.1 åŸºç¡€é…ç½®</h4><ol>
<li><p>å®ä½“ç±»æ ‡æ³¨å¡«å……è§„åˆ™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="meta">@TableField(fill = FieldFill.INSERT)</span> <span class="comment">// æ’å…¥æ—¶å¡«å……ï¼ˆåˆ›å»ºæ—¶é—´/åˆ›å»ºäººï¼‰</span></span><br><span class="line">  <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line">  <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span> <span class="comment">// æ’å…¥+æ›´æ–°æ—¶å¡«å……ï¼ˆæ›´æ–°æ—¶é—´/æ›´æ–°äººï¼‰</span></span><br><span class="line">  <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line">  <span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">  <span class="keyword">private</span> Long createUser;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®ç° MetaObjectHandlerï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span> <span class="comment">// å¿…é¡»äº¤ç»™Springç®¡ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title class_">MetaObjectHandler</span> &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸¥æ ¼æ¨¡å¼ï¼šå­—æ®µç±»å‹å¿…é¡»åŒ¹é…ï¼ˆæ¨èï¼‰</span></span><br><span class="line">    <span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;createTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line">    <span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;createUser&quot;</span>, Long.class, getCurrentUserId());</span><br><span class="line">    <span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;updateTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.strictUpdateFill(metaObject, <span class="string">&quot;updateTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line">    <span class="built_in">this</span>.strictUpdateFill(metaObject, <span class="string">&quot;updateUser&quot;</span>, Long.class, getCurrentUserId());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ç”¨ThreadLocalè·å–å½“å‰ç”¨æˆ·IDï¼ˆç™»å½•æ—¶è®¾ç½®ï¼‰</span></span><br><span class="line">  <span class="keyword">private</span> Long <span class="title function_">getCurrentUserId</span><span class="params">()</span> &#123; <span class="keyword">return</span> BaseContext.getCurrentId(); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="6-2-é«˜çº§åŠŸèƒ½"><a href="#6-2-é«˜çº§åŠŸèƒ½" class="headerlink" title="6.2 é«˜çº§åŠŸèƒ½"></a>6.2 é«˜çº§åŠŸèƒ½</h4><ul>
<li><p><strong>ThreadLocal å­˜å‚¨ç”¨æˆ·</strong>ï¼š<code>BaseContext</code>ç±»ç”¨<code>static ThreadLocal&lt;Long&gt;</code>å­˜å½“å‰ç”¨æˆ· IDï¼Œç™»å½•æ‹¦æˆªå™¨ä¸­è®¾ç½®ï¼›</p>
<ul>
<li><pre><code class="java">public class BaseContext &#123;
     private static ThreadLocal&lt;Long&gt; threadLocal = new ThreadLocal&lt;&gt;();
     public static void setCurrentId(Long id) &#123;
            threadLocal.set(id);
         &#125;
     public static Long getCurrentId() &#123;
         return threadLocal.get();
         &#125;
 &#125;

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- åœ¨ç™»å½•è¿‡æ»¤å™¨æˆ–æ‹¦æˆªå™¨ä¸­è®¾ç½®â½¤æˆ·IDï¼š</span><br><span class="line">  ```java</span><br><span class="line">  //ç™»å½•æˆåŠŸåè®¾ç½®</span><br><span class="line">  BaseContext.setCurrentId(loginUser.getId())</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
<li><p>å¡«å……æ¨¡å¼ï¼š</p>
<ul>
<li>ä¸¥æ ¼æ¨¡å¼ï¼ˆ<code>strictInsertFill</code>ï¼‰ï¼šå­—æ®µç±»å‹ä¸åŒ¹é…åˆ™ä¸å¡«å……ï¼Œå®‰å…¨æ€§é«˜ï¼›</li>
<li>éä¸¥æ ¼æ¨¡å¼ï¼ˆ<code>setFieldValByName</code>ï¼‰ï¼šæ›´çµæ´»ï¼Œä½†æ˜“å‡ºé”™ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸¥æ ¼æ¨¡å¼ï¼ˆæ¨èï¼‰</span></span><br><span class="line"><span class="built_in">this</span>.strictInsertFill(metaObject, <span class="string">&quot;createTime&quot;</span>, LocalDateTime.class, LocalDateTime.now());</span><br><span class="line"> <span class="comment">// â¾®ä¸¥æ ¼æ¨¡å¼</span></span><br><span class="line">metaObject.setValue(<span class="string">&quot;createTime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="6-3-å¸¸è§é—®é¢˜"><a href="#6-3-å¸¸è§é—®é¢˜" class="headerlink" title="6.3 å¸¸è§é—®é¢˜"></a>6.3 å¸¸è§é—®é¢˜</h4><ul>
<li><strong>å¡«å……ä¸ç”Ÿæ•ˆ</strong>ï¼šæ£€æŸ¥<code>@Component</code>æ˜¯å¦æ·»åŠ ã€å®ä½“å­—æ®µåä¸å¡«å……æ–¹æ³•ä¸€è‡´ã€strict æ¨¡å¼ä¸‹ç±»å‹åŒ¹é…ï¼›</li>
<li><strong>æ—¶é—´ç±»å‹</strong>ï¼šæ¨èç”¨<code>LocalDateTime</code>ï¼ˆJDK8+ï¼‰ï¼Œé¿å…<code>Date</code>çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li>
</ul>
<h3 id="ç¬¬-7-ç« ï¼šä¸»é”®ç­–ç•¥"><a href="#ç¬¬-7-ç« ï¼šä¸»é”®ç­–ç•¥" class="headerlink" title="ç¬¬ 7 ç« ï¼šä¸»é”®ç­–ç•¥"></a>ç¬¬ 7 ç« ï¼šä¸»é”®ç­–ç•¥</h3><h4 id="7-1-ç­–ç•¥ç±»å‹ï¼ˆIdType-æšä¸¾ï¼‰"><a href="#7-1-ç­–ç•¥ç±»å‹ï¼ˆIdType-æšä¸¾ï¼‰" class="headerlink" title="7.1 ç­–ç•¥ç±»å‹ï¼ˆIdType æšä¸¾ï¼‰"></a>7.1 ç­–ç•¥ç±»å‹ï¼ˆIdType æšä¸¾ï¼‰</h4><table>
<thead>
<tr>
<th>ç­–ç•¥å€¼</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>AUTO</td>
<td>æ•°æ®åº“è‡ªå¢ï¼ˆéœ€è¡¨å­—æ®µè®¾ AUTO_INCREMENTï¼‰</td>
</tr>
<tr>
<td>NONE</td>
<td>è·Ÿéšå…¨å±€é…ç½®ï¼ˆé»˜è®¤å…¨å±€ä¸º ASSIGN_IDï¼‰</td>
</tr>
<tr>
<td>INPUT</td>
<td>æ‰‹åŠ¨è®¾ç½®ä¸»é”®ï¼ˆæˆ–å®ç° IKeyGeneratorï¼‰</td>
</tr>
<tr>
<td>ASSIGN_ID</td>
<td>è‡ªåŠ¨åˆ†é… IDï¼ˆé»˜è®¤é›ªèŠ±ç®—æ³•ï¼Œæ”¯æŒ Long&#x2F;Stringï¼‰</td>
</tr>
<tr>
<td>ASSIGN_UUID</td>
<td>è‡ªåŠ¨åˆ†é… UUIDï¼ˆString ç±»å‹ï¼Œæ— ä¸­åˆ’çº¿ï¼‰</td>
</tr>
</tbody></table>
<h4 id="7-2-é…ç½®ä¼˜å…ˆçº§"><a href="#7-2-é…ç½®ä¼˜å…ˆçº§" class="headerlink" title="7.2 é…ç½®ä¼˜å…ˆçº§"></a>7.2 é…ç½®ä¼˜å…ˆçº§</h4><ol>
<li><p><strong>å±€éƒ¨æ³¨è§£ï¼ˆæœ€é«˜ï¼‰</strong>ï¼š<code>@TableId(type = IdType.AUTO) private Long id</code>ï¼›</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Permission</span> &#123;</span><br><span class="line">    <span class="meta">@TableId(value = &quot;id&quot;, type = IdType.AUTO)</span> <span class="comment">// æ•°æ®åº“â¾ƒå¢</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="meta">@TableId(type = IdType.ASSIGN_ID)</span> <span class="comment">// é›ªèŠ±ç®—æ³•ï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> String orderId;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å…¨å±€é…ç½®ï¼ˆä¸­ï¼‰ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">assign_id</span> <span class="comment"># å…¨å±€é»˜è®¤é›ªèŠ±ç®—æ³•</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>é»˜è®¤ç­–ç•¥ï¼ˆæœ€ä½ï¼‰</strong>ï¼šæœªé…ç½®æ—¶é»˜è®¤ <code> ASSIGN_ID</code>ã€‚</p>
</li>
</ol>
<h4 id="7-3-ç­–ç•¥è¯¦è§£"><a href="#7-3-ç­–ç•¥è¯¦è§£" class="headerlink" title="7.3 ç­–ç•¥è¯¦è§£"></a>7.3 ç­–ç•¥è¯¦è§£</h4><ul>
<li><p><strong>é›ªèŠ±ç®—æ³•ï¼ˆASSIGN_IDï¼‰</strong>ï¼š é»˜è®¤å®ç°ç±»ï¼š<code> DefaultIdentifierGenerator</code></p>
<ul>
<li>64 ä½ IDï¼ˆ1 ç¬¦å·ä½ + 41 æ—¶é—´æˆ³ + 10 æœºå™¨ ID+12 åºåˆ—å·ï¼‰ï¼Œæ”¯æŒåˆ†å¸ƒå¼ï¼Œæ¯ç§’ç”Ÿæˆ 400 ä¸‡ + IDï¼›</li>
</ul>
</li>
<li><p><strong>æ•°æ®åº“è‡ªå¢ï¼ˆAUTOï¼‰</strong>ï¼šéœ€è¡¨å­—æ®µè®¾<code>AUTO_INCREMENT</code>ï¼Œé€‚åˆå•æœºé¡¹ç›®ï¼›</p>
<ul>
<li><p>å®ä½“ç±»é…ç½®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line"><span class="keyword">private</span> Long id;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>UUIDï¼ˆASSIGN_UUIDï¼‰</strong>ï¼šæ— éœ€æ•°æ®åº“ä¾èµ–ï¼Œé€‚åˆå­—ç¬¦ä¸²ä¸»é”®åœºæ™¯ã€‚</p>
<ul>
<li><pre><code class="java">@TableId(type = IdType.ASSIGN_UUID)
 private String uuid;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 7.4 è‡ªå®šä¹‰ç­–ç•¥</span><br><span class="line"></span><br><span class="line">å®ç°`IdentifierGenerator`æ¥å£ï¼š</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">@Component</span><br><span class="line">public class CustomIdGenerator implements IdentifierGenerator &#123;</span><br><span class="line">  @Override</span><br><span class="line">  public Long nextId(Object entity) &#123;</span><br><span class="line">    return IdWorker.getId(); // è‡ªå®šä¹‰IDç”Ÿæˆé€»è¾‘</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="ç¬¬-8-ç« ï¼šé€»è¾‘åˆ é™¤ï¼ˆè½¯åˆ é™¤ï¼‰"><a href="#ç¬¬-8-ç« ï¼šé€»è¾‘åˆ é™¤ï¼ˆè½¯åˆ é™¤ï¼‰" class="headerlink" title="ç¬¬ 8 ç« ï¼šé€»è¾‘åˆ é™¤ï¼ˆè½¯åˆ é™¤ï¼‰"></a>ç¬¬ 8 ç« ï¼šé€»è¾‘åˆ é™¤ï¼ˆè½¯åˆ é™¤ï¼‰</h3><h4 id="8-1-åŸºç¡€å®ç°"><a href="#8-1-åŸºç¡€å®ç°" class="headerlink" title="8.1 åŸºç¡€å®ç°"></a>8.1 åŸºç¡€å®ç°</h4><ol>
<li><p><strong>æ•°æ®åº“å‡†å¤‡</strong>ï¼šæ·»åŠ é€»è¾‘åˆ é™¤å­—æ®µ<code>ALTER TABLE user ADD COLUMN deleted TINYINT DEFAULT 0 COMMENT &#39;é€»è¾‘åˆ é™¤æ ‡è¯†&#39;</code>ï¼›</p>
</li>
<li><p>é…ç½®æ–¹å¼ï¼š</p>
<ul>
<li><p>æ–¹å¼ 1ï¼šå®ä½“ç±»æ³¨è§£<code>@TableLogic private Integer deleted</code>ï¼›</p>
</li>
<li><p>æ–¹å¼ 2ï¼šå…¨å±€é…ç½®ï¼ˆæ¨èï¼Œç»Ÿä¸€è§„åˆ™ï¼‰ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">logic-delete-field:</span> <span class="string">deleted</span> <span class="comment"># å®ä½“ç±»å­—æ®µå</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="number">1</span> <span class="comment"># å·²åˆ é™¤å€¼</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span> <span class="comment"># æœªåˆ é™¤å€¼</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h4 id="8-2-æ ¸å¿ƒç‰¹æ€§"><a href="#8-2-æ ¸å¿ƒç‰¹æ€§" class="headerlink" title="8.2 æ ¸å¿ƒç‰¹æ€§"></a>8.2 æ ¸å¿ƒç‰¹æ€§</h4><ul>
<li>è‡ªåŠ¨ SQL æ”¹å†™ï¼š<ul>
<li>åˆ é™¤ï¼š<code>DELETE FROM user WHERE id=?</code> â†’ <code>UPDATE user SET deleted=1 WHERE id=? AND deleted=0</code>ï¼›</li>
<li>æŸ¥è¯¢ï¼šè‡ªåŠ¨æ·»åŠ <code>WHERE deleted=0</code>ï¼ˆæ— éœ€æ‰‹åŠ¨å†™æ¡ä»¶ï¼‰ï¼›</li>
</ul>
</li>
<li><strong>æ— æ„ŸçŸ¥ä½¿ç”¨</strong>ï¼šè°ƒç”¨<code>userMapper.deleteById(id)</code>å³å¯è§¦å‘é€»è¾‘åˆ é™¤ï¼Œä¸ç‰©ç†åˆ é™¤ç”¨æ³•ä¸€è‡´ã€‚</li>
</ul>
<h4 id="8-3-æ³¨æ„äº‹é¡¹"><a href="#8-3-æ³¨æ„äº‹é¡¹" class="headerlink" title="8.3 æ³¨æ„äº‹é¡¹"></a>8.3 æ³¨æ„äº‹é¡¹</h4><ul>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šä¸º<code>deleted</code>å­—æ®µåŠ ç´¢å¼•ï¼ˆ<code>ALTER TABLE user ADD INDEX idx_deleted (deleted)</code>ï¼‰ï¼›</li>
<li><strong>æŸ¥è¯¢å·²åˆ é™¤æ•°æ®</strong>ï¼šç”¨<code>wrapper.last(&quot;OR deleted = 1&quot;)</code>å…³é—­è‡ªåŠ¨è¿‡æ»¤ï¼›</li>
<li><strong>è‡ªå®šä¹‰ SQL</strong>ï¼šæ‰‹å†™ SQL éœ€æ‰‹åŠ¨å¤„ç†<code>deleted</code>æ¡ä»¶ã€‚</li>
</ul>
<h4 id="8-4é«˜çº§ç”¨æ³•"><a href="#8-4é«˜çº§ç”¨æ³•" class="headerlink" title="8.4é«˜çº§ç”¨æ³•"></a>8.4é«˜çº§ç”¨æ³•</h4><ol>
<li>æŸ¥è¯¢åŒ…å«å·²åˆ é™¤æ•°æ®</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. åˆ›å»ºLambdaQueryWrapperï¼ŒæŸ¥è¯¢IDä¸º1çš„ç”¨æˆ·ï¼ˆåŒ…å«å·²åˆ é™¤æ•°æ®ï¼‰</span></span><br><span class="line">LambdaQueryWrapper&lt;User&gt; wrapper = Wrappers.lambdaQuery();</span><br><span class="line">wrapper.eq(User::getId, <span class="number">1L</span>) <span class="comment">// åŸºç¡€æ¡ä»¶ï¼šID = 1</span></span><br><span class="line">       .last(<span class="string">&quot;OR deleted = 1&quot;</span>); <span class="comment">// å…³é”®ï¼šè¿½åŠ æ¡ä»¶ï¼ŒåŒ…å«å·²åˆ é™¤æ•°æ®ï¼ˆå‡è®¾å·²åˆ é™¤å€¼ä¸º1ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ‰§è¡ŒæŸ¥è¯¢ï¼šè¿”å›ID=1çš„æ‰€æœ‰æ•°æ®ï¼ˆæ— è®ºæ˜¯å¦åˆ é™¤ï¼‰</span></span><br><span class="line">List&lt;User&gt; userList = userMapper.selectList(wrapper);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>â¾ƒå®šä¹‰åˆ é™¤å€¼</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// è‡ªå®šä¹‰é€»è¾‘åˆ é™¤å€¼ï¼šæœªåˆ é™¤=0ï¼Œå·²åˆ é™¤=2ï¼ˆè¦†ç›–é»˜è®¤çš„0/1ï¼‰</span></span><br><span class="line"><span class="comment">//@TableLogic æ³¨è§£çš„ valueï¼ˆæœªåˆ é™¤å€¼ï¼‰å’Œ delvalï¼ˆå·²åˆ é™¤å€¼ï¼‰å‚æ•°é…ç½®ï¼Œä¼˜å…ˆçº§é«˜äºå…¨å±€é…ç½®ã€‚</span></span><br><span class="line">   <span class="meta">@TableLogic(value = &quot;0&quot;, delval = &quot;2&quot;)</span> </span><br><span class="line">   <span class="keyword">private</span> Integer deleted; <span class="comment">// é€»è¾‘åˆ é™¤å­—æ®µ</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å…¨å±€é…ç½®ä¼˜å…ˆçº§</li>
</ol>
<table>
<thead>
<tr>
<th>é…ç½®å±‚çº§</th>
<th>é…ç½®æ–¹å¼</th>
<th>ä¼˜å…ˆçº§</th>
</tr>
</thead>
<tbody><tr>
<td>æ³¨è§£é…ç½®</td>
<td>åœ¨å®ä½“ç±»å­—æ®µä¸Šç”¨ <code>@TableLogic(value = &quot;...&quot;, delval = &quot;...&quot;)</code> é…ç½®</td>
<td>æœ€é«˜</td>
</tr>
<tr>
<td>å…¨å±€é…ç½®</td>
<td>åœ¨ <code>application.yml</code> ä¸­é€šè¿‡ <code>mybatis-plus.global-config.db-config</code> é…ç½®</td>
<td>ä¸­é—´</td>
</tr>
<tr>
<td>é»˜è®¤é…ç½®</td>
<td>æœªä»»ä½•é…ç½®æ—¶ï¼Œé»˜è®¤ â€œæœªåˆ é™¤ &#x3D; 0ï¼Œå·²åˆ é™¤ &#x3D; 1â€ï¼Œé€»è¾‘åˆ é™¤å­—æ®µåä¸º <code>deleted</code></td>
<td>æœ€ä½</td>
</tr>
</tbody></table>
<h3 id="ç¬¬-9-ç« ï¼šå¤šæ•°æ®æºï¼ˆåŠ¨æ€åˆ‡æ¢ï¼‰"><a href="#ç¬¬-9-ç« ï¼šå¤šæ•°æ®æºï¼ˆåŠ¨æ€åˆ‡æ¢ï¼‰" class="headerlink" title="ç¬¬ 9 ç« ï¼šå¤šæ•°æ®æºï¼ˆåŠ¨æ€åˆ‡æ¢ï¼‰"></a>ç¬¬ 9 ç« ï¼šå¤šæ•°æ®æºï¼ˆåŠ¨æ€åˆ‡æ¢ï¼‰</h3><h4 id="9-1-åŸºç¡€é…ç½®"><a href="#9-1-åŸºç¡€é…ç½®" class="headerlink" title="9.1 åŸºç¡€é…ç½®"></a>9.1 åŸºç¡€é…ç½®</h4><ol>
<li><p>å¼•å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dynamic-datasource-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>YAML é…ç½®ï¼ˆä¸»ä»åˆ†ç¦»ç¤ºä¾‹ï¼‰ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">dynamic:</span></span><br><span class="line">      <span class="attr">primary:</span> <span class="string">master</span> <span class="comment"># é»˜è®¤æ•°æ®æº</span></span><br><span class="line">      <span class="attr">strict:</span> <span class="literal">false</span> <span class="comment"># ä¸ä¸¥æ ¼åŒ¹é…æ•°æ®æºï¼ˆä¸å­˜åœ¨æ—¶ç”¨é»˜è®¤ï¼‰</span></span><br><span class="line">      <span class="attr">datasource:</span></span><br><span class="line">        <span class="attr">master:</span></span><br><span class="line">          <span class="attr">url:</span> <span class="string">jdbc:mysql://ä½ çš„æ•°æ®åº“url?useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line">          <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">          <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">        <span class="attr">slave1:</span></span><br><span class="line">          <span class="attr">url:</span> <span class="string">jdbc:mysql://ä½ çš„æ•°æ®åº“url?useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line">          <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">          <span class="attr">password:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="9-2-æ ¸å¿ƒä½¿ç”¨æ–¹å¼"><a href="#9-2-æ ¸å¿ƒä½¿ç”¨æ–¹å¼" class="headerlink" title="9.2 æ ¸å¿ƒä½¿ç”¨æ–¹å¼"></a>9.2 æ ¸å¿ƒä½¿ç”¨æ–¹å¼</h4><ol>
<li><p>æ³¨è§£åˆ‡æ¢ï¼ˆ@DSï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@DS(&quot;slave1&quot;)</span> <span class="comment">// ç±»çº§åˆ«é»˜è®¤æ•°æ®æº</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> &#123;</span><br><span class="line">  <span class="meta">@DS(&quot;master&quot;)</span> <span class="comment">// æ–¹æ³•çº§åˆ«è¦†ç›–ï¼ˆä¼˜å…ˆçº§æ›´é«˜ï¼‰</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(User user)</span> &#123; userMapper.insert(user); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–ç¨‹å¼åˆ‡æ¢ï¼ˆåŠ¨æ€åœºæ™¯ï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  DynamicDataSourceContextHolder.push(<span class="string">&quot;slave2&quot;</span>); <span class="comment">// åˆ‡æ¢åˆ°slave2</span></span><br><span class="line">  <span class="comment">// æ‰§è¡Œæ•°æ®åº“æ“ä½œ</span></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">  DynamicDataSourceContextHolder.clear(); <span class="comment">// å¿…é¡»æ¸…ç†ï¼Œé¿å…è¿æ¥æ³„æ¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="9-3-æœ€ä½³å®è·µ"><a href="#9-3-æœ€ä½³å®è·µ" class="headerlink" title="9.3 æœ€ä½³å®è·µ"></a>9.3 æœ€ä½³å®è·µ</h4><ul>
<li><strong>è¿æ¥æ± </strong>ï¼šæ¨èé…åˆ Druid æˆ– HikariCP ä½¿ç”¨ï¼›</li>
<li><strong>äº‹åŠ¡</strong>ï¼šè·¨æ•°æ®æºæ“ä½œéœ€ç”¨<code>@DSTransactional</code>ï¼ˆè€Œé<code>@Transactional</code>ï¼‰ï¼›</li>
<li><strong>ç›‘æ§</strong>ï¼šé›†æˆ Actuator ç›‘æ§å„æ•°æ®æºè¿æ¥çŠ¶æ€ã€‚</li>
</ul>
<h3 id="ç¬¬-10-ç« ï¼šç±»å‹å¤„ç†å™¨ï¼ˆå­—æ®µè½¬æ¢ï¼‰"><a href="#ç¬¬-10-ç« ï¼šç±»å‹å¤„ç†å™¨ï¼ˆå­—æ®µè½¬æ¢ï¼‰" class="headerlink" title="ç¬¬ 10 ç« ï¼šç±»å‹å¤„ç†å™¨ï¼ˆå­—æ®µè½¬æ¢ï¼‰"></a>ç¬¬ 10 ç« ï¼šç±»å‹å¤„ç†å™¨ï¼ˆå­—æ®µè½¬æ¢ï¼‰</h3><h4 id="10-1-å†…ç½®-JSON-å¤„ç†å™¨ï¼ˆå¸¸ç”¨ï¼‰"><a href="#10-1-å†…ç½®-JSON-å¤„ç†å™¨ï¼ˆå¸¸ç”¨ï¼‰" class="headerlink" title="10.1 å†…ç½® JSON å¤„ç†å™¨ï¼ˆå¸¸ç”¨ï¼‰"></a>10.1 å†…ç½® JSON å¤„ç†å™¨ï¼ˆå¸¸ç”¨ï¼‰</h4><ol>
<li><p>é…ç½®æ­¥éª¤ï¼š</p>
<ul>
<li>å®ä½“ç±»ï¼š<code>@TableName(autoResultMap = true)</code>ï¼ˆå¿…é¡»å¼€å¯ï¼‰+<code>@TableField(typeHandler = JacksonTypeHandler.class)</code>ï¼›</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(autoResultMap = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">  <span class="meta">@TableField(typeHandler = JacksonTypeHandler.class)</span></span><br><span class="line">  <span class="keyword">private</span> Map&lt;String, String&gt; contact; <span class="comment">// è‡ªåŠ¨è½¬ä¸ºJSONå­˜å‚¨åˆ°æ•°æ®åº“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å¼•å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>æµ‹è¯•</strong>ï¼šæ’å…¥æ—¶<code>contact</code>ï¼ˆMapï¼‰è‡ªåŠ¨è½¬ JSONï¼ŒæŸ¥è¯¢æ—¶è‡ªåŠ¨è½¬ Mapã€‚</p>
</li>
</ol>
<h4 id="10-2-æ³¨æ„äº‹é¡¹"><a href="#10-2-æ³¨æ„äº‹é¡¹" class="headerlink" title="10.2 æ³¨æ„äº‹é¡¹"></a>10.2 æ³¨æ„äº‹é¡¹</h4><ul>
<li><code>@TableName(autoResultMap = true)</code>å¿…é¡»åŠ ï¼Œå¦åˆ™æŸ¥è¯¢æ—¶æ— æ³•ååºåˆ—åŒ–ï¼›</li>
<li>å­—æ®µä¸º null æ—¶ï¼Œæ£€æŸ¥ç±»å‹å¤„ç†å™¨æ˜¯å¦æ³¨å†Œã€æ•°æ®åº“å­—æ®µæ˜¯å¦å…è®¸ NULLã€‚</li>
</ul>
<h3 id="ç¬¬-11-ç« ï¼šæ‰©å±•æ’ä»¶ï¼ˆç”Ÿäº§å¿…å¤‡ï¼‰"><a href="#ç¬¬-11-ç« ï¼šæ‰©å±•æ’ä»¶ï¼ˆç”Ÿäº§å¿…å¤‡ï¼‰" class="headerlink" title="ç¬¬ 11 ç« ï¼šæ‰©å±•æ’ä»¶ï¼ˆç”Ÿäº§å¿…å¤‡ï¼‰"></a>ç¬¬ 11 ç« ï¼šæ‰©å±•æ’ä»¶ï¼ˆç”Ÿäº§å¿…å¤‡ï¼‰</h3><h4 id="11-1-åˆ†é¡µæ’ä»¶ï¼ˆPaginationInnerInterceptorï¼‰"><a href="#11-1-åˆ†é¡µæ’ä»¶ï¼ˆPaginationInnerInterceptorï¼‰" class="headerlink" title="11.1 åˆ†é¡µæ’ä»¶ï¼ˆPaginationInnerInterceptorï¼‰"></a>11.1 åˆ†é¡µæ’ä»¶ï¼ˆPaginationInnerInterceptorï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> &#123;</span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½®æ•°æ®åº“ç±»å‹ï¼ˆMySQL/Oracleç­‰ï¼‰</span></span><br><span class="line">    interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">    <span class="keyword">return</span> interceptor;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ï¼šæŸ¥è¯¢ç¬¬1é¡µï¼Œæ¯é¡µ10æ¡ï¼Œæ¡ä»¶â€œstatus=1â€</span></span><br><span class="line">Page&lt;User&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">userMapper.selectPage(page, Wrappers.&lt;User&gt;query().eq(<span class="string">&quot;status&quot;</span>, <span class="number">1</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;æ€»è®°å½•æ•°ï¼š&quot;</span> + page.getTotal());</span><br></pre></td></tr></table></figure>

<h4 id="11-2-ä¹è§‚é”æ’ä»¶ï¼ˆOptimisticLockerInnerInterceptorï¼‰"><a href="#11-2-ä¹è§‚é”æ’ä»¶ï¼ˆOptimisticLockerInnerInterceptorï¼‰" class="headerlink" title="11.2 ä¹è§‚é”æ’ä»¶ï¼ˆOptimisticLockerInnerInterceptorï¼‰"></a>11.2 ä¹è§‚é”æ’ä»¶ï¼ˆOptimisticLockerInnerInterceptorï¼‰</h4><ul>
<li><p><strong>ä½œç”¨</strong>ï¼šè§£å†³é«˜å¹¶å‘æ•°æ®å†²çªï¼ˆåŸºäºç‰ˆæœ¬å·ï¼‰ï¼›</p>
</li>
<li><p>é…ç½®ï¼š</p>
<ol>
<li>å®ä½“ç±»åŠ ç‰ˆæœ¬å­—æ®µï¼š<code>@Version private Integer version</code>ï¼›</li>
<li>æ³¨å†Œæ’ä»¶ï¼ˆåŒä¸Š<code>MybatisPlusConfig</code>ï¼‰ï¼›</li>
</ol>
</li>
<li><p>æµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> userMapper.selectById(<span class="number">1L</span>); <span class="comment">// version=1</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> userMapper.selectById(<span class="number">1L</span>); <span class="comment">// version=1</span></span><br><span class="line">user1.setName(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">userMapper.updateById(user1); <span class="comment">// æˆåŠŸï¼Œversion=2</span></span><br><span class="line">user2.setName(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">userMapper.updateById(user2); <span class="comment">// å¤±è´¥ï¼Œversionä¸åŒ¹é…</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="11-3-é˜²å…¨è¡¨æ“ä½œæ’ä»¶ï¼ˆBlockAttackInnerInterceptorï¼‰"><a href="#11-3-é˜²å…¨è¡¨æ“ä½œæ’ä»¶ï¼ˆBlockAttackInnerInterceptorï¼‰" class="headerlink" title="11.3 é˜²å…¨è¡¨æ“ä½œæ’ä»¶ï¼ˆBlockAttackInnerInterceptorï¼‰"></a>11.3 é˜²å…¨è¡¨æ“ä½œæ’ä»¶ï¼ˆBlockAttackInnerInterceptorï¼‰</h4><ul>
<li><p><strong>ä½œç”¨</strong>ï¼šé˜»æ­¢<code>delete null</code>&#x2F;<code>update null</code>ï¼ˆé¿å…è¯¯åˆ å…¨è¡¨ï¼‰ï¼›</p>
</li>
<li><p><strong>é…ç½®</strong>ï¼šæ³¨å†Œæ’ä»¶åï¼Œæ‰§è¡Œ<code>userMapper.delete(null)</code>ä¼šæŠ›å‡º<code>MybatisPlusException</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"> <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line"> <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">    interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">BlockAttackInnerInterceptor</span>());</span><br><span class="line"> <span class="keyword">return</span> interceptor;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// æµ‹è¯•â¾®æ³•æ“ä½œï¼ˆä¼šæŠ›å‡ºå¼‚å¸¸ï¼‰</span></span><br><span class="line">userMapper.delete(<span class="literal">null</span>); <span class="comment">// æŠ›å‡ºMybatisPlusException</span></span><br><span class="line"> userMapper.update(<span class="keyword">new</span> <span class="title class_">User</span>(), <span class="literal">null</span>); <span class="comment">// æŠ›å‡ºå¼‚å¸¸</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="11-4-åŠ¨æ€è¡¨åæ’ä»¶ï¼ˆDynamicTableNameInnerInterceptorï¼‰"><a href="#11-4-åŠ¨æ€è¡¨åæ’ä»¶ï¼ˆDynamicTableNameInnerInterceptorï¼‰" class="headerlink" title="11.4 åŠ¨æ€è¡¨åæ’ä»¶ï¼ˆDynamicTableNameInnerInterceptorï¼‰"></a>11.4 åŠ¨æ€è¡¨åæ’ä»¶ï¼ˆDynamicTableNameInnerInterceptorï¼‰</h4><ul>
<li><p><strong>ä½œç”¨</strong>ï¼šæŒ‰è§„åˆ™åŠ¨æ€åˆ‡æ¢è¡¨åï¼ˆå¦‚åˆ†å¹´è¡¨<code>order_2024</code>&#x2F;<code>order_2025</code>ï¼‰ï¼›</p>
</li>
<li><p>é…ç½®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">DynamicTableNameInnerInterceptor</span>() &#123;&#123;</span><br><span class="line">  setTableNameHandler((sql, tableName) -&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;order&quot;</span>.equals(tableName)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;order_&quot;</span> + LocalDate.now().getYear(); <span class="comment">// åŠ¨æ€æ‹¼æ¥å¹´ä»½</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tableName;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="11-5-å¤šç§Ÿæˆ·æ’ä»¶ï¼ˆTenantLineInnerInterceptorï¼‰"><a href="#11-5-å¤šç§Ÿæˆ·æ’ä»¶ï¼ˆTenantLineInnerInterceptorï¼‰" class="headerlink" title="11.5 å¤šç§Ÿæˆ·æ’ä»¶ï¼ˆTenantLineInnerInterceptorï¼‰"></a>11.5 å¤šç§Ÿæˆ·æ’ä»¶ï¼ˆTenantLineInnerInterceptorï¼‰</h4><ul>
<li><p><strong>ä½œç”¨</strong>ï¼šæ•°æ®éš”ç¦»ï¼ˆè‡ªåŠ¨ç»™ SQL åŠ <code>tenant_id = ?</code>æ¡ä»¶ï¼‰ï¼›</p>
</li>
<li><p>é…ç½®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">TenantLineInnerInterceptor</span>(<span class="keyword">new</span> <span class="title class_">TenantLineHandler</span>() &#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> Expression <span class="title function_">getTenantId</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LongValue</span>(<span class="number">1L</span>); <span class="comment">// ä»ä¸Šä¸‹æ–‡è·å–å½“å‰ç§Ÿæˆ·IDï¼ˆå¦‚ThreadLocalï¼‰</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getTenantIdColumn</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;tenant_id&quot;</span>; <span class="comment">// ç§Ÿæˆ·å­—æ®µå</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"> <span class="comment">// å®ä½“ç±»éœ€åŒ…å«tenant_idå­—æ®µ</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">     <span class="keyword">private</span> Long tenantId;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®ä½“ç±»éœ€åŒ…å«<code>tenant_id</code>å­—æ®µã€‚</p>
</li>
</ul>
<h4 id="11-6-æ’ä»¶æ‰§è¡Œé¡ºåºï¼ˆæ¨èï¼‰"><a href="#11-6-æ’ä»¶æ‰§è¡Œé¡ºåºï¼ˆæ¨èï¼‰" class="headerlink" title="11.6 æ’ä»¶æ‰§è¡Œé¡ºåºï¼ˆæ¨èï¼‰"></a>11.6 æ’ä»¶æ‰§è¡Œé¡ºåºï¼ˆæ¨èï¼‰</h4><ol>
<li>å¤šç§Ÿæˆ·æ’ä»¶ï¼ˆTenantLineInnerInterceptorï¼‰</li>
<li>åŠ¨æ€è¡¨åæ’ä»¶ï¼ˆDynamicTableNameInnerInterceptorï¼‰</li>
<li>åˆ†é¡µæ’ä»¶ï¼ˆPaginationInnerInterceptorï¼‰</li>
<li>ä¹è§‚é”æ’ä»¶ï¼ˆOptimisticLockerInnerInterceptorï¼‰</li>
<li>é˜²å…¨è¡¨æ’ä»¶ï¼ˆBlockAttackInnerInterceptorï¼‰</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">TenantLineInnerInterceptor</span>()); <span class="comment">// å¤šç§Ÿæˆ·ç¬¬â¼€</span></span><br><span class="line">interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">DynamicTableNameInnerInterceptor</span>()); <span class="comment">// åŠ¨æ€è¡¨åç¬¬â¼†</span></span><br><span class="line">interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>()); <span class="comment">// åˆ†â»šç¬¬ä¸‰</span></span><br><span class="line">interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">OptimisticLockerInnerInterceptor</span>()); <span class="comment">// ä¹è§‚é”ç¬¬å››</span></span><br><span class="line">interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">BlockAttackInnerInterceptor</span>()); <span class="comment">// é˜²å…¨è¡¨æœ€å</span></span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬-12-ç« ï¼šä»£ç ç”Ÿæˆï¼ˆæ•ˆç‡æå‡-200-ï¼‰"><a href="#ç¬¬-12-ç« ï¼šä»£ç ç”Ÿæˆï¼ˆæ•ˆç‡æå‡-200-ï¼‰" class="headerlink" title="ç¬¬ 12 ç« ï¼šä»£ç ç”Ÿæˆï¼ˆæ•ˆç‡æå‡ 200%ï¼‰"></a>ç¬¬ 12 ç« ï¼šä»£ç ç”Ÿæˆï¼ˆæ•ˆç‡æå‡ 200%ï¼‰</h3><h4 id="12-1-åŸºç¡€é…ç½®ï¼ˆFastAutoGeneratorï¼‰"><a href="#12-1-åŸºç¡€é…ç½®ï¼ˆFastAutoGeneratorï¼‰" class="headerlink" title="12.1 åŸºç¡€é…ç½®ï¼ˆFastAutoGeneratorï¼‰"></a>12.1 åŸºç¡€é…ç½®ï¼ˆFastAutoGeneratorï¼‰</h4><ol>
<li><p>å¼•å…¥ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ç”Ÿæˆå™¨ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AutoCodeGenerator</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://10.211.55.7:3306/mybatis_plus_demo?useSSL=false&amp;serverTimezone=UTC&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">tableName</span> <span class="operator">=</span> <span class="string">&quot;test_code_generator&quot;</span>; <span class="comment">// å¤šè¡¨ç”¨é€—å·åˆ†éš”</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">projectPath</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    FastAutoGenerator.create(<span class="keyword">new</span> <span class="title class_">DataSourceConfig</span>.Builder(url, username, password))</span><br><span class="line">      <span class="comment">// å…¨å±€é…ç½®ï¼šä½œè€…ã€è¾“å‡ºè·¯å¾„</span></span><br><span class="line">      .globalConfig(builder -&gt; builder.author(<span class="string">&quot;ä¹å“¥èŠç¼–ç¨‹&quot;</span>).outputDir(projectPath + <span class="string">&quot;/src/main/java&quot;</span>))</span><br><span class="line">      <span class="comment">// åŒ…é…ç½®ï¼šçˆ¶åŒ…åã€æ¨¡å—åã€å„å±‚åŒ…å</span></span><br><span class="line">      .packageConfig(builder -&gt; builder</span><br><span class="line">        .parent(<span class="string">&quot;com.lglbc&quot;</span>)</span><br><span class="line">        .moduleName(<span class="string">&quot;demo&quot;</span>)</span><br><span class="line">        .entity(<span class="string">&quot;entity&quot;</span>)</span><br><span class="line">        .mapper(<span class="string">&quot;mapper&quot;</span>)</span><br><span class="line">        .service(<span class="string">&quot;service&quot;</span>)</span><br><span class="line">        .controller(<span class="string">&quot;controller&quot;</span>)</span><br><span class="line">      )</span><br><span class="line">      <span class="comment">// ç­–ç•¥é…ç½®ï¼šè¡¨åã€ä¸»é”®ç­–ç•¥ã€å‘½åè§„åˆ™</span></span><br><span class="line">      .strategyConfig(builder -&gt; builder</span><br><span class="line">        .addInclude(tableName.split(<span class="string">&quot;,&quot;</span>))</span><br><span class="line">        .entityBuilder()</span><br><span class="line">        .idType(IdType.AUTO)</span><br><span class="line">        .naming(NamingStrategy.underline_to_camel) <span class="comment">// ä¸‹åˆ’çº¿è½¬é©¼å³°</span></span><br><span class="line">        .columnNaming(NamingStrategy.underline_to_camel)</span><br><span class="line">        .RestControllerStyle() <span class="comment">// ControlleråŠ @RestController</span></span><br><span class="line">      )</span><br><span class="line">      .templateEngine(<span class="keyword">new</span> <span class="title class_">FreemarkerTemplateEngine</span>()) <span class="comment">// æ¨¡æ¿å¼•æ“</span></span><br><span class="line">      .execute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="12-2-ç”Ÿæˆæ–‡ä»¶"><a href="#12-2-ç”Ÿæˆæ–‡ä»¶" class="headerlink" title="12.2 ç”Ÿæˆæ–‡ä»¶"></a>12.2 ç”Ÿæˆæ–‡ä»¶</h4><ul>
<li>è‡ªåŠ¨ç”Ÿæˆï¼šå®ä½“ç±»ï¼ˆå«<code>@Data</code>&#x2F;<code>@TableName</code>ï¼‰ã€Mapper æ¥å£ã€Serviceï¼ˆå« IService&#x2F;ServiceImplï¼‰ã€Controllerï¼ˆå« CRUD æ¥å£ï¼‰ã€‚</li>
</ul>
<h4 id="12-3-IDEA-æ’ä»¶ï¼ˆå¯é€‰ï¼‰"><a href="#12-3-IDEA-æ’ä»¶ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="12.3 IDEA æ’ä»¶ï¼ˆå¯é€‰ï¼‰"></a>12.3 IDEA æ’ä»¶ï¼ˆå¯é€‰ï¼‰</h4><ul>
<li>å®‰è£…ã€ŒMyBatisPlusã€æ’ä»¶ï¼Œé…ç½®æ•°æ®åº“åï¼Œé€‰ä¸­è¡¨å³å¯ä¸€é”®ç”Ÿæˆä»£ç ï¼Œæ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿ã€‚</li>
</ul>
<h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><ol>
<li>æç®€å¼€å‘ï¼š<ul>
<li>å‘Šåˆ« XML é…ç½®ï¼Œç”¨ Lambda å†™æŸ¥è¯¢ï¼Œä»£ç é‡å‡å°‘ 50%ï¼›</li>
<li>ç¤ºä¾‹ï¼šä¼ ç»Ÿ MyBatis éœ€å†™ XMLï¼ŒMP ç›´æ¥<code>userMapper.selectList(Wrappers.&lt;User&gt;lambdaQuery().eq(User::getName, &quot;å¼ ä¸‰&quot;))</code>ã€‚</li>
</ul>
</li>
<li>ä¼ä¸šçº§æ’ä»¶å®æˆ˜ï¼š<ul>
<li>åˆ†é¡µï¼š5 è¡Œä»£ç å®ç°ç™¾ä¸‡çº§æ•°æ®åˆ†é¡µï¼›</li>
<li>ä¹è§‚é”ï¼šè§£å†³é«˜å¹¶å‘å†²çªï¼›</li>
<li>å¤šç§Ÿæˆ·ï¼šä¸€å¥—ä»£ç æ”¯æŒå¤šå®¢æˆ·æ•°æ®éš”ç¦»ã€‚</li>
</ul>
</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼š<ul>
<li>åŠ¨æ€è¡¨ååº”å¯¹åˆ†åº“åˆ†è¡¨ï¼›</li>
<li>å­—æ®µåŠ å¯†ä¿æŠ¤æ•æ„Ÿæ•°æ®ï¼›</li>
<li>å†…ç½® SQL æ³¨å…¥é˜²å¾¡ã€‚</li>
</ul>
</li>
</ol>
</div>

    
    <section class="post-copyright">
      
      <p class="copyright-item">
        <span>ä½œè€…:</span>
        <span>è€æ±Ÿæ¹–</span>
      </p>
        
      <p class="copyright-item">
        <span>è®¸å¯è¯:</span>
        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
      </p>
       
      <p class="copyright-item">
        <span>å£å·:</span>
        <span><strong>ä»£ç æ˜¯å¼€æºçš„,æˆ‘ä»¬åªæ˜¯å®ƒçš„æ¬è¿å·¥ã€‚</strong></span>
      </p>
       
        <p class="copyright-item">
        <span>å¦‚æœè§‰å¾—æˆ‘çš„æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œè¯·éšæ„è½¬è½½ï¼Œæ„Ÿè°¢æ”¯æŒï¼</span>
      </p>
      
             
        <p class="copyright-item">
        <span>å¦‚æœ‰ä¾µæƒè¯·å‘ŠçŸ¥åˆ é™¤ğŸ™</span>
      </p>
             
        <p class="copyright-item">
        <span>å¦‚æœä½ æœ‰å¾ˆå¥½çš„æƒ³æ³•ğŸ’¡ï¼Œè¯·åŠ¡å¿…è”ç³»æˆ‘ã€‚ </span>
        <br>
         <span>2292360909@qq.com</span>
      </p>
    </section>
    
    <section class="post-tags">
      <div>
        <span>æ ‡ç­¾:</span>
        <span class="tag">
           
          <a href="/tags/Mybatis-plus/"># Mybatis-plus</a>
           
        </span>
      </div>
      <div>
        <a href="javascript:window.history.back();">è¿”å›</a>
        <span>Â· </span>
        <a href="/">é¦–é¡µ</a>
      </div>
    </section>
    <section class="post-nav">
       
      <a class="next" rel="next" href="/2025/10/15/java/Mybatis%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/"
        >Mybatiså¿«é€Ÿä¸Šæ‰‹</a
      >
      
    </section>

    <!-- Giscus è¯„è®ºåŒºæŒ‚è½½ç‚¹ -->
<div id="giscus-container" style="margin-top: 2.5rem;"></div>

<!-- Giscus åŠ¨æ€åŠ è½½è„šæœ¬ï¼šåˆå§‹åŠ è½½ + æ˜æš—ä¸»é¢˜åˆ‡æ¢ -->
<script>
  function createGiscus(theme) {
    const giscusContainer = document.getElementById('giscus-container');
    if (!giscusContainer) return;

    // æ¸…é™¤æ—§çš„è¯„è®º iframe
    giscusContainer.innerHTML = '';

    const script = document.createElement('script');
    script.src = 'https://giscus.app/client.js';

    // æ›¿æ¢ä¸ºä½ çš„ GitHub ä»“åº“ä¿¡æ¯ï¼ˆæ ¼å¼ï¼šusername/repoï¼‰
    script.setAttribute('data-repo', 'meisijiya/meisijiya.github.io');

   // æ›¿æ¢ä¸ºä½ çš„ repo-id å’Œ category-idï¼ˆåœ¨ giscus.app é…ç½®é¡µé¢ç”Ÿæˆï¼‰
    script.setAttribute('data-repo-id', 'R_kgDOPwTrpQ');
    script.setAttribute('data-category', 'Announcements');
    script.setAttribute('data-category-id', 'DIC_kwDOPwTrpc4CviGR');

    // å…¶ä»–å¸¸è§„æ¨èè®¾ç½®
    script.setAttribute('data-mapping', 'pathname');           // ç”¨é¡µé¢è·¯å¾„åŒ¹é…è¯„è®ºå¸–
    script.setAttribute('data-strict', '0');                   // è‹¥æ— åŒ¹é…å¸–åˆ™åˆ›å»ºæ–°å¸–
    script.setAttribute('data-reactions-enabled', '1');        // å¯ç”¨è¡¨æƒ…ååº”
    script.setAttribute('data-emit-metadata', '0');            // ä¸è¾“å‡ºå…ƒæ•°æ®
    script.setAttribute('data-input-position', 'top');         // è¾“å…¥æ¡†åœ¨è¯„è®ºä¸Šæ–¹
    script.setAttribute('data-theme', theme);                
    script.setAttribute('data-lang', 'zh-CN');                 // ä¸­æ–‡ç•Œé¢
    script.setAttribute('crossorigin', 'anonymous');           // è·¨åŸŸèµ„æºå®‰å…¨
    script.async = true;                                       
     
    giscusContainer.appendChild(script);
  }

  function getCurrentTheme() {
    return document.body.classList.contains('dark-theme') ? 'dark' : 'light';
  }

  document.addEventListener('DOMContentLoaded', () => {
    // é¡µé¢é¦–æ¬¡åŠ è½½ï¼Œæ ¹æ®å½“å‰ä¸»é¢˜æŒ‚è½½è¯„è®º
    createGiscus(getCurrentTheme());

    // ç›‘å¬æŒ‰é’®ç‚¹å‡»åˆ‡æ¢ä¸»é¢˜ â†’ é‡è½½è¯„è®ºåŒº
    const buttons = [
      document.querySelector('.toggleBtn'),
      document.getElementById('mobile-toggle-theme')
    ];
    buttons.forEach(btn => {
      if (!btn) return;
      btn.addEventListener('click', () => {
        setTimeout(() => {
          createGiscus(getCurrentTheme());
        }, 400); // ç¨ä½œå»¶è¿Ÿï¼Œç¡®ä¿ class åˆ‡æ¢å®Œæ¯•
      });
    });

    // ç›‘å¬ body class æ”¹å˜ï¼ˆä¿é™©æ–¹æ¡ˆï¼‰
    const observer = new MutationObserver(() => {
      createGiscus(getCurrentTheme());
    });
    observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });
  });
</script>

  </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© è€æ±Ÿæ¹– | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
<script src="/js/code-copy.js"></script>


    </div>
</body>
<!-- umami -->
<script defer src="https://cloud.umami.is/script.js" data-website-id="91b923f2-ff2d-43d0-ba5f-bc348d82426a"></script>
</html>