<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="è€æ±Ÿæ¹–">


    <meta name="subtitle" content="è®°å½•è¿›å…¥æˆ¿é—´é—¨åçš„ç¾å¥½">


    <meta name="description" content="ä¸€å¹´å‰ï¼Œå­¤è‹¦ä¼¶ä»ƒçš„è€æ±Ÿæ¹–ï¼Œå¶ç„¶é—´å‘ç°ä¸€å¤„æˆ¿é—´é—¨ï¼Œæ¨é—¨è€Œå…¥ï¼Œä»æ­¤è¿›å…¥äº†å……æ»¡å¹¸ç¦çš„ä¸–ç•Œã€‚">


    <meta name="keywords" content="è€æ±Ÿæ¹–,åšå®¢,æˆ¿é—´é—¨">


<title>Mybatiså¿«é€Ÿä¸Šæ‰‹ | æ¬¢è¿æ¥åˆ°è€æ±Ÿæ¹–çš„åšå®¢</title>



    <link rel="icon" href="/images/%E9%87%91%E6%AF%9B.png?_t=1758006391547">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    
    <link rel="stylesheet" href="/css/search.css">
    

<!-- highlight.js æ ·å¼ï¼ˆé»˜è®¤äº®è‰²ï¼‰ -->
<link id="hljs-theme" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/github.css">
<!-- highlight.js è‡ªåŠ¨ä¸Šè‰²åŠŸèƒ½ -->
<script src="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/lib/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<link rel="stylesheet" href="/css/custom.css">



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const pagebody = document.getElementsByTagName('body')[0]

            function setTheme(status) {

                if (status === 'dark') {
                    window.sessionStorage.theme = 'dark'
                    pagebody.classList.add('dark-theme');

                } else if (status === 'light') {
                    window.sessionStorage.theme = 'light'
                    pagebody.classList.remove('dark-theme');
                }
            };

            setTheme(window.sessionStorage.theme)
        })();
    </script>

    <div class="wrapper">
        <header>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-header header-logo">
        <a href="/">è€æ±Ÿæ¹–çš„åšå®¢</a>
      </div>
      <div class="menu navbar-right">
        <!-- åœ¨ç”µè„‘ç«¯çš„å¯¼èˆªé“¾æ¥åŒºåŸŸæ·»åŠ æœç´¢åŠŸèƒ½ -->
        <div class="search-container">
          <a href="javascript:;" onclick="toggleSearchInput()">ğŸ”</a>
          <input
            type="text"
            id="nav-search-input-desktop"
            class="nav-search-input"
            placeholder="æƒ³çŸ¥é“æˆ‘ä»€ä¹ˆç§˜å¯†å‘¢ï¼Œæœæœçœ‹å§"
            oninput="navSearch(this)"
          />
          <div id="nav-search-result-desktop" class="nav-search-result"></div>
        </div>

        
        <a class="menu-item" href="/archives">å½’æ¡£</a>
        
        <a class="menu-item" href="/category">åˆ†ç±»</a>
        
        <a class="menu-item" href="/tag">æ ‡ç­¾</a>
        
        <a class="menu-item" href="/Timer">ä»»åŠ¡è®¡æ—¶å™¨</a>
        
        <a class="menu-item" href="/timeLine">æ—¶é—´çº¿</a>
        
        <a class="menu-item" href="/tongji">ç½‘ç«™ç»Ÿè®¡</a>
        
        <a class="menu-item" href="/about">å…³äº</a>
        

        <input id="switch_default" type="checkbox" class="switch_default" />
        <label for="switch_default" class="toggleBtn"></label>
      </div>
    </div>
  </nav>

  
  <nav class="navbar-mobile" id="nav-mobile">
    <div class="container">
      <div class="navbar-header">
        <div>
          <a href="/">è€æ±Ÿæ¹–çš„åšå®¢</a
          ><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
        </div>

        <div class="menu-toggle" onclick="mobileBtn()">
          <svg
            class="menu-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="32"
            height="32"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M4.5 17.27q-.213 0-.356-.145T4 16.768t.144-.356t.356-.143h15q.213 0 .356.144q.144.144.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.144T4 11.999t.144-.356t.356-.143h15q.213 0 .356.144t.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.143Q4 7.443 4 7.23t.144-.356t.356-.143h15q.213 0 .356.144T20 7.23t-.144.356t-.356.144z"
            />
          </svg>
          <svg
            class="close-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="32"
            height="32"
            viewBox="0 0 24 24"
          >
            <!-- Icon from Material Symbols Light by Google - https://github.com/google/material-design-icons/blob/master/LICENSE -->
            <path
              fill="currentColor"
              d="m12 12.708l-5.246 5.246q-.14.14-.344.15t-.364-.15t-.16-.354t.16-.354L11.292 12L6.046 6.754q-.14-.14-.15-.344t.15-.364t.354-.16t.354.16L12 11.292l5.246-5.246q.14-.14.345-.15q.203-.01.363.15t.16.354t-.16.354L12.708 12l5.246 5.246q.14.14.15.345q.01.203-.15.363t-.354.16t-.354-.16z"
            />
          </svg>
        </div>
      </div>

      <div class="menu" id="mobile-menu">
        
        <a class="menu-item" href="/archives">å½’æ¡£</a>
        
        <a class="menu-item" href="/category">åˆ†ç±»</a>
        
        <a class="menu-item" href="/tag">æ ‡ç­¾</a>
        
        <a class="menu-item" href="/Timer">ä»»åŠ¡è®¡æ—¶å™¨</a>
        
        <a class="menu-item" href="/timeLine">æ—¶é—´çº¿</a>
        
        <a class="menu-item" href="/tongji">ç½‘ç«™ç»Ÿè®¡</a>
        
        <a class="menu-item" href="/about">å…³äº</a>
        
        <!-- æ‰‹æœºæ¨¡å¼æœç´¢æ¡† -->
        <div class="search-container mobile-container">
          <a class="menu-item" href="javascript:;" onclick="toggleSearchInput()"
            >ğŸ”</a
          >
          <input
            type="text"
            id="nav-search-input-mobile"
            class="nav-search-input"
            placeholder="æƒ³çŸ¥é“æˆ‘ä»€ä¹ˆç§˜å¯†å‘¢ï¼Œæœæœçœ‹å§"
            oninput="navSearch(this)"
          />
          <div id="nav-search-result-mobile" class="nav-search-result"></div>
        </div>
      </div>
    </div>
  </nav>
</header>
<script>
  var mobileBtn = function f() {
    var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
    var mobileMenu = document.getElementById("mobile-menu");
    if (toggleMenu.classList.contains("active")) {
      toggleMenu.classList.remove("active");
      mobileMenu.classList.remove("active");
    } else {
      toggleMenu.classList.add("active");
      mobileMenu.classList.add("active");
    }
  };

  function toggleSearchInput() {
    const inputs = document.querySelectorAll(".nav-search-input");
    const results = document.querySelectorAll(".nav-search-result");
    inputs.forEach((input) => {
      input.classList.toggle("active");
      if (input.classList.contains("active")) input.focus();
    });
    results.forEach((r) => (r.style.display = "none"));
  }

  // ç‚¹å‡»å¤–éƒ¨åŒºåŸŸéšè—æœç´¢æ¡†å’Œç»“æœå®¹å™¨çš„å‡½æ•°
  function handleClickOutsideSearch(event) {
    const searchContainers = document.querySelectorAll(".search-container");
    searchContainers.forEach((container) => {
      const searchInput = container.querySelector(".nav-search-input");
      const searchIcon = container.querySelector("a");

      // å¦‚æœç‚¹å‡»çš„å…ƒç´ ä¸æ˜¯æœç´¢è¾“å…¥æ¡†æˆ–æœç´¢å›¾æ ‡ï¼Œåˆ™éšè—æœç´¢æ¡†å’Œç»“æœå®¹å™¨
      if (
        !searchInput.contains(event.target) &&
        !searchIcon.contains(event.target)
      ) {
        searchInput.classList.remove("active");
        searchInput.value = ""
        // æ ¹æ®è¾“å…¥æ¡†IDç¡®å®šå¯¹åº”çš„ç»“æœå®¹å™¨
        let resultContainer;
        if (searchInput.id === "nav-search-input-mobile") {
          // ç§»åŠ¨ç«¯ç»“æœå®¹å™¨
          resultContainer = document.querySelector(
            ".navbar-mobile .nav-search-result"
          );
        } else {
          // æ¡Œé¢ç«¯ç»“æœå®¹å™¨
          resultContainer = document.getElementById(
            "nav-search-result-desktop"
          );
        }

        if (resultContainer) {
          resultContainer.style.display = "none";
          resultContainer.innerHTML = ""; // æ¸…ç©ºç»“æœå®¹å™¨å†…å®¹
        }
      }
    });
  }

  // æ·»åŠ å…¨å±€ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
  document.addEventListener("click", function (event) {
    handleClickOutsideSearch(event);
  });

  // æ–°å¢ï¼šæœç´¢åŠŸèƒ½å®ç°
  let searchData = []; // å…¨å±€å˜é‡å­˜å‚¨æœç´¢æ•°æ®

  // é¡µé¢åŠ è½½å®Œæˆåè·å–æœç´¢æ•°æ®
  document.addEventListener("DOMContentLoaded", function () {
    fetch("/search.xml")
      .then((res) => res.text())
      .then((xmlText) => {
        const parser = new DOMParser();
        const xml = parser.parseFromString(xmlText, "text/xml");
        const entries = xml.getElementsByTagName("entry");
        for (let entry of entries) {
          searchData.push({
            title: entry.getElementsByTagName("title")[0]?.textContent || "",
            content:
              entry.getElementsByTagName("content")[0]?.textContent || "",
            url: entry.getElementsByTagName("url")[0]?.textContent || "",
          });
        }
      })
      .catch((err) => {
        console.error("Failed to load search data:", err);
      });
  });

  // æ–°å¢ï¼šå¯¼èˆªæœç´¢æ–¹æ³•
  function navSearch(inputElement) {
    const keyword = inputElement.value.trim().toLowerCase();
    // æŸ¥æ‰¾å¯¹åº”çš„æœç´¢ç»“æœå®¹å™¨
    let resultContainer;

    if (inputElement.id === "nav-search-input-desktop") {
      // æ¡Œé¢ç«¯
      resultContainer = document.getElementById("nav-search-result-desktop");
    } else if (inputElement.id === "nav-search-input-mobile") {
      // ç§»åŠ¨ç«¯
      resultContainer =
        inputElement.parentNode.querySelector(".nav-search-result");
    }

    if (!resultContainer) return;

    resultContainer.innerHTML = "";

    if (!keyword) {
      resultContainer.style.display = "none";
      return;
    }

    // æ˜¾ç¤ºç»“æœå®¹å™¨
    resultContainer.style.display = "block";

    // è¿‡æ»¤æœç´¢æ•°æ®
    const results = searchData.filter(
      (data) =>
        (data.title && data.title.toLowerCase().includes(keyword)) ||
        (data.content && data.content.toLowerCase().includes(keyword))
    );

    if (results.length === 0) {
      resultContainer.innerHTML =
        '<p class="no-result">æ²¡æœ‰ç»“æœå“Ÿï¼Œæ¢ä¸ªå…³é”®è¯è¯•è¯•å§</p>';
      return;
    }

    // é™åˆ¶æ˜¾ç¤ºç»“æœæ•°é‡
    const maxResults = 10;
    const limitedResults = results.slice(0, maxResults);

    // æ„å»ºç»“æœHTML
    const html = limitedResults
      .map((item) => {
        // æå–åŒ…å«å…³é”®å­—çš„å†…å®¹ç‰‡æ®µ
        let contentSnippet = "";
        if (item.content) {
          // æ‰¾åˆ°åŒ…å«å…³é”®å­—çš„å†…å®¹ç‰‡æ®µ
          const contentLower = item.content.toLowerCase();
          const keywordIndex = contentLower.indexOf(keyword);

          // æå–å…³é”®å­—å‰åçš„å†…å®¹
          const start = Math.max(0, keywordIndex - 3 * keyword.length);
          const end = Math.min(
            item.content.length,
            keywordIndex + 3 * keyword.length
          );
          contentSnippet = item.content.substring(start, end);
        // é«˜äº®å…³é”®å­—
      const keywordRegex = new RegExp(`(${keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
      contentSnippet = contentSnippet.replace(
        keywordRegex,
        "<mark>$1</mark>"
      );
        }

        return `<div class="search-result-item">
  <a href="${item.url}">
    <div>æ ‡é¢˜ï¼š${item.title}</div>
    <div>å†…å®¹ï¼š${contentSnippet}</div>
  </a>
</div>`;
      })
      .join("");
    resultContainer.innerHTML = html;
  }
</script>
<style>
  /* æ‰‹æœºç«¯ä½¿ç”¨flexboxå¸ƒå±€æœç´¢å®¹å™¨ */
  .mobile-container {
    display: flex;
    align-items: center;
    flex-direction: row;
    margin-bottom: 10px;
    margin-left: 10px;
    flex-grow: 1;
    max-width: calc(100% - 40px);
  }


  .search-result-item {
  border: 1px solid #ddd; /* è¾¹æ¡† */
  margin: 4px 0; /* å¤–å±‚é—´è· */
  padding: 0; /* æ— å†…è¾¹è· */
  background: #fff; /* èƒŒæ™¯è‰² */
}

.search-result-item a {
  display: block;
  text-decoration: none;
  color: inherit;
}

.search-result-item div {
  padding: 3px 8px; /* ç´§å‡‘çš„å†…è¾¹è· */
  margin: 0; /* æ— å¤–è¾¹è· */
  line-height: 1.3; /* ç´§å‡‘çš„è¡Œé«˜ */
  word-wrap: break-word; /* å…è®¸é•¿å•è¯æ¢è¡Œ */
  white-space: normal; /* å…è®¸æ­£å¸¸æ¢è¡Œ */
}

.search-result-item div:first-child {
  border-bottom: 1px solid #eee; /* æ ‡é¢˜å’Œå†…å®¹ä¹‹é—´çš„åˆ†éš”çº¿ */
}


</style>

            <div class="main">
                <div class="container">
    <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">å±•å¼€æ‰€æœ‰</a>
        <a onclick="go_top()">è¿”å›é¡¶éƒ¨</a>
        <a onclick="go_bottom()">è¿”å›åº•éƒ¨</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // ä¸º 6 æ—¶å±•å¼€æ‰€æœ‰
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // è¿™ä¸ªå€¼æ˜¯ç”± tocbot æºç é‡Œå®šä¹‰çš„ scrollSmoothDuration å¾—æ¥çš„
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'å±•å¼€æ‰€æœ‰' : 'æŠ˜å æ‰€æœ‰';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>  
  <article class="post-wrap">
    <header class="post-header">
      <h1 class="post-title">Mybatiså¿«é€Ÿä¸Šæ‰‹</h1>
      
      <div class="post-meta">
         ä½œè€…:
        <a itemprop="author" rel="author" href="/">è€æ±Ÿæ¹–</a>
         
        <span class="post-time">
          <br />æ—¥æœŸ:
          <a href="#"
            >åæœˆ 15, 2025&nbsp;&nbsp;1:03:19</a
          >
        </span>
         
        <span class="post-category"
          ><br />
          åˆ†ç±»: 
          <a href="/categories/java/">java</a>
          
        </span>
        
      </div>
      
    </header>

    <div class="post-content"><hr>
<h2 id="ä¸€ã€Mybatis-ç®€ä»‹ä¸å¿«é€Ÿä¸Šæ‰‹"><a href="#ä¸€ã€Mybatis-ç®€ä»‹ä¸å¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="ä¸€ã€Mybatis ç®€ä»‹ä¸å¿«é€Ÿä¸Šæ‰‹"></a>ä¸€ã€Mybatis ç®€ä»‹ä¸å¿«é€Ÿä¸Šæ‰‹</h2><h3 id="1-1-ä»€ä¹ˆæ˜¯-Mybatis"><a href="#1-1-ä»€ä¹ˆæ˜¯-Mybatis" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯ Mybatis"></a>1.1 ä»€ä¹ˆæ˜¯ Mybatis</h3><ul>
<li><strong>æ ¸å¿ƒå®šä½</strong>ï¼šMybatis æ˜¯ä¸€æ¬¾<strong>æŒä¹…å±‚æ¡†æ¶</strong>ï¼Œä¸“æ³¨äºè§£å†³ Java åº”ç”¨ä¸æ•°æ®åº“äº¤äº’çš„é—®é¢˜ï¼Œå±äº ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æŠ€æœ¯çš„ä¸€ç§å®ç°ã€‚</li>
<li><strong>å†å²èƒŒæ™¯</strong>ï¼šå‰èº«æ˜¯ Apache çš„ iBatis æ¡†æ¶ï¼Œ2010 å¹´è¿ç§»åˆ° Google Code å¹¶æ›´åä¸º Mybatisï¼Œåæ‰˜ç®¡äº GitHubï¼Œç›®å‰æœ€æ–°ç¨³å®šç‰ˆä¸º 3.5.xï¼ˆ2025.10ï¼‰ã€‚</li>
<li>è§£å†³çš„é—®é¢˜ï¼š<ul>
<li>æ¶ˆé™¤ JDBC å†—ä½™ä»£ç ï¼ˆæ‰‹åŠ¨åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€å¤„ç†ç»“æœé›†ç­‰ï¼‰</li>
<li>å®ç° SQL ä¸ Java ä»£ç åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤</li>
<li>æä¾›çµæ´»çš„ SQL å®šåˆ¶èƒ½åŠ›ï¼ˆæ— éœ€åƒ Hibernate é‚£æ ·å—é™äº ORM è‡ªåŠ¨ç”Ÿæˆçš„ SQLï¼‰</li>
</ul>
</li>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šé€šè¿‡é…ç½®æ–‡ä»¶æˆ–æ³¨è§£å®šä¹‰ SQL è¯­å¥ä¸ Java å¯¹è±¡çš„æ˜ å°„å…³ç³»ï¼Œæ¡†æ¶è‡ªåŠ¨å®Œæˆæ•°æ®çš„æŸ¥è¯¢ã€å°è£…ä¸æŒä¹…åŒ–æ“ä½œã€‚</li>
</ul>
<h3 id="1-2-ç¯å¢ƒæ­å»º"><a href="#1-2-ç¯å¢ƒæ­å»º" class="headerlink" title="1.2 ç¯å¢ƒæ­å»º"></a>1.2 ç¯å¢ƒæ­å»º</h3><h4 id="åŸºç¡€ä¾èµ–é…ç½®"><a href="#åŸºç¡€ä¾èµ–é…ç½®" class="headerlink" title="åŸºç¡€ä¾èµ–é…ç½®"></a>åŸºç¡€ä¾èµ–é…ç½®</h4><ul>
<li><strong>Maven ä¾èµ–</strong>ï¼ˆæ ¸å¿ƒ + æ•°æ®åº“é©±åŠ¨ï¼‰ï¼š</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Mybatisæ ¸å¿ƒä¾èµ– --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- MySQLé©±åŠ¨ï¼ˆæ ¹æ®æ•°æ®åº“ç±»å‹é€‰æ‹©ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- é€‚é…MySQL 8.x --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Gradle ä¾èµ–</strong>ï¼š</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">&#x27;org.mybatis:mybatis:3.5.16&#x27;</span></span><br><span class="line">implementation <span class="string">&#x27;mysql:mysql-connector-java:8.0.33&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-3-é…ç½®æ–‡ä»¶ç»“æ„ï¼ˆmybatis-config-xmlï¼‰"><a href="#1-3-é…ç½®æ–‡ä»¶ç»“æ„ï¼ˆmybatis-config-xmlï¼‰" class="headerlink" title="1.3 é…ç½®æ–‡ä»¶ç»“æ„ï¼ˆmybatis-config.xmlï¼‰"></a>1.3 é…ç½®æ–‡ä»¶ç»“æ„ï¼ˆmybatis-config.xmlï¼‰</h3><p>Mybatis æ ¸å¿ƒé…ç½®æ–‡ä»¶åŒ…å«æ¡†æ¶å…¨å±€è®¾ç½®ï¼Œæ ‡ç­¾é¡ºåºæœ‰ä¸¥æ ¼è¦æ±‚ï¼ˆproperties â†’ settings â†’ typeAliases â†’ â€¦ â†’ environments â†’ mappersï¼‰</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 1. å¼•å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;db.properties&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 2. å…¨å±€è®¾ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å¼€å¯é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„ï¼ˆæ•°æ®åº“user_name â†’ å®ä½“userNameï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å¼€å¯æ—¥å¿—ï¼ˆå¯é€‰LOG4Jã€SLF4Jç­‰ï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;LOG4J&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- äºŒçº§ç¼“å­˜å¼€å…³ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 3. ç±»å‹åˆ«åï¼ˆç®€åŒ–ç±»åä¹¦å†™ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å•ä¸ªç±»åˆ«å --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">&quot;com.example.pojo.User&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;User&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- åŒ…æ‰«æï¼ˆé»˜è®¤åˆ«åä¸ºç±»åé¦–å­—æ¯å°å†™ï¼Œå¦‚Userâ†’userï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.example.pojo&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 4. ç¯å¢ƒé…ç½®ï¼ˆå¯é…ç½®å¤šç¯å¢ƒï¼ŒdefaultæŒ‡å®šé»˜è®¤ç¯å¢ƒï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- äº‹åŠ¡ç®¡ç†å™¨ï¼šJDBCï¼ˆä¾èµ–æ•°æ®åº“äº‹åŠ¡ï¼‰/MANAGEDï¼ˆäº¤ç»™å®¹å™¨ç®¡ç†ï¼‰ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- æ•°æ®æºï¼šPOOLEDï¼ˆè¿æ¥æ± ï¼‰/UNPOOLEDï¼ˆæ— è¿æ¥æ± ï¼‰/JNDIï¼ˆå®¹å™¨æ•°æ®æºï¼‰ --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.driver&#125;&quot;</span>/&gt;</span> <span class="comment">&lt;!-- ä»propertiesæ–‡ä»¶è·å– --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;db.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 5. æ˜ å°„å™¨ï¼ˆæ³¨å†ŒSQLæ˜ å°„æ–‡ä»¶æˆ–æ¥å£ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ–¹å¼1ï¼šèµ„æºè·¯å¾„ï¼ˆXMLæ–‡ä»¶ï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ–¹å¼2ï¼šæ¥å£å…¨ç±»åï¼ˆéœ€XMLä¸æ¥å£åŒåŒ…åŒåï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">&quot;com.example.mapper.UserMapper&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ–¹å¼3ï¼šåŒ…æ‰«æï¼ˆæ‰¹é‡æ³¨å†Œæ¥å£ï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.example.mapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>è¡¥å……</strong>ï¼š<code>db.properties</code>æ–‡ä»¶ç¤ºä¾‹ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">db.driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">db.url</span>=<span class="string">jdbc:mysql://localhost:3306/test?useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="attr">db.username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">db.password</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure>

<h3 id="1-4-åŸºç¡€ä½¿ç”¨ç¤ºä¾‹ï¼ˆå·¥å…·ç±»-æ ¸å¿ƒ-APIï¼‰"><a href="#1-4-åŸºç¡€ä½¿ç”¨ç¤ºä¾‹ï¼ˆå·¥å…·ç±»-æ ¸å¿ƒ-APIï¼‰" class="headerlink" title="1.4 åŸºç¡€ä½¿ç”¨ç¤ºä¾‹ï¼ˆå·¥å…·ç±» + æ ¸å¿ƒ APIï¼‰"></a>1.4 åŸºç¡€ä½¿ç”¨ç¤ºä¾‹ï¼ˆå·¥å…·ç±» + æ ¸å¿ƒ APIï¼‰</h3><h4 id="å·¥å…·ç±»å°è£…ï¼ˆMybatisUtilï¼‰"><a href="#å·¥å…·ç±»å°è£…ï¼ˆMybatisUtilï¼‰" class="headerlink" title="å·¥å…·ç±»å°è£…ï¼ˆMybatisUtilï¼‰"></a>å·¥å…·ç±»å°è£…ï¼ˆMybatisUtilï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisUtil</span> &#123;</span><br><span class="line">    <span class="comment">// SqlSessionFactoryæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå…¨å±€åªéœ€è¦ä¸€ä¸ªå®ä¾‹</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1. åŠ è½½é…ç½®æ–‡ä»¶ï¼ˆInputStream/Readerå‡å¯ï¼‰</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line">            <span class="comment">// 2. åˆ›å»ºSqlSessionFactoryï¼ˆå»ºé€ è€…æ¨¡å¼ï¼‰</span></span><br><span class="line">            sqlSessionFactory = <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(is);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;åˆå§‹åŒ–SqlSessionFactoryå¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–SqlSessionå®ä¾‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> autoCommit æ˜¯å¦è‡ªåŠ¨æäº¤äº‹åŠ¡ï¼ˆDMLæ“ä½œå»ºè®®å…³é—­è‡ªåŠ¨æäº¤ï¼‰</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> SqlSessionï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼Œéœ€å•ç‹¬è·å–ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title function_">openSession</span><span class="params">(<span class="type">boolean</span> autoCommit)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory.openSession(autoCommit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç®€åŒ–è°ƒç”¨ï¼šé»˜è®¤ä¸è‡ªåŠ¨æäº¤</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title function_">openSession</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> openSession(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ ¸å¿ƒ-API-è¯´æ˜"><a href="#æ ¸å¿ƒ-API-è¯´æ˜" class="headerlink" title="æ ¸å¿ƒ API è¯´æ˜"></a>æ ¸å¿ƒ API è¯´æ˜</h4><ul>
<li><strong>SqlSessionFactory</strong>ï¼šå·¥å‚ç±»ï¼Œè´Ÿè´£åˆ›å»º SqlSessionï¼Œå…¨å±€å”¯ä¸€ï¼Œçº¿ç¨‹å®‰å…¨ã€‚</li>
<li><strong>SqlSession</strong>ï¼šä¼šè¯å¯¹è±¡ï¼Œå°è£…äº†æ•°æ®åº“è¿æ¥ï¼Œæä¾› CRUD æ–¹æ³•ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œéœ€æ¯æ¬¡ä½¿ç”¨æ—¶åˆ›å»ºï¼Œç”¨å®Œå…³é—­ã€‚</li>
<li>ä½¿ç”¨æµç¨‹ï¼š<ol>
<li>é€šè¿‡å·¥å…·ç±»è·å– SqlSession</li>
<li>æ‰§è¡Œ SQL æ“ä½œï¼ˆç›´æ¥è°ƒç”¨ API æˆ–é€šè¿‡ Mapper æ¥å£ï¼‰</li>
<li>æäº¤ &#x2F; å›æ»šäº‹åŠ¡ï¼ˆDML æ“ä½œï¼‰</li>
<li>å…³é—­ SqlSessionï¼ˆtry-with-resources è‡ªåŠ¨å…³é—­ï¼‰</li>
</ol>
</li>
</ul>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=175142038&content_type=Article&match_order=1&q=%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80&zhida_source=entity">æ•°æ®å®šä¹‰è¯­è¨€</a>(DDL)ã€<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=175142038&content_type=Article&match_order=1&q=%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80&zhida_source=entity">æ•°æ®æŸ¥è¯¢è¯­è¨€</a>ï¼ˆDQLï¼‰ã€<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=175142038&content_type=Article&match_order=1&q=%E6%95%B0%E6%8D%AE%E6%93%8D%E7%BA%B5%E8%AF%AD%E8%A8%80&zhida_source=entity">æ•°æ®æ“çºµè¯­è¨€</a>ï¼ˆDMLï¼‰ã€<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=175142038&content_type=Article&match_order=1&q=%E6%95%B0%E6%8D%AE%E6%8E%A7%E5%88%B6%E8%AF%AD%E8%A8%80&zhida_source=entity">æ•°æ®æ§åˆ¶è¯­è¨€</a>ï¼ˆDCLï¼‰</p>
</blockquote>
<h3 id="1-5-MyBatis-ä¸-JDBC-çš„å¯¹æ¯”ï¼ˆè§£å†³-JDBC-çš„æ ¸å¿ƒç—›ç‚¹ï¼‰"><a href="#1-5-MyBatis-ä¸-JDBC-çš„å¯¹æ¯”ï¼ˆè§£å†³-JDBC-çš„æ ¸å¿ƒç—›ç‚¹ï¼‰" class="headerlink" title="1.5 MyBatis ä¸ JDBC çš„å¯¹æ¯”ï¼ˆè§£å†³ JDBC çš„æ ¸å¿ƒç—›ç‚¹ï¼‰"></a>1.5 MyBatis ä¸ JDBC çš„å¯¹æ¯”ï¼ˆè§£å†³ JDBC çš„æ ¸å¿ƒç—›ç‚¹ï¼‰</h3><p>JDBC æ“ä½œæ•°æ®åº“çš„å…¸å‹æµç¨‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JDBCåŸç”Ÿä»£ç ï¼ˆå†—ä½™ä¸”ç¹çï¼‰</span></span><br><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 1. åŠ è½½é©±åŠ¨ï¼ˆç¡¬ç¼–ç ï¼‰</span></span><br><span class="line">    Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">    <span class="comment">// 2. åˆ›å»ºè¿æ¥ï¼ˆURL/è´¦å·/å¯†ç ç¡¬ç¼–ç ï¼‰</span></span><br><span class="line">    conn = DriverManager.getConnection(<span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    <span class="comment">// 3. ç¼–å†™SQLï¼ˆå­—ç¬¦ä¸²æ‹¼æ¥æ˜“å¼•å‘æ³¨å…¥ï¼‰</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from user where id = &quot;</span> + id; <span class="comment">// å­˜åœ¨SQLæ³¨å…¥é£é™©</span></span><br><span class="line">    ps = conn.prepareStatement(sql);</span><br><span class="line">    <span class="comment">// 4. æ‰§è¡ŒæŸ¥è¯¢</span></span><br><span class="line">    rs = ps.executeQuery();</span><br><span class="line">    <span class="comment">// 5. æ‰‹åŠ¨å°è£…ç»“æœé›†ï¼ˆé‡å¤åŠ³åŠ¨ï¼‰</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">        user.setId(rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">        user.setName(rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">        <span class="comment">// ... æ›´å¤šå­—æ®µæ˜ å°„</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">// 6. æ‰‹åŠ¨å…³é—­èµ„æºï¼ˆç¹çä¸”æ˜“é—æ¼ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (rs != <span class="literal">null</span>) <span class="keyword">try</span> &#123; rs.close(); &#125; <span class="keyword">catch</span> (SQLException e) &#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> (ps != <span class="literal">null</span>) <span class="keyword">try</span> &#123; ps.close(); &#125; <span class="keyword">catch</span> (SQLException e) &#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> (conn != <span class="literal">null</span>) <span class="keyword">try</span> &#123; conn.close(); &#125; <span class="keyword">catch</span> (SQLException e) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MyBatis çš„ä¼˜åŒ–ç‚¹ï¼š</p>
<ul>
<li>æ¶ˆé™¤ç¡¬ç¼–ç ï¼šé€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†æ•°æ®åº“è¿æ¥ä¿¡æ¯å’Œ SQL</li>
<li>é˜²æ³¨å…¥ï¼šä½¿ç”¨<code>#&#123;&#125;</code>é¢„ç¼–è¯‘å‚æ•°ï¼ˆæ›¿ä»£ JDBC çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼‰</li>
<li>è‡ªåŠ¨æ˜ å°„ï¼šç»“æœé›†è‡ªåŠ¨å°è£…ä¸º Java å¯¹è±¡ï¼ˆæ— éœ€æ‰‹åŠ¨<code>rs.getXXX()</code>ï¼‰</li>
<li>èµ„æºç®¡ç†ï¼šè‡ªåŠ¨å¤„ç†è¿æ¥ã€Statementã€ResultSet çš„åˆ›å»ºä¸å…³é—­</li>
<li>äº‹åŠ¡ç®€åŒ–ï¼šé€šè¿‡<code>SqlSession</code>çš„<code>commit()</code>&#x2F;<code>rollback()</code>ç»Ÿä¸€ç®¡ç†</li>
</ul>
<h3 id="1-6-åˆæ¬¡ä½¿ç”¨çš„ç»†èŠ‚è¡¥å……"><a href="#1-6-åˆæ¬¡ä½¿ç”¨çš„ç»†èŠ‚è¡¥å……" class="headerlink" title="1.6 åˆæ¬¡ä½¿ç”¨çš„ç»†èŠ‚è¡¥å……"></a>1.6 åˆæ¬¡ä½¿ç”¨çš„ç»†èŠ‚è¡¥å……</h3><ul>
<li><p>Mapper é…ç½®æ–‡ä»¶çš„ DTD å¼•å…¥ï¼šåœ¨ XML æ˜ å°„æ–‡ä»¶å¤´éƒ¨æ·»åŠ  DTD çº¦æŸï¼Œç¡®ä¿æ ‡ç­¾æ ¼å¼æ­£ç¡®ï¼ˆIDE ä¼šè‡ªåŠ¨æç¤ºï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ç¯å¢ƒé…ç½®ç»†èŠ‚</strong>ï¼š<code>environments</code>æ ‡ç­¾çš„<code>default</code>å±æ€§éœ€ä¸æŸä¸ª<code>environment</code>çš„<code>id</code>ä¸€è‡´ï¼›<code>transactionManager</code>çš„<code>MANAGED</code>ç±»å‹ä¼šå°†äº‹åŠ¡äº¤ç»™å®¹å™¨ï¼ˆå¦‚ Springï¼‰ç®¡ç†ï¼Œæ­¤æ—¶ MyBatis ä¸åšä»»ä½•äº‹åŠ¡å¤„ç†ã€‚</p>
</li>
</ul>
<h3 id="1-7-XML-æ ¼å¼è§„èŒƒä¸ç‰¹æ®Šå­—ç¬¦å¤„ç†"><a href="#1-7-XML-æ ¼å¼è§„èŒƒä¸ç‰¹æ®Šå­—ç¬¦å¤„ç†" class="headerlink" title="1.7 XML æ ¼å¼è§„èŒƒä¸ç‰¹æ®Šå­—ç¬¦å¤„ç†"></a>1.7 XML æ ¼å¼è§„èŒƒä¸ç‰¹æ®Šå­—ç¬¦å¤„ç†</h3><h5 id="ï¼ˆ1ï¼‰åŸºæœ¬æ ¼å¼è§„åˆ™"><a href="#ï¼ˆ1ï¼‰åŸºæœ¬æ ¼å¼è§„åˆ™" class="headerlink" title="ï¼ˆ1ï¼‰åŸºæœ¬æ ¼å¼è§„åˆ™"></a>ï¼ˆ1ï¼‰åŸºæœ¬æ ¼å¼è§„åˆ™</h5><ul>
<li>æ ¹èŠ‚ç‚¹å”¯ä¸€ï¼šæ ¸å¿ƒé…ç½®æ–‡ä»¶æ ¹èŠ‚ç‚¹ä¸º<code>&lt;configuration&gt;</code>ï¼Œæ˜ å°„æ–‡ä»¶ä¸º<code>&lt;mapper&gt;</code></li>
<li>æ ‡ç­¾åµŒå¥—ä¸¥æ ¼ï¼šå­æ ‡ç­¾å¿…é¡»ç¬¦åˆ MyBatis è§„å®šçš„é¡ºåºï¼ˆå¦‚<code>configuration</code>çš„å­æ ‡ç­¾é¡ºåºä¸å¯ä¹±ï¼‰</li>
<li>å±æ€§å€¼å¼•å·ï¼šå•å¼•å·æˆ–åŒå¼•å·å‡å¯ï¼Œå»ºè®®ç»Ÿä¸€ä½¿ç”¨åŒå¼•å·</li>
</ul>
<h5 id="ï¼ˆ2ï¼‰ç‰¹æ®Šå­—ç¬¦å¤„ç†ï¼ˆè½¬ä¹‰å­—ç¬¦ä¸-CDATAï¼‰"><a href="#ï¼ˆ2ï¼‰ç‰¹æ®Šå­—ç¬¦å¤„ç†ï¼ˆè½¬ä¹‰å­—ç¬¦ä¸-CDATAï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰ç‰¹æ®Šå­—ç¬¦å¤„ç†ï¼ˆè½¬ä¹‰å­—ç¬¦ä¸ CDATAï¼‰"></a>ï¼ˆ2ï¼‰ç‰¹æ®Šå­—ç¬¦å¤„ç†ï¼ˆè½¬ä¹‰å­—ç¬¦ä¸ CDATAï¼‰</h5><p>å½“ SQL ä¸­åŒ…å«<code>&lt;</code>ã€<code>&gt;</code>ã€<code>&amp;</code>ç­‰ç‰¹æ®Šå­—ç¬¦æ—¶ï¼Œæœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š</p>
<ul>
<li><p>è½¬ä¹‰å­—ç¬¦ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- åŸSQLï¼šselect * from user where age &lt; 18 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectYoungUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select * from user where age <span class="symbol">&amp;lt;</span> 18 <span class="comment">&lt;!-- &amp;lt; å¯¹åº” &lt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>XML ä¸­å¸¸ç”¨çš„è½¬ä¹‰å­—ç¬¦å½’çº³å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>è½¬ä¹‰åºåˆ—</th>
<th>å¯¹åº”å­—ç¬¦</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>&amp;amp</code> æˆ– <code>&amp;</code></td>
<td><code>&amp;</code></td>
<td>å’Œ</td>
</tr>
<tr>
<td><code>&amp;lt</code>æˆ– <code>&lt;</code></td>
<td><code>&lt;</code></td>
<td>å°äºå·</td>
</tr>
<tr>
<td><code>&amp;gt</code> æˆ–<code> &gt;</code></td>
<td><code>&gt;</code></td>
<td>å¤§äºå·</td>
</tr>
<tr>
<td><code>&amp;quot</code></td>
<td><code>&quot;</code></td>
<td>åŒå¼•å·</td>
</tr>
<tr>
<td><code>&amp;nbsp</code></td>
<td>ï¼ˆç©ºæ ¼ï¼‰</td>
<td>ç©ºæ ¼</td>
</tr>
<tr>
<td><code>&amp;copy</code></td>
<td><code>Â©</code></td>
<td>ç‰ˆæƒç¬¦</td>
</tr>
<tr>
<td><code>&amp;reg</code></td>
<td><code>Â®</code></td>
<td>æ³¨å†Œç¬¦</td>
</tr>
</tbody></table>
</li>
<li><p>CDATA åŒºåŸŸ</p>
<p>ï¼ˆæ— éœ€è½¬ä¹‰ï¼Œé€‚åˆå¤æ‚ SQLï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectYoungUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    &lt;![CDATA[</span><br><span class="line">        select * from user where age &lt; 18 and status &amp; 1 = 1</span><br><span class="line">    ]]&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="ï¼ˆ3ï¼‰Java-è§£æ-XML-ç¤ºä¾‹ï¼ˆäº†è§£-MyBatis-åº•å±‚åŸç†ï¼‰"><a href="#ï¼ˆ3ï¼‰Java-è§£æ-XML-ç¤ºä¾‹ï¼ˆäº†è§£-MyBatis-åº•å±‚åŸç†ï¼‰" class="headerlink" title="ï¼ˆ3ï¼‰Java è§£æ XML ç¤ºä¾‹ï¼ˆäº†è§£ MyBatis åº•å±‚åŸç†ï¼‰"></a>ï¼ˆ3ï¼‰Java è§£æ XML ç¤ºä¾‹ï¼ˆäº†è§£ MyBatis åº•å±‚åŸç†ï¼‰</h5><p>MyBatis é€šè¿‡ DOM è§£æ XML é…ç½®æ–‡ä»¶ï¼Œç®€åŒ–ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è§£æMyBatisæ˜ å°„æ–‡ä»¶ä¸­çš„SQL</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XmlParser</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">DocumentBuilderFactory</span> <span class="variable">factory</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">        <span class="type">DocumentBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> factory.newDocumentBuilder();</span><br><span class="line">        <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> builder.parse(Resources.getResourceAsStream(<span class="string">&quot;mappers/UserMapper.xml&quot;</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–selectæ ‡ç­¾çš„SQLå†…å®¹</span></span><br><span class="line">        <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> doc.getElementsByTagName(<span class="string">&quot;select&quot;</span>).item(<span class="number">0</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> node.getTextContent().trim();</span><br><span class="line">        System.out.println(<span class="string">&quot;è§£æåˆ°çš„SQLï¼š&quot;</span> + sql);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€æ ¸å¿ƒæŸ¥è¯¢æ“ä½œè¯¦è§£"><a href="#äºŒã€æ ¸å¿ƒæŸ¥è¯¢æ“ä½œè¯¦è§£" class="headerlink" title="äºŒã€æ ¸å¿ƒæŸ¥è¯¢æ“ä½œè¯¦è§£"></a>äºŒã€æ ¸å¿ƒæŸ¥è¯¢æ“ä½œè¯¦è§£</h2><h3 id="2-1-åŸºç¡€æŸ¥è¯¢é…ç½®ï¼ˆXML-æ˜ å°„æ–‡ä»¶ï¼‰"><a href="#2-1-åŸºç¡€æŸ¥è¯¢é…ç½®ï¼ˆXML-æ˜ å°„æ–‡ä»¶ï¼‰" class="headerlink" title="2.1 åŸºç¡€æŸ¥è¯¢é…ç½®ï¼ˆXML æ˜ å°„æ–‡ä»¶ï¼‰"></a>2.1 åŸºç¡€æŸ¥è¯¢é…ç½®ï¼ˆXML æ˜ å°„æ–‡ä»¶ï¼‰</h3><p><code>UserMapper.xml</code>æ ¸å¿ƒæ ‡ç­¾è¯´æ˜ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;userMapper&quot;</span>&gt;</span> <span class="comment">&lt;!-- å‘½åç©ºé—´ï¼šåŒºåˆ†ä¸åŒæ˜ å°„æ–‡ä»¶çš„SQL --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 1. ç®€å•æŸ¥è¯¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">&quot;selectAllUser&quot;</span>  &lt;!<span class="attr">--</span> <span class="attr">SQLå”¯ä¸€æ ‡è¯†</span>ï¼ˆ<span class="attr">ä¸namespaceç»„åˆä¸ºå…¨é™å®šå</span>ï¼‰<span class="attr">--</span>&gt;</span></span><br><span class="line">        resultType=&quot;User&quot;   <span class="comment">&lt;!-- ç»“æœç±»å‹ï¼ˆå•ä¸ªå¯¹è±¡/é›†åˆå…ƒç´ ç±»å‹ï¼‰ --&gt;</span></span><br><span class="line">        timeout=&quot;30&quot;&gt;       <span class="comment">&lt;!-- è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ --&gt;</span></span><br><span class="line">        select * from user</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 2. æ¡ä»¶æŸ¥è¯¢ï¼ˆå•ä¸ªå‚æ•°ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>  &lt;!<span class="attr">--</span> <span class="attr">å‚æ•°ç±»å‹</span>ï¼ˆ<span class="attr">å¯çœç•¥</span>ï¼Œ<span class="attr">Mybatisè‡ªåŠ¨æ¨æ–­</span>ï¼‰ <span class="attr">--</span>&gt;</span></span><br><span class="line">        resultType=&quot;User&quot;&gt;</span><br><span class="line">        select * from user where id = #&#123;id&#125;  <span class="comment">&lt;!-- #&#123;id&#125;ï¼šå‚æ•°å ä½ç¬¦ï¼ˆé¢„ç¼–è¯‘ï¼Œé˜²SQLæ³¨å…¥ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 3. å¤šæ¡ä»¶æŸ¥è¯¢ï¼ˆæ³¨æ„å‚æ•°ä¼ é€’æ–¹å¼ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserByIdAndAge&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">        select * from user where id = #&#123;id&#125; and age = #&#123;age&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-Java-è°ƒç”¨æ–¹å¼ï¼ˆ3-ç§å¸¸ç”¨æ–¹å¼ï¼‰"><a href="#2-2-Java-è°ƒç”¨æ–¹å¼ï¼ˆ3-ç§å¸¸ç”¨æ–¹å¼ï¼‰" class="headerlink" title="2.2 Java è°ƒç”¨æ–¹å¼ï¼ˆ3 ç§å¸¸ç”¨æ–¹å¼ï¼‰"></a>2.2 Java è°ƒç”¨æ–¹å¼ï¼ˆ3 ç§å¸¸ç”¨æ–¹å¼ï¼‰</h3><h4 id="æ–¹å¼-1ï¼šç›´æ¥é€šè¿‡-SqlSession-è°ƒç”¨ï¼ˆæŒ‡å®šå…¨é™å®šåï¼‰"><a href="#æ–¹å¼-1ï¼šç›´æ¥é€šè¿‡-SqlSession-è°ƒç”¨ï¼ˆæŒ‡å®šå…¨é™å®šåï¼‰" class="headerlink" title="æ–¹å¼ 1ï¼šç›´æ¥é€šè¿‡ SqlSession è°ƒç”¨ï¼ˆæŒ‡å®šå…¨é™å®šåï¼‰"></a>æ–¹å¼ 1ï¼šç›´æ¥é€šè¿‡ SqlSession è°ƒç”¨ï¼ˆæŒ‡å®šå…¨é™å®šåï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">SqlSession</span> <span class="variable">session</span> <span class="operator">=</span> MybatisUtil.openSession()) &#123;</span><br><span class="line">    <span class="comment">// å…¨é™å®šå = namespace + id</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> session.selectOne(<span class="string">&quot;userMapper.selectUserById&quot;</span>, <span class="number">1</span>); </span><br><span class="line">    List&lt;User&gt; users = session.selectList(<span class="string">&quot;userMapper.selectAllUser&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ–¹å¼-2ï¼šå¤šå‚æ•°ä¼ é€’ï¼ˆ-Param-æ³¨è§£-Mapï¼‰"><a href="#æ–¹å¼-2ï¼šå¤šå‚æ•°ä¼ é€’ï¼ˆ-Param-æ³¨è§£-Mapï¼‰" class="headerlink" title="æ–¹å¼ 2ï¼šå¤šå‚æ•°ä¼ é€’ï¼ˆ@Param æ³¨è§£ &#x2F; Mapï¼‰"></a>æ–¹å¼ 2ï¼šå¤šå‚æ•°ä¼ é€’ï¼ˆ@Param æ³¨è§£ &#x2F; Mapï¼‰</h4><ul>
<li><strong>@Param æ³¨è§£</strong>ï¼ˆæ¨èï¼Œæ¸…æ™°ç›´è§‚ï¼‰ï¼š</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Mapperæ¥å£æ–¹æ³•</span></span><br><span class="line">User <span class="title function_">selectUserByIdAndAge</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="type">int</span> id, <span class="meta">@Param(&quot;age&quot;)</span> <span class="type">int</span> age)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// XMLä¸­ç›´æ¥ä½¿ç”¨#&#123;id&#125;å’Œ#&#123;age&#125;ï¼ˆæ— éœ€é¢å¤–é…ç½®ï¼‰</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Map ä¼ é€’</strong>ï¼ˆé€‚åˆå‚æ•°è¾ƒå¤šçš„åœºæ™¯ï¼‰ï¼š</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">params.put(<span class="string">&quot;id&quot;</span>, <span class="number">1</span>);</span><br><span class="line">params.put(<span class="string">&quot;age&quot;</span>, <span class="number">18</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> session.selectOne(<span class="string">&quot;selectUserByIdAndAge&quot;</span>, params);</span><br></pre></td></tr></table></figure>

<h4 id="æ–¹å¼-3ï¼šé€šè¿‡å®ä½“ç±»ä¼ é€’å‚æ•°"><a href="#æ–¹å¼-3ï¼šé€šè¿‡å®ä½“ç±»ä¼ é€’å‚æ•°" class="headerlink" title="æ–¹å¼ 3ï¼šé€šè¿‡å®ä½“ç±»ä¼ é€’å‚æ•°"></a>æ–¹å¼ 3ï¼šé€šè¿‡å®ä½“ç±»ä¼ é€’å‚æ•°</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ä½“ç±»</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserQuery</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// XMLä¸­ä½¿ç”¨#&#123;å±æ€§å&#125;</span></span><br><span class="line">&lt;select id=<span class="string">&quot;selectByQuery&quot;</span> resultType=<span class="string">&quot;User&quot;</span>&gt;</span><br><span class="line">    select * from user <span class="type">where</span> <span class="variable">id</span> <span class="operator">=</span> #&#123;id&#125; <span class="type">and</span> <span class="variable">age</span> <span class="operator">=</span> #&#123;age&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨</span></span><br><span class="line"><span class="type">UserQuery</span> <span class="variable">query</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserQuery</span>();</span><br><span class="line">query.setId(<span class="number">1</span>);</span><br><span class="line">query.setAge(<span class="number">18</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> session.selectOne(<span class="string">&quot;selectByQuery&quot;</span>, query);</span><br></pre></td></tr></table></figure>

<h3 id="2-3-å­—æ®µæ˜ å°„é—®é¢˜è§£å†³ï¼ˆ3-ç§æ–¹æ¡ˆï¼‰"><a href="#2-3-å­—æ®µæ˜ å°„é—®é¢˜è§£å†³ï¼ˆ3-ç§æ–¹æ¡ˆï¼‰" class="headerlink" title="2.3 å­—æ®µæ˜ å°„é—®é¢˜è§£å†³ï¼ˆ3 ç§æ–¹æ¡ˆï¼‰"></a>2.3 å­—æ®µæ˜ å°„é—®é¢˜è§£å†³ï¼ˆ3 ç§æ–¹æ¡ˆï¼‰</h3><p>å½“å®ä½“ç±»å­—æ®µä¸æ•°æ®åº“åˆ—åä¸ä¸€è‡´æ—¶ï¼ˆå¦‚å®ä½“<code>uid</code> vs æ•°æ®åº“<code>id</code>ï¼‰ï¼Œéœ€æ‰‹åŠ¨æ˜ å°„ï¼š</p>
<h4 id="æ–¹æ¡ˆ-1ï¼šresultMapï¼ˆæœ€å¸¸ç”¨ï¼ŒXML-é…ç½®ï¼‰"><a href="#æ–¹æ¡ˆ-1ï¼šresultMapï¼ˆæœ€å¸¸ç”¨ï¼ŒXML-é…ç½®ï¼‰" class="headerlink" title="æ–¹æ¡ˆ 1ï¼šresultMapï¼ˆæœ€å¸¸ç”¨ï¼ŒXML é…ç½®ï¼‰"></a>æ–¹æ¡ˆ 1ï¼šresultMapï¼ˆæœ€å¸¸ç”¨ï¼ŒXML é…ç½®ï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å®šä¹‰æ˜ å°„è§„åˆ™ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;uid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span> <span class="comment">&lt;!-- ä¸»é”®æ˜ å°„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span> <span class="comment">&lt;!-- æ™®é€šå­—æ®µæ˜ å°„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userAge&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨æ˜ å°„è§„åˆ™ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userMap&quot;</span>&gt;</span></span><br><span class="line">    select * from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="æ–¹æ¡ˆ-2ï¼šSQL-åˆ«åï¼ˆç®€å•åœºæ™¯ï¼‰"><a href="#æ–¹æ¡ˆ-2ï¼šSQL-åˆ«åï¼ˆç®€å•åœºæ™¯ï¼‰" class="headerlink" title="æ–¹æ¡ˆ 2ï¼šSQL åˆ«åï¼ˆç®€å•åœºæ™¯ï¼‰"></a>æ–¹æ¡ˆ 2ï¼šSQL åˆ«åï¼ˆç®€å•åœºæ™¯ï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    select id as uid, name as username, age as userAge from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="æ–¹æ¡ˆ-3ï¼šå…¨å±€é©¼å³°æ˜ å°„ï¼ˆé’ˆå¯¹ä¸‹åˆ’çº¿å‘½åï¼‰"><a href="#æ–¹æ¡ˆ-3ï¼šå…¨å±€é©¼å³°æ˜ å°„ï¼ˆé’ˆå¯¹ä¸‹åˆ’çº¿å‘½åï¼‰" class="headerlink" title="æ–¹æ¡ˆ 3ï¼šå…¨å±€é©¼å³°æ˜ å°„ï¼ˆé’ˆå¯¹ä¸‹åˆ’çº¿å‘½åï¼‰"></a>æ–¹æ¡ˆ 3ï¼šå…¨å±€é©¼å³°æ˜ å°„ï¼ˆé’ˆå¯¹ä¸‹åˆ’çº¿å‘½åï¼‰</h4><p>åœ¨<code>mybatis-config.xml</code>ä¸­å¼€å¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ•ˆæœï¼šæ•°æ®åº“<code>user_name</code> â†’ å®ä½“<code>userName</code>ï¼Œ<code>user_age</code> â†’ <code>userAge</code></li>
</ul>
<h2 id="ä¸‰ã€æ¥å£ç»‘å®šä¸æ³¨è§£å¼€å‘"><a href="#ä¸‰ã€æ¥å£ç»‘å®šä¸æ³¨è§£å¼€å‘" class="headerlink" title="ä¸‰ã€æ¥å£ç»‘å®šä¸æ³¨è§£å¼€å‘"></a>ä¸‰ã€æ¥å£ç»‘å®šä¸æ³¨è§£å¼€å‘</h2><h3 id="3-1-æ¥å£ç»‘å®šï¼ˆæ¨èæ–¹å¼ï¼‰"><a href="#3-1-æ¥å£ç»‘å®šï¼ˆæ¨èæ–¹å¼ï¼‰" class="headerlink" title="3.1 æ¥å£ç»‘å®šï¼ˆæ¨èæ–¹å¼ï¼‰"></a>3.1 æ¥å£ç»‘å®šï¼ˆæ¨èæ–¹å¼ï¼‰</h3><p><strong>æ ¸å¿ƒåŸç†</strong>ï¼šé€šè¿‡åŠ¨æ€ä»£ç†ï¼Œå°† Mapper æ¥å£ä¸ XML æ˜ å°„æ–‡ä»¶ç»‘å®šï¼Œæ— éœ€ç¼–å†™å®ç°ç±»ã€‚</p>
<h4 id="æ­¥éª¤-1ï¼šå®šä¹‰-Mapper-æ¥å£"><a href="#æ­¥éª¤-1ï¼šå®šä¹‰-Mapper-æ¥å£" class="headerlink" title="æ­¥éª¤ 1ï¼šå®šä¹‰ Mapper æ¥å£"></a>æ­¥éª¤ 1ï¼šå®šä¹‰ Mapper æ¥å£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="comment">// æ–¹æ³•å = XMLä¸­selectçš„id</span></span><br><span class="line">    <span class="comment">// å‚æ•°ç±»å‹ = parameterType</span></span><br><span class="line">    <span class="comment">// è¿”å›å€¼ç±»å‹ = resultType/resultMap</span></span><br><span class="line">    User <span class="title function_">selectUserById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line">    List&lt;User&gt; <span class="title function_">selectAllUser</span><span class="params">()</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertUser</span><span class="params">(User user)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">updateUserAge</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="type">int</span> id, <span class="meta">@Param(&quot;age&quot;)</span> <span class="type">int</span> age)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">deleteUserById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ­¥éª¤-2ï¼šé…ç½®-XML-æ˜ å°„æ–‡ä»¶ï¼ˆnamespace-å¿…é¡»ä¸ºæ¥å£å…¨ç±»åï¼‰"><a href="#æ­¥éª¤-2ï¼šé…ç½®-XML-æ˜ å°„æ–‡ä»¶ï¼ˆnamespace-å¿…é¡»ä¸ºæ¥å£å…¨ç±»åï¼‰" class="headerlink" title="æ­¥éª¤ 2ï¼šé…ç½® XML æ˜ å°„æ–‡ä»¶ï¼ˆnamespace å¿…é¡»ä¸ºæ¥å£å…¨ç±»åï¼‰"></a>æ­¥éª¤ 2ï¼šé…ç½® XML æ˜ å°„æ–‡ä»¶ï¼ˆnamespace å¿…é¡»ä¸ºæ¥å£å…¨ç±»åï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.mapper.UserMapper&quot;</span>&gt;</span> <span class="comment">&lt;!-- æ¥å£å…¨ç±»å --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span> <span class="comment">&lt;!-- id = æ–¹æ³•å --&gt;</span></span><br><span class="line">        select * from user where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="æ­¥éª¤-3ï¼šé€šè¿‡æ¥å£è°ƒç”¨"><a href="#æ­¥éª¤-3ï¼šé€šè¿‡æ¥å£è°ƒç”¨" class="headerlink" title="æ­¥éª¤ 3ï¼šé€šè¿‡æ¥å£è°ƒç”¨"></a>æ­¥éª¤ 3ï¼šé€šè¿‡æ¥å£è°ƒç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">SqlSession</span> <span class="variable">session</span> <span class="operator">=</span> MybatisUtil.openSession()) &#123;</span><br><span class="line">    <span class="comment">// è·å–æ¥å£ä»£ç†å¯¹è±¡</span></span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> session.getMapper(UserMapper.class);</span><br><span class="line">    <span class="comment">// è°ƒç”¨æ–¹æ³•ï¼ˆè‡ªåŠ¨æ‰§è¡Œå¯¹åº”SQLï¼‰</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> mapper.selectUserById(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-æ³¨è§£å¼€å‘ï¼ˆç®€åŒ–é…ç½®ï¼‰"><a href="#3-2-æ³¨è§£å¼€å‘ï¼ˆç®€åŒ–é…ç½®ï¼‰" class="headerlink" title="3.2 æ³¨è§£å¼€å‘ï¼ˆç®€åŒ–é…ç½®ï¼‰"></a>3.2 æ³¨è§£å¼€å‘ï¼ˆç®€åŒ–é…ç½®ï¼‰</h3><p>é€‚åˆç®€å• SQLï¼Œå¤æ‚ SQL å»ºè®®ç”¨ XMLã€‚</p>
<h4 id="å¸¸ç”¨æ³¨è§£è¯´æ˜"><a href="#å¸¸ç”¨æ³¨è§£è¯´æ˜" class="headerlink" title="å¸¸ç”¨æ³¨è§£è¯´æ˜"></a>å¸¸ç”¨æ³¨è§£è¯´æ˜</h4><table>
<thead>
<tr>
<th>æ³¨è§£</th>
<th>ä½œç”¨</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>@Select</td>
<td>æŸ¥è¯¢æ“ä½œ</td>
<td>@Select(â€œSELECT * FROM user WHERE id &#x3D; #{id}â€)</td>
</tr>
<tr>
<td>@Insert</td>
<td>æ’å…¥æ“ä½œ</td>
<td>@Insert(â€œINSERT INTO user(name) VALUES(#{name})â€)</td>
</tr>
<tr>
<td>@Update</td>
<td>æ›´æ–°æ“ä½œ</td>
<td>@Update(â€œUPDATE user SET name &#x3D; #{name} WHERE id &#x3D; #{id}â€)</td>
</tr>
<tr>
<td>@Delete</td>
<td>åˆ é™¤æ“ä½œ</td>
<td>@Delete(â€œDELETE FROM user WHERE id &#x3D; #{id}â€)</td>
</tr>
<tr>
<td>@Results</td>
<td>å®šä¹‰ç»“æœæ˜ å°„</td>
<td>@Results({@Result(property&#x3D;â€uidâ€, column&#x3D;â€idâ€)})</td>
</tr>
<tr>
<td>@Param</td>
<td>å£°æ˜å‚æ•°å</td>
<td>æ–¹æ³•å‚æ•°å‰åŠ  @Param (â€œidâ€)</td>
</tr>
<tr>
<td>@Options</td>
<td>é¢å¤–é…ç½®ï¼ˆå¦‚è‡ªå¢ä¸»é”®ï¼‰</td>
<td>@Options(useGeneratedKeys &#x3D; true, keyProperty &#x3D; â€œidâ€)</td>
</tr>
</tbody></table>
<h4 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="comment">// åŸºç¡€æŸ¥è¯¢</span></span><br><span class="line">    <span class="meta">@Select(&quot;SELECT * FROM user WHERE id = #&#123;id&#125;&quot;)</span></span><br><span class="line">    User <span class="title function_">selectUserById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ’å…¥å¹¶è¿”å›è‡ªå¢ä¸»é”®</span></span><br><span class="line">    <span class="meta">@Options(useGeneratedKeys = true, keyProperty = &quot;id&quot;)</span> <span class="comment">// ä¸»é”®å›å†™è‡³å®ä½“idå±æ€§</span></span><br><span class="line">    <span class="meta">@Insert(&quot;INSERT INTO user(name, age) VALUES(#&#123;name&#125;, #&#123;age&#125;)&quot;)</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertUser</span><span class="params">(User user)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç»“æœæ˜ å°„ï¼ˆè§£å†³å­—æ®µä¸ä¸€è‡´ï¼‰</span></span><br><span class="line">    <span class="meta">@Results(&#123;</span></span><br><span class="line"><span class="meta">        @Result(property = &quot;uid&quot;, column = &quot;id&quot;),       // ä¸»é”®æ˜ å°„</span></span><br><span class="line"><span class="meta">        @Result(property = &quot;username&quot;, column = &quot;name&quot;) // æ™®é€šå­—æ®µæ˜ å°„</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="meta">@Select(&quot;SELECT * FROM user&quot;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">selectAllUser</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åŠ¨æ€SQLï¼ˆæ³¨è§£ä¸­ç”¨&lt;script&gt;åŒ…è£¹ï¼‰</span></span><br><span class="line">    <span class="meta">@Select(&quot;&lt;script&gt;&quot; +</span></span><br><span class="line"><span class="meta">            &quot;SELECT * FROM user WHERE 1=1&quot; +</span></span><br><span class="line"><span class="meta">            &quot;&lt;if test=&#x27;name != null&#x27;&gt; AND name = #&#123;name&#125;&lt;/if&gt;&quot; +</span></span><br><span class="line"><span class="meta">            &quot;&lt;if test=&#x27;age != null&#x27;&gt; AND age = #&#123;age&#125;&lt;/if&gt;&quot; +</span></span><br><span class="line"><span class="meta">            &quot;&lt;/script&gt;&quot;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">selectByCondition</span><span class="params">(User user)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€å¤æ‚å…³ç³»æŸ¥è¯¢ï¼ˆå…³è”æ˜ å°„ï¼‰"><a href="#å››ã€å¤æ‚å…³ç³»æŸ¥è¯¢ï¼ˆå…³è”æ˜ å°„ï¼‰" class="headerlink" title="å››ã€å¤æ‚å…³ç³»æŸ¥è¯¢ï¼ˆå…³è”æ˜ å°„ï¼‰"></a>å››ã€å¤æ‚å…³ç³»æŸ¥è¯¢ï¼ˆå…³è”æ˜ å°„ï¼‰</h2><h3 id="4-1-ä¸€å¯¹ä¸€æŸ¥è¯¢ï¼ˆå¦‚-User-ä¸-UserDetailï¼‰"><a href="#4-1-ä¸€å¯¹ä¸€æŸ¥è¯¢ï¼ˆå¦‚-User-ä¸-UserDetailï¼‰" class="headerlink" title="4.1 ä¸€å¯¹ä¸€æŸ¥è¯¢ï¼ˆå¦‚ User ä¸ UserDetailï¼‰"></a>4.1 ä¸€å¯¹ä¸€æŸ¥è¯¢ï¼ˆå¦‚ User ä¸ UserDetailï¼‰</h3><h4 id="å®ä½“ç±»è®¾è®¡"><a href="#å®ä½“ç±»è®¾è®¡" class="headerlink" title="å®ä½“ç±»è®¾è®¡"></a>å®ä½“ç±»è®¾è®¡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> UserDetail detail; <span class="comment">// ä¸€å¯¹ä¸€å…³è”ï¼ˆä¸€ä¸ªç”¨æˆ·å¯¹åº”ä¸€ä¸ªè¯¦æƒ…ï¼‰</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDetail</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> Date registerTime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å…³è”æŸ¥è¯¢å®ç°ï¼ˆ2-ç§æ–¹å¼ï¼‰"><a href="#å…³è”æŸ¥è¯¢å®ç°ï¼ˆ2-ç§æ–¹å¼ï¼‰" class="headerlink" title="å…³è”æŸ¥è¯¢å®ç°ï¼ˆ2 ç§æ–¹å¼ï¼‰"></a>å…³è”æŸ¥è¯¢å®ç°ï¼ˆ2 ç§æ–¹å¼ï¼‰</h4><h5 id="æ–¹å¼-1ï¼šå…³è”æŸ¥è¯¢ï¼ˆJOIN-è¯­å¥ï¼Œä¸€æ¬¡æŸ¥è¯¢ï¼‰"><a href="#æ–¹å¼-1ï¼šå…³è”æŸ¥è¯¢ï¼ˆJOIN-è¯­å¥ï¼Œä¸€æ¬¡æŸ¥è¯¢ï¼‰" class="headerlink" title="æ–¹å¼ 1ï¼šå…³è”æŸ¥è¯¢ï¼ˆJOIN è¯­å¥ï¼Œä¸€æ¬¡æŸ¥è¯¢ï¼‰"></a>æ–¹å¼ 1ï¼šå…³è”æŸ¥è¯¢ï¼ˆJOIN è¯­å¥ï¼Œä¸€æ¬¡æŸ¥è¯¢ï¼‰</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userWithDetail&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- associationï¼šä¸€å¯¹ä¸€å…³è” --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">property</span>=<span class="string">&quot;detail&quot;</span>      &lt;!<span class="attr">--</span> <span class="attr">å®ä½“ä¸­å…³è”å±æ€§å</span> <span class="attr">--</span>&gt;</span></span><br><span class="line">        javaType=&quot;UserDetail&quot;&gt; <span class="comment">&lt;!-- å…³è”å±æ€§ç±»å‹ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;detail_id&quot;</span>/&gt;</span> <span class="comment">&lt;!-- æ³¨æ„columnä¸æŸ¥è¯¢ç»“æœåˆ«åå¯¹åº” --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;address&quot;</span> <span class="attr">column</span>=<span class="string">&quot;address&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;registerTime&quot;</span> <span class="attr">column</span>=<span class="string">&quot;register_time&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserWithDetail&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userWithDetail&quot;</span>&gt;</span></span><br><span class="line">    SELECT </span><br><span class="line">        u.id, u.name, </span><br><span class="line">        ud.id as detail_id, ud.address, ud.register_time </span><br><span class="line">    FROM user u </span><br><span class="line">    LEFT JOIN user_detail ud ON u.id = ud.user_id </span><br><span class="line">    WHERE u.id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="æ–¹å¼-2ï¼šåµŒå¥—æŸ¥è¯¢ï¼ˆå­æŸ¥è¯¢ï¼Œå¤šæ¬¡æŸ¥è¯¢ï¼‰"><a href="#æ–¹å¼-2ï¼šåµŒå¥—æŸ¥è¯¢ï¼ˆå­æŸ¥è¯¢ï¼Œå¤šæ¬¡æŸ¥è¯¢ï¼‰" class="headerlink" title="æ–¹å¼ 2ï¼šåµŒå¥—æŸ¥è¯¢ï¼ˆå­æŸ¥è¯¢ï¼Œå¤šæ¬¡æŸ¥è¯¢ï¼‰"></a>æ–¹å¼ 2ï¼šåµŒå¥—æŸ¥è¯¢ï¼ˆå­æŸ¥è¯¢ï¼Œå¤šæ¬¡æŸ¥è¯¢ï¼‰</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userWithDetail&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">property</span>=<span class="string">&quot;detail&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">javaType</span>=<span class="string">&quot;UserDetail&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>                   &lt;!<span class="attr">--</span> <span class="attr">ä¼ é€’ç»™å­æŸ¥è¯¢çš„å‚æ•°</span>ï¼ˆ<span class="attr">userçš„id</span>ï¼‰ <span class="attr">--</span>&gt;</span></span><br><span class="line">        select=&quot;selectUserDetail&quot;/&gt;   <span class="comment">&lt;!-- å­æŸ¥è¯¢çš„id --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ä¸»æŸ¥è¯¢ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserWithDetail&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userWithDetail&quot;</span>&gt;</span></span><br><span class="line">    select * from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å­æŸ¥è¯¢ï¼ˆæ ¹æ®user_idæŸ¥è¯¦æƒ…ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserDetail&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;UserDetail&quot;</span>&gt;</span></span><br><span class="line">    select * from user_detail where user_id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„</strong>ï¼šåµŒå¥—æŸ¥è¯¢å¯èƒ½å¯¼è‡´ N+1 é—®é¢˜ï¼ˆæŸ¥è¯¢ 1 ä¸ªç”¨æˆ·å¼•å‘ 1 æ¬¡ä¸»æŸ¥è¯¢ + N æ¬¡å­æŸ¥è¯¢ï¼‰ï¼Œå»ºè®®ä¼˜å…ˆç”¨å…³è”æŸ¥è¯¢ã€‚</p>
<h4 id="å¤šå‚æ•°ä¼ é€’"><a href="#å¤šå‚æ•°ä¼ é€’" class="headerlink" title="å¤šå‚æ•°ä¼ é€’"></a>å¤šå‚æ•°ä¼ é€’</h4><p><code>association</code>æ ‡ç­¾çš„<code>column</code>å±æ€§æ”¯æŒå¤šåˆ—ä¼ é€’ï¼ˆç”¨äºå­æŸ¥è¯¢éœ€è¦å¤šä¸ªå‚æ•°çš„åœºæ™¯ï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userWithDetail&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">property</span>=<span class="string">&quot;detail&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">javaType</span>=<span class="string">&quot;UserDetail&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">column</span>=<span class="string">&quot;&#123;userId=id, status=status&#125;&quot;</span> &lt;!<span class="attr">--</span> <span class="attr">å¤šåˆ—å‚æ•°</span>ï¼ˆ<span class="attr">keyä¸ºå­æŸ¥è¯¢å‚æ•°å</span>ï¼Œ<span class="attr">valueä¸ºå½“å‰æŸ¥è¯¢åˆ—å</span>ï¼‰ <span class="attr">--</span>&gt;</span></span><br><span class="line">        select=&quot;selectUserDetailByMultiParams&quot;/&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å­æŸ¥è¯¢æ¥æ”¶å¤šå‚æ•° --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserDetailByMultiParams&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;UserDetail&quot;</span>&gt;</span></span><br><span class="line">    select * from user_detail where user_id = #&#123;userId&#125; and status = #&#123;status&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-ä¸€å¯¹å¤šæŸ¥è¯¢ï¼ˆå¦‚-User-ä¸-Bookï¼‰"><a href="#4-2-ä¸€å¯¹å¤šæŸ¥è¯¢ï¼ˆå¦‚-User-ä¸-Bookï¼‰" class="headerlink" title="4.2 ä¸€å¯¹å¤šæŸ¥è¯¢ï¼ˆå¦‚ User ä¸ Bookï¼‰"></a>4.2 ä¸€å¯¹å¤šæŸ¥è¯¢ï¼ˆå¦‚ User ä¸ Bookï¼‰</h3><h4 id="å®ä½“ç±»è®¾è®¡-1"><a href="#å®ä½“ç±»è®¾è®¡-1" class="headerlink" title="å®ä½“ç±»è®¾è®¡"></a>å®ä½“ç±»è®¾è®¡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Book&gt; books; <span class="comment">// ä¸€å¯¹å¤šå…³è”ï¼ˆä¸€ä¸ªç”¨æˆ·æœ‰å¤šæœ¬ä¹¦ï¼‰</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Book</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> userId; <span class="comment">// å…³è”ç”¨æˆ·id</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å®ç°æ–¹å¼ï¼ˆå…³è”æŸ¥è¯¢ï¼‰"><a href="#å®ç°æ–¹å¼ï¼ˆå…³è”æŸ¥è¯¢ï¼‰" class="headerlink" title="å®ç°æ–¹å¼ï¼ˆå…³è”æŸ¥è¯¢ï¼‰"></a>å®ç°æ–¹å¼ï¼ˆå…³è”æŸ¥è¯¢ï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userWithBooks&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- collectionï¼šä¸€å¯¹å¤šå…³è” --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">property</span>=<span class="string">&quot;books&quot;</span>    &lt;!<span class="attr">--</span> <span class="attr">é›†åˆå±æ€§å</span> <span class="attr">--</span>&gt;</span></span><br><span class="line">        ofType=&quot;Book&quot;&gt;      <span class="comment">&lt;!-- é›†åˆå…ƒç´ ç±»å‹ï¼ˆåŒºåˆ«äºjavaTypeï¼‰ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;book_id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;title&quot;</span> <span class="attr">column</span>=<span class="string">&quot;title&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserWithBooks&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userWithBooks&quot;</span>&gt;</span></span><br><span class="line">    SELECT </span><br><span class="line">        u.id, u.name, </span><br><span class="line">        b.id as book_id, b.title, b.user_id </span><br><span class="line">    FROM user u </span><br><span class="line">    LEFT JOIN book b ON u.id = b.user_id </span><br><span class="line">    WHERE u.id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="åŠ è½½æ–¹å¼"><a href="#åŠ è½½æ–¹å¼" class="headerlink" title="åŠ è½½æ–¹å¼"></a>åŠ è½½æ–¹å¼</h4><p><code>collection</code>æ ‡ç­¾çš„<code>fetchType</code>å±æ€§æ§åˆ¶åŠ è½½æ–¹å¼ï¼ˆ<code>eager</code>ç«‹å³åŠ è½½ &#x2F; <code>lazy</code>å»¶è¿ŸåŠ è½½ï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userWithBooks&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">property</span>=<span class="string">&quot;books&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ofType</span>=<span class="string">&quot;Book&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">column</span>=<span class="string">&quot;id&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">select</span>=<span class="string">&quot;selectBooksByUserId&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">fetchType</span>=<span class="string">&quot;lazy&quot;</span>/&gt;</span> <span class="comment">&lt;!-- å»¶è¿ŸåŠ è½½ï¼šåªæœ‰è°ƒç”¨user.getBooks()æ—¶æ‰æ‰§è¡Œå­æŸ¥è¯¢ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectBooksByUserId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Book&quot;</span>&gt;</span></span><br><span class="line">    select * from book where user_id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>å»¶è¿ŸåŠ è½½é…ç½®</strong>ï¼ˆéœ€åœ¨å…¨å±€è®¾ç½®ä¸­å¼€å¯ï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span> <span class="comment">&lt;!-- å…¨å±€å»¶è¿ŸåŠ è½½å¼€å…³ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;aggressiveLazyLoading&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span> <span class="comment">&lt;!-- æŒ‰éœ€åŠ è½½ï¼ˆä¸è§¦å‘å…³è”å¯¹è±¡å…¨åŠ è½½ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€DML-æ“ä½œä¸äº‹åŠ¡"><a href="#äº”ã€DML-æ“ä½œä¸äº‹åŠ¡" class="headerlink" title="äº”ã€DML æ“ä½œä¸äº‹åŠ¡"></a>äº”ã€DML æ“ä½œä¸äº‹åŠ¡</h2><h3 id="5-1-å¢åˆ æ”¹æ“ä½œï¼ˆXML-é…ç½®ï¼‰"><a href="#5-1-å¢åˆ æ”¹æ“ä½œï¼ˆXML-é…ç½®ï¼‰" class="headerlink" title="5.1 å¢åˆ æ”¹æ“ä½œï¼ˆXML é…ç½®ï¼‰"></a>5.1 å¢åˆ æ”¹æ“ä½œï¼ˆXML é…ç½®ï¼‰</h3><h4 id="æ’å…¥æ“ä½œï¼ˆå«è‡ªå¢ä¸»é”®ï¼‰"><a href="#æ’å…¥æ“ä½œï¼ˆå«è‡ªå¢ä¸»é”®ï¼‰" class="headerlink" title="æ’å…¥æ“ä½œï¼ˆå«è‡ªå¢ä¸»é”®ï¼‰"></a>æ’å…¥æ“ä½œï¼ˆå«è‡ªå¢ä¸»é”®ï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span>  &lt;!<span class="attr">--</span> <span class="attr">å¼€å¯è‡ªå¢ä¸»é”®è·å–</span> <span class="attr">--</span>&gt;</span></span><br><span class="line">    keyProperty=&quot;id&quot;&gt;        <span class="comment">&lt;!-- ä¸»é”®å€¼å›å†™è‡³å®ä½“çš„idå±æ€§ --&gt;</span></span><br><span class="line">    INSERT INTO user(name, age) VALUES(#&#123;name&#125;, #&#123;age&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>è°ƒç”¨åå¯é€šè¿‡<code>user.getId()</code>è·å–è‡ªåŠ¨ç”Ÿæˆçš„ä¸»é”®</li>
</ul>
<p><strong>éè‡ªå¢ä¸»é”®ï¼ˆå¦‚ UUIDï¼‰çš„è·å–æ–¹å¼ï¼š</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUserWithUUID&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ’å…¥å‰ç”ŸæˆUUID --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">selectKey</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>    &lt;!<span class="attr">--</span> <span class="attr">ä¸»é”®å›å†™è‡³å®ä½“çš„idå±æ€§</span> <span class="attr">--</span>&gt;</span></span><br><span class="line">        resultType=&quot;String&quot; <span class="comment">&lt;!-- ä¸»é”®ç±»å‹ --&gt;</span></span><br><span class="line">        order=&quot;BEFORE&quot;&gt;     <span class="comment">&lt;!-- æ‰§è¡Œæ—¶æœºï¼šBEFOREï¼ˆæ’å…¥å‰ï¼‰/AFTERï¼ˆæ’å…¥åï¼‰ --&gt;</span></span><br><span class="line">        SELECT REPLACE(UUID(), &#x27;-&#x27;, &#x27;&#x27;) AS id</span><br><span class="line">    <span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></span><br><span class="line">    INSERT INTO user(id, name) VALUES(#&#123;id&#125;, #&#123;name&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>è”åˆä¸»é”®åœºæ™¯ï¼ˆ<code>keyColumn</code>æŒ‡å®šæ•°æ®åº“åˆ—åï¼‰ï¼š</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertOrderItem&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">keyProperty</span>=<span class="string">&quot;itemId&quot;</span> <span class="attr">keyColumn</span>=<span class="string">&quot;item_id&quot;</span>&gt;</span> <span class="comment">&lt;!-- å¤šä¸»é”®ç”¨é€—å·åˆ†éš”ï¼škeyColumn=&quot;col1,col2&quot; --&gt;</span></span><br><span class="line">    INSERT INTO order_item(order_id, product_id, quantity) </span><br><span class="line">    VALUES(#&#123;orderId&#125;, #&#123;productId&#125;, #&#123;quantity&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¤é…ç½®é¿å…äº†æ’å…¥åéœ€æ‰‹åŠ¨æŸ¥è¯¢ä¸»é”®çš„é¢å¤–æ“ä½œï¼Œç®€åŒ–äº†å…³è”æ•°æ®çš„æ’å…¥é€»è¾‘ã€‚</li>
</ul>
<h4 id="æ›´æ–°æ“ä½œ"><a href="#æ›´æ–°æ“ä½œ" class="headerlink" title="æ›´æ–°æ“ä½œ"></a>æ›´æ–°æ“ä½œ</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    UPDATE user </span><br><span class="line">    SET name = #&#123;name&#125;, age = #&#123;age&#125; </span><br><span class="line">    WHERE id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="åˆ é™¤æ“ä½œ"><a href="#åˆ é™¤æ“ä½œ" class="headerlink" title="åˆ é™¤æ“ä½œ"></a>åˆ é™¤æ“ä½œ</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUserById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;int&quot;</span>&gt;</span></span><br><span class="line">    DELETE FROM user WHERE id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-äº‹åŠ¡ç®¡ç†"><a href="#5-2-äº‹åŠ¡ç®¡ç†" class="headerlink" title="5.2 äº‹åŠ¡ç®¡ç†"></a>5.2 äº‹åŠ¡ç®¡ç†</h3><p>Mybatis äº‹åŠ¡é»˜è®¤ä¾èµ– JDBC äº‹åŠ¡ç®¡ç†å™¨ï¼Œéœ€æ‰‹åŠ¨æ§åˆ¶æäº¤ &#x2F; å›æ»šã€‚</p>
<h4 id="äº‹åŠ¡æ“ä½œæµç¨‹"><a href="#äº‹åŠ¡æ“ä½œæµç¨‹" class="headerlink" title="äº‹åŠ¡æ“ä½œæµç¨‹"></a>äº‹åŠ¡æ“ä½œæµç¨‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">SqlSession</span> <span class="variable">session</span> <span class="operator">=</span> MybatisUtil.openSession()) &#123; <span class="comment">// å…³é—­è‡ªåŠ¨æäº¤ï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> session.getMapper(UserMapper.class);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œå¤šä¸ªDMLæ“ä½œ</span></span><br><span class="line">        mapper.insertUser(user1);</span><br><span class="line">        mapper.updateUser(user2);</span><br><span class="line">        </span><br><span class="line">        session.commit(); <span class="comment">// å…¨éƒ¨æˆåŠŸåˆ™æäº¤</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        session.rollback(); <span class="comment">// å¤±è´¥åˆ™å›æ»š</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;äº‹åŠ¡æ‰§è¡Œå¤±è´¥&quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="äº‹åŠ¡ç‰¹æ€§"><a href="#äº‹åŠ¡ç‰¹æ€§" class="headerlink" title="äº‹åŠ¡ç‰¹æ€§"></a>äº‹åŠ¡ç‰¹æ€§</h4><ul>
<li><strong>åŸå­æ€§</strong>ï¼šå¤šä¸ªæ“ä½œè¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥</li>
<li><strong>ä¸€è‡´æ€§</strong>ï¼šäº‹åŠ¡å‰åæ•°æ®çŠ¶æ€ä¸€è‡´</li>
<li><strong>éš”ç¦»æ€§</strong>ï¼šä¸åŒäº‹åŠ¡äº’ä¸å¹²æ‰°ï¼ˆä¾èµ–æ•°æ®åº“éš”ç¦»çº§åˆ«ï¼‰</li>
<li><strong>æŒä¹…æ€§</strong>ï¼šæäº¤åæ•°æ®æ°¸ä¹…ä¿å­˜</li>
</ul>
<h2 id="å…­ã€åŠ¨æ€-SQL-ä¸ç¼“å­˜"><a href="#å…­ã€åŠ¨æ€-SQL-ä¸ç¼“å­˜" class="headerlink" title="å…­ã€åŠ¨æ€ SQL ä¸ç¼“å­˜"></a>å…­ã€åŠ¨æ€ SQL ä¸ç¼“å­˜</h2><h3 id="6-1-åŠ¨æ€-SQLï¼ˆXML-æ ‡ç­¾è¯¦è§£ï¼‰"><a href="#6-1-åŠ¨æ€-SQLï¼ˆXML-æ ‡ç­¾è¯¦è§£ï¼‰" class="headerlink" title="6.1 åŠ¨æ€ SQLï¼ˆXML æ ‡ç­¾è¯¦è§£ï¼‰"></a>6.1 åŠ¨æ€ SQLï¼ˆXML æ ‡ç­¾è¯¦è§£ï¼‰</h3><p>åŠ¨æ€ SQL ç”¨äºæ ¹æ®æ¡ä»¶åŠ¨æ€ç”Ÿæˆ SQL è¯­å¥ï¼Œé¿å…å­—ç¬¦ä¸²æ‹¼æ¥çš„ç¹çä¸é£é™©ã€‚</p>
<h4 id="ï¼ˆ1ï¼‰if-æ ‡ç­¾ï¼ˆæ¡ä»¶åˆ¤æ–­ï¼‰"><a href="#ï¼ˆ1ï¼‰if-æ ‡ç­¾ï¼ˆæ¡ä»¶åˆ¤æ–­ï¼‰" class="headerlink" title="ï¼ˆ1ï¼‰if æ ‡ç­¾ï¼ˆæ¡ä»¶åˆ¤æ–­ï¼‰"></a>ï¼ˆ1ï¼‰if æ ‡ç­¾ï¼ˆæ¡ä»¶åˆ¤æ–­ï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM user WHERE 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null and name != &#x27;&#x27;&quot;</span>&gt;</span> <span class="comment">&lt;!-- testä¸­ç”¨OGNLè¡¨è¾¾å¼ --&gt;</span></span><br><span class="line">        AND name = #&#123;name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null&quot;</span>&gt;</span></span><br><span class="line">        AND age = #&#123;age&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>åŠ¨æ€ SQL ä¸­<code>if</code>æ ‡ç­¾çš„å¤æ‚åœºæ™¯</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¤šæ¡ä»¶æ¨¡ç³ŠæŸ¥è¯¢ + èŒƒå›´æŸ¥è¯¢ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserByAdvancedCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM user</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null and name != &#x27;&#x27;&quot;</span>&gt;</span></span><br><span class="line">            AND name LIKE CONCAT(&#x27;%&#x27;, #&#123;name&#125;, &#x27;%&#x27;) <span class="comment">&lt;!-- æ¨¡ç³ŠæŸ¥è¯¢æ‹¼æ¥ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;ageRange != null&quot;</span>&gt;</span> <span class="comment">&lt;!-- ä¼ å…¥Map&lt;String, Integer&gt; ageRangeï¼ŒåŒ…å«minå’Œmax --&gt;</span></span><br><span class="line">            AND age BETWEEN #&#123;ageRange.min&#125; AND #&#123;ageRange.max&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;statusList != null and statusList.size() &gt; 0&quot;</span>&gt;</span> <span class="comment">&lt;!-- ä¼ å…¥List&lt;Integer&gt; --&gt;</span></span><br><span class="line">            AND status IN</span><br><span class="line">            <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;statusList&quot;</span> <span class="attr">item</span>=<span class="string">&quot;s&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">                #&#123;s&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ï¼ˆ2ï¼‰where-æ ‡ç­¾ï¼ˆè‡ªåŠ¨å¤„ç†-AND-ORï¼‰"><a href="#ï¼ˆ2ï¼‰where-æ ‡ç­¾ï¼ˆè‡ªåŠ¨å¤„ç†-AND-ORï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰where æ ‡ç­¾ï¼ˆè‡ªåŠ¨å¤„ç† AND&#x2F;ORï¼‰"></a>ï¼ˆ2ï¼‰where æ ‡ç­¾ï¼ˆè‡ªåŠ¨å¤„ç† AND&#x2F;ORï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectByCondition&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM user</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span> <span class="comment">&lt;!-- è‡ªåŠ¨ç§»é™¤é¦–ä¸ªAND/OR --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null&quot;</span>&gt;</span>AND name = #&#123;name&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null&quot;</span>&gt;</span>AND age = #&#123;age&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ï¼ˆ3ï¼‰set-æ ‡ç­¾ï¼ˆæ›´æ–°æ—¶è‡ªåŠ¨å¤„ç†é€—å·ï¼‰"><a href="#ï¼ˆ3ï¼‰set-æ ‡ç­¾ï¼ˆæ›´æ–°æ—¶è‡ªåŠ¨å¤„ç†é€—å·ï¼‰" class="headerlink" title="ï¼ˆ3ï¼‰set æ ‡ç­¾ï¼ˆæ›´æ–°æ—¶è‡ªåŠ¨å¤„ç†é€—å·ï¼‰"></a>ï¼ˆ3ï¼‰set æ ‡ç­¾ï¼ˆæ›´æ–°æ—¶è‡ªåŠ¨å¤„ç†é€—å·ï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    UPDATE user</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span> <span class="comment">&lt;!-- è‡ªåŠ¨ç§»é™¤æœ«å°¾é€—å· --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name != null&quot;</span>&gt;</span>name = #&#123;name&#125;,<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != null&quot;</span>&gt;</span>age = #&#123;age&#125;<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    WHERE id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ï¼ˆ4ï¼‰foreach-æ ‡ç­¾ï¼ˆå¾ªç¯éå†ï¼Œæ‰¹é‡æ“ä½œï¼‰"><a href="#ï¼ˆ4ï¼‰foreach-æ ‡ç­¾ï¼ˆå¾ªç¯éå†ï¼Œæ‰¹é‡æ“ä½œï¼‰" class="headerlink" title="ï¼ˆ4ï¼‰foreach æ ‡ç­¾ï¼ˆå¾ªç¯éå†ï¼Œæ‰¹é‡æ“ä½œï¼‰"></a>ï¼ˆ4ï¼‰foreach æ ‡ç­¾ï¼ˆå¾ªç¯éå†ï¼Œæ‰¹é‡æ“ä½œï¼‰</h4><ul>
<li><strong>æ‰¹é‡åˆ é™¤</strong>ï¼š</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;batchDelete&quot;</span>&gt;</span></span><br><span class="line">    DELETE FROM user WHERE id IN</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span>  &lt;!<span class="attr">--</span> <span class="attr">é›†åˆå‚æ•°å</span>ï¼ˆ<span class="attr">list</span>/<span class="attr">map.key</span>/<span class="attr">æ•°ç»„</span>ï¼‰ <span class="attr">--</span>&gt;</span></span><br><span class="line">        item=&quot;id&quot;          <span class="comment">&lt;!-- éå†å…ƒç´ åˆ«å --&gt;</span></span><br><span class="line">        open=&quot;(&quot;           <span class="comment">&lt;!-- å¼€å§‹ç¬¦å· --&gt;</span></span><br><span class="line">        separator=&quot;,&quot;      <span class="comment">&lt;!-- åˆ†éš”ç¬¦ --&gt;</span></span><br><span class="line">        close=&quot;)&quot;&gt;         <span class="comment">&lt;!-- ç»“æŸç¬¦å· --&gt;</span></span><br><span class="line">        #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>æ‰¹é‡æ’å…¥</strong>ï¼š</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;batchInsert&quot;</span>&gt;</span></span><br><span class="line">    INSERT INTO user(name, age) VALUES</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;user&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        (#&#123;user.name&#125;, #&#123;user.age&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ï¼ˆ5ï¼‰choose-æ ‡ç­¾ï¼ˆåˆ†æ”¯é€‰æ‹©ï¼Œç±»ä¼¼-switchï¼‰"><a href="#ï¼ˆ5ï¼‰choose-æ ‡ç­¾ï¼ˆåˆ†æ”¯é€‰æ‹©ï¼Œç±»ä¼¼-switchï¼‰" class="headerlink" title="ï¼ˆ5ï¼‰choose æ ‡ç­¾ï¼ˆåˆ†æ”¯é€‰æ‹©ï¼Œç±»ä¼¼ switchï¼‰"></a>ï¼ˆ5ï¼‰choose æ ‡ç­¾ï¼ˆåˆ†æ”¯é€‰æ‹©ï¼Œç±»ä¼¼ switchï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectByChoose&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">    SELECT * FROM user WHERE 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;id != null&quot;</span>&gt;</span>AND id = #&#123;id&#125;<span class="tag">&lt;/<span class="name">when</span>&gt;</span> <span class="comment">&lt;!-- ä¼˜å…ˆæ»¡è¶³çš„æ¡ä»¶ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;name != null&quot;</span>&gt;</span>AND name = #&#123;name&#125;<span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span>AND age = 18<span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span> <span class="comment">&lt;!-- æ‰€æœ‰æ¡ä»¶ä¸æ»¡è¶³æ—¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-2-ç¼“å­˜æœºåˆ¶ï¼ˆä¸€çº§ç¼“å­˜-äºŒçº§ç¼“å­˜ï¼‰"><a href="#6-2-ç¼“å­˜æœºåˆ¶ï¼ˆä¸€çº§ç¼“å­˜-äºŒçº§ç¼“å­˜ï¼‰" class="headerlink" title="6.2 ç¼“å­˜æœºåˆ¶ï¼ˆä¸€çº§ç¼“å­˜ + äºŒçº§ç¼“å­˜ï¼‰"></a>6.2 ç¼“å­˜æœºåˆ¶ï¼ˆä¸€çº§ç¼“å­˜ + äºŒçº§ç¼“å­˜ï¼‰</h3><p>ç¼“å­˜ç”¨äºå‡å°‘æ•°æ®åº“è®¿é—®ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p>
<h4 id="6-2-1-ä¸€çº§ç¼“å­˜ï¼ˆSqlSession-çº§åˆ«ï¼Œé»˜è®¤å¼€å¯ï¼‰"><a href="#6-2-1-ä¸€çº§ç¼“å­˜ï¼ˆSqlSession-çº§åˆ«ï¼Œé»˜è®¤å¼€å¯ï¼‰" class="headerlink" title="6.2.1 ä¸€çº§ç¼“å­˜ï¼ˆSqlSession çº§åˆ«ï¼Œé»˜è®¤å¼€å¯ï¼‰"></a>6.2.1 ä¸€çº§ç¼“å­˜ï¼ˆSqlSession çº§åˆ«ï¼Œé»˜è®¤å¼€å¯ï¼‰</h4><ul>
<li><strong>ä½œç”¨èŒƒå›´</strong>ï¼šåŒä¸€ä¸ª SqlSession å†…ï¼Œå¤šæ¬¡æŸ¥è¯¢åŒä¸€æ•°æ®ï¼ˆç›¸åŒ SQL + å‚æ•°ï¼‰ï¼Œåªæ‰§è¡Œä¸€æ¬¡ SQLï¼Œåç»­ä»ç¼“å­˜è·å–ã€‚</li>
<li>å¤±æ•ˆåœºæ™¯ï¼š<ul>
<li>æ‰§è¡Œå¢åˆ æ”¹æ“ä½œï¼ˆè‡ªåŠ¨æ¸…ç©ºç¼“å­˜ï¼‰</li>
<li>æ‰‹åŠ¨è°ƒç”¨<code>session.clearCache()</code></li>
<li>å…³é—­ SqlSession åé‡æ–°è·å–</li>
</ul>
</li>
</ul>
<h5 id="ä¸€çº§ç¼“å­˜æ·±åº¦è§£æ"><a href="#ä¸€çº§ç¼“å­˜æ·±åº¦è§£æ" class="headerlink" title="ä¸€çº§ç¼“å­˜æ·±åº¦è§£æ"></a>ä¸€çº§ç¼“å­˜æ·±åº¦è§£æ</h5><p><strong>ï¼ˆ1ï¼‰æ ¸å¿ƒä»£ç é€»è¾‘ï¼ˆMyBatis æºç ç®€åŒ–ï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SqlSessionçš„æŸ¥è¯¢æ–¹æ³•ï¼ˆç®€åŒ–ï¼‰</span></span><br><span class="line"><span class="keyword">public</span> &lt;E&gt; List&lt;E&gt; <span class="title function_">query</span><span class="params">(MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler)</span> &#123;</span><br><span class="line">    <span class="type">BoundSql</span> <span class="variable">boundSql</span> <span class="operator">=</span> ms.getBoundSql(parameter);</span><br><span class="line">    <span class="type">CacheKey</span> <span class="variable">key</span> <span class="operator">=</span> createCacheKey(ms, parameter, rowBounds, boundSql); <span class="comment">// ç”Ÿæˆç¼“å­˜é”®</span></span><br><span class="line">    <span class="keyword">return</span> query(ms, parameter, rowBounds, resultHandler, key, boundSql);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> &lt;E&gt; List&lt;E&gt; <span class="title function_">query</span><span class="params">(...)</span> &#123;</span><br><span class="line">    List&lt;E&gt; list;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        list = (List&lt;E&gt;) localCache.getObject(key); <span class="comment">// ä»ä¸€çº§ç¼“å­˜è·å–</span></span><br><span class="line">        <span class="keyword">if</span> (list == <span class="literal">null</span>) &#123;</span><br><span class="line">            list = queryFromDatabase(ms, parameter, rowBounds, resultHandler, key, boundSql); <span class="comment">// æŸ¥æ•°æ®åº“</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ï¼ˆ2ï¼‰localCacheScope é…ç½®çš„å½±å“</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é»˜è®¤ä¸ºSESSIONï¼šä¸€çº§ç¼“å­˜ä½œç”¨äºæ•´ä¸ªSqlSession --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- è®¾ç½®ä¸ºSTATEMENTï¼šæ¯æ¬¡æŸ¥è¯¢åæ¸…ç©ºç¼“å­˜ï¼Œå³ä¸€çº§ç¼“å­˜å¤±æ•ˆ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;localCacheScope&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STATEMENT&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>SESSION</code>ï¼ˆé»˜è®¤ï¼‰ï¼šåŒä¸€ SqlSession å†…å¤šæ¬¡æŸ¥è¯¢åŒä¸€æ•°æ®ï¼Œä»…æ‰§è¡Œä¸€æ¬¡ SQL</li>
<li><code>STATEMENT</code>ï¼šæ¯æ¬¡æŸ¥è¯¢éƒ½æ‰§è¡Œ SQLï¼ˆé€‚åˆéœ€è¦å®æ—¶æ•°æ®çš„åœºæ™¯ï¼‰</li>
</ul>
<h4 id="6-2-2-äºŒçº§ç¼“å­˜ï¼ˆMapper-çº§åˆ«ï¼Œéœ€æ‰‹åŠ¨å¼€å¯ï¼‰"><a href="#6-2-2-äºŒçº§ç¼“å­˜ï¼ˆMapper-çº§åˆ«ï¼Œéœ€æ‰‹åŠ¨å¼€å¯ï¼‰" class="headerlink" title="6.2.2 äºŒçº§ç¼“å­˜ï¼ˆMapper çº§åˆ«ï¼Œéœ€æ‰‹åŠ¨å¼€å¯ï¼‰"></a>6.2.2 äºŒçº§ç¼“å­˜ï¼ˆMapper çº§åˆ«ï¼Œéœ€æ‰‹åŠ¨å¼€å¯ï¼‰</h4><ul>
<li><strong>ä½œç”¨èŒƒå›´</strong>ï¼šåŒä¸€ä¸ª Mapper æ¥å£çš„ä¸åŒ SqlSession å…±äº«ç¼“å­˜ã€‚</li>
<li><strong>å¼€å¯æ­¥éª¤</strong>ï¼š</li>
</ul>
<p>â€‹	1ã€å…¨å±€é…ç½®å¼€å¯ï¼ˆé»˜è®¤å·²å¼€å¯ï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹	2ã€åœ¨ Mapper.xml ä¸­å£°æ˜ç¼“å­˜ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç¼“å­˜é…ç½® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cache</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">eviction</span>=<span class="string">&quot;LRU&quot;</span>        &lt;!<span class="attr">--</span> <span class="attr">å›æ”¶ç­–ç•¥</span>ï¼š<span class="attr">LRU</span>ï¼ˆ<span class="attr">æœ€è¿‘æœ€å°‘ä½¿ç”¨</span>ï¼‰/<span class="attr">FIFO</span>ï¼ˆ<span class="attr">å…ˆè¿›å…ˆå‡º</span>ï¼‰<span class="attr">ç­‰</span> <span class="attr">--</span>&gt;</span></span><br><span class="line">    flushInterval=&quot;60000&quot; <span class="comment">&lt;!-- åˆ·æ–°é—´éš”ï¼ˆæ¯«ç§’ï¼‰ --&gt;</span></span><br><span class="line">    size=&quot;512&quot;            <span class="comment">&lt;!-- æœ€å¤§ç¼“å­˜å¯¹è±¡æ•° --&gt;</span></span><br><span class="line">    readOnly=&quot;true&quot;/&gt;     <span class="comment">&lt;!-- æ˜¯å¦åªè¯»ï¼ˆtrueï¼šè¿”å›ç¼“å­˜å¯¹è±¡å‰¯æœ¬ï¼Œæ€§èƒ½å¥½ï¼‰ --&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹	3ã€å®ä½“ç±»éœ€å®ç° Serializable æ¥å£ï¼ˆäºŒçº§ç¼“å­˜å¯èƒ½æ¶‰åŠåºåˆ—åŒ–ï¼‰</p>
<ul>
<li><strong>ç¼“å­˜æ§åˆ¶</strong>ï¼š<ul>
<li><code>useCache=&quot;false&quot;</code>ï¼šå½“å‰æŸ¥è¯¢ä¸ä½¿ç”¨ç¼“å­˜ï¼ˆå¦‚å®æ—¶æ€§è¦æ±‚é«˜çš„æ•°æ®ï¼‰</li>
<li><code>flushCache=&quot;true&quot;</code>ï¼šæ‰§è¡Œåæ¸…ç©ºç¼“å­˜ï¼ˆå¢åˆ æ”¹é»˜è®¤ trueï¼ŒæŸ¥è¯¢é»˜è®¤ falseï¼‰</li>
</ul>
</li>
</ul>
<h5 id="äºŒçº§ç¼“å­˜æ·±åº¦è§£æ"><a href="#äºŒçº§ç¼“å­˜æ·±åº¦è§£æ" class="headerlink" title="äºŒçº§ç¼“å­˜æ·±åº¦è§£æ"></a>äºŒçº§ç¼“å­˜æ·±åº¦è§£æ</h5><p><strong>ï¼ˆ1ï¼‰æŸ¥è¯¢æµç¨‹ä¸å¤šå±‚è£…é¥°ç»“æ„</strong></p>
<p>æŸ¥è¯¢é¡ºåºï¼šäºŒçº§ç¼“å­˜ â†’ ä¸€çº§ç¼“å­˜ â†’ æ•°æ®åº“</p>
<p>äºŒçº§ç¼“å­˜çš„è£…é¥°é“¾ï¼ˆé»˜è®¤ï¼‰ï¼š<code>PerpetualCache</code>ï¼ˆåŸºç¡€ç¼“å­˜ï¼‰â†’ <code>LruCache</code>ï¼ˆæ·˜æ±°ç­–ç•¥ï¼‰â†’ <code>LoggingCache</code>ï¼ˆæ—¥å¿—ï¼‰â†’ <code>SynchronizedCache</code>ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰â†’ â€¦</p>
<p><strong>ï¼ˆ2ï¼‰ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜åŠè§£å†³</strong></p>
<p><strong>é—®é¢˜ç¤ºä¾‹</strong>ï¼šä¸¤ä¸ª SqlSession æ“ä½œåŒä¸€æ•°æ®ï¼ŒSession1 æ›´æ–°åæœªåŒæ­¥åˆ°äºŒçº§ç¼“å­˜ï¼Œå¯¼è‡´ Session2 è¯»å–æ—§æ•°æ®ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Session1æ›´æ–°æ•°æ®</span></span><br><span class="line"><span class="keyword">try</span> (<span class="type">SqlSession</span> <span class="variable">session1</span> <span class="operator">=</span> MybatisUtil.openSession()) &#123;</span><br><span class="line">    session1.getMapper(UserMapper.class).updateUserAge(<span class="number">1</span>, <span class="number">20</span>);</span><br><span class="line">    session1.commit(); <span class="comment">// æäº¤åä¼šæ¸…ç©ºUserMapperçš„äºŒçº§ç¼“å­˜</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Session2æŸ¥è¯¢ï¼ˆæ­¤æ—¶äºŒçº§ç¼“å­˜å·²æ¸…ç©ºï¼Œä¼šæŸ¥æ•°æ®åº“ï¼‰</span></span><br><span class="line"><span class="keyword">try</span> (<span class="type">SqlSession</span> <span class="variable">session2</span> <span class="operator">=</span> MybatisUtil.openSession()) &#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> session2.getMapper(UserMapper.class).selectUserById(<span class="number">1</span>); <span class="comment">// å¾—åˆ°æœ€æ–°æ•°æ®</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è§£å†³</strong>ï¼šMyBatis åœ¨ DML æ“ä½œåä¼šè‡ªåŠ¨æ¸…ç©ºå½“å‰ Mapper çš„äºŒçº§ç¼“å­˜ï¼ˆå› <code>flushCache=&quot;true&quot;</code>é»˜è®¤å¼€å¯ï¼‰ï¼Œç¡®ä¿ç¼“å­˜ä¸€è‡´æ€§ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰eviction å±æ€§çš„ç¼“å­˜æ·˜æ±°ç®—æ³•</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">eviction</span>=<span class="string">&quot;FIFO&quot;</span> &lt;!<span class="attr">--</span> <span class="attr">å¯é€‰å€¼</span>ï¼š</span></span><br><span class="line"><span class="tag">                     <span class="attr">LRU</span>ï¼ˆ<span class="attr">æœ€è¿‘æœ€å°‘ä½¿ç”¨</span>ï¼Œ<span class="attr">é»˜è®¤</span>ï¼‰</span></span><br><span class="line"><span class="tag">                     <span class="attr">FIFO</span>ï¼ˆ<span class="attr">å…ˆè¿›å…ˆå‡º</span>ï¼‰</span></span><br><span class="line"><span class="tag">                     <span class="attr">SOFT</span>ï¼ˆ<span class="attr">è½¯å¼•ç”¨</span>ï¼Œ<span class="attr">å†…å­˜ä¸è¶³æ—¶æ·˜æ±°</span>ï¼‰</span></span><br><span class="line"><span class="tag">                     <span class="attr">WEAK</span>ï¼ˆ<span class="attr">å¼±å¼•ç”¨</span>ï¼Œ<span class="attr">åƒåœ¾å›æ”¶æ—¶æ·˜æ±°</span>ï¼‰</span></span><br><span class="line"><span class="tag">                    <span class="attr">--</span>&gt;</span></span><br><span class="line">    size=&quot;1000&quot;/&gt; <span class="comment">&lt;!-- æœ€å¤šç¼“å­˜1000ä¸ªå¯¹è±¡ --&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="6-2-3-è‡ªå®šä¹‰ç¼“å­˜å®ç°"><a href="#6-2-3-è‡ªå®šä¹‰ç¼“å­˜å®ç°" class="headerlink" title="6.2.3 è‡ªå®šä¹‰ç¼“å­˜å®ç°"></a>6.2.3 è‡ªå®šä¹‰ç¼“å­˜å®ç°</h4><h5 id="ï¼ˆ1ï¼‰è‡ªå®šä¹‰-Cache-ç±»"><a href="#ï¼ˆ1ï¼‰è‡ªå®šä¹‰-Cache-ç±»" class="headerlink" title="ï¼ˆ1ï¼‰è‡ªå®šä¹‰ Cache ç±»"></a>ï¼ˆ1ï¼‰è‡ªå®šä¹‰ Cache ç±»</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyRedisCache</span> <span class="keyword">implements</span> <span class="title class_">Cache</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String id; <span class="comment">// ç¼“å­˜å”¯ä¸€æ ‡è¯†ï¼ˆMapperæ¥å£å…¨ç±»åï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate; <span class="comment">// å‡è®¾å·²é…ç½®RedisTemplate</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyRedisCache</span><span class="params">(String id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getId</span><span class="params">()</span> &#123; <span class="keyword">return</span> id; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">putObject</span><span class="params">(Object key, Object value)</span> &#123;</span><br><span class="line">        <span class="comment">// å­˜å…¥Redisï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        redisTemplate.opsForValue().set(key.toString(), value, <span class="number">30</span>, TimeUnit.MINUTES);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getObject</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        <span class="comment">// ä»Redisè·å–</span></span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().get(key.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">removeObject</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        <span class="comment">// ä»Redisåˆ é™¤</span></span><br><span class="line">        redisTemplate.delete(key.toString());</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">clear</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// æ¸…ç©ºå½“å‰Mapperçš„ç¼“å­˜ï¼ˆé€šè¿‡keyå‰ç¼€åŒ¹é…åˆ é™¤ï¼‰</span></span><br><span class="line">        Set&lt;String&gt; keys = redisTemplate.keys(id + <span class="string">&quot;:*&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (keys != <span class="literal">null</span>) redisTemplate.delete(keys);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getSize</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–ç¼“å­˜æ•°é‡ï¼ˆç®€åŒ–å®ç°ï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> redisTemplate.keys(id + <span class="string">&quot;:*&quot;</span>).size();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="ï¼ˆ2ï¼‰å¯ç”¨è‡ªå®šä¹‰ç¼“å­˜ï¼ˆXML-æˆ–æ³¨è§£ï¼‰"><a href="#ï¼ˆ2ï¼‰å¯ç”¨è‡ªå®šä¹‰ç¼“å­˜ï¼ˆXML-æˆ–æ³¨è§£ï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰å¯ç”¨è‡ªå®šä¹‰ç¼“å­˜ï¼ˆXML æˆ–æ³¨è§£ï¼‰"></a>ï¼ˆ2ï¼‰å¯ç”¨è‡ªå®šä¹‰ç¼“å­˜ï¼ˆXML æˆ–æ³¨è§£ï¼‰</h5><ul>
<li><p>XML æ–¹å¼ï¼ˆåœ¨ Mapper.xml ä¸­ï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">&quot;com.example.cache.MyRedisCache&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨è§£æ–¹å¼ï¼ˆåœ¨ Mapper æ¥å£ä¸Šï¼‰ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CacheNamespace(implementation = MyRedisCache.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123; ... &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="6-2-4-ç¼“å­˜æ§åˆ¶å±æ€§è¯¦è§£"><a href="#6-2-4-ç¼“å­˜æ§åˆ¶å±æ€§è¯¦è§£" class="headerlink" title="6.2.4 ç¼“å­˜æ§åˆ¶å±æ€§è¯¦è§£"></a>6.2.4 ç¼“å­˜æ§åˆ¶å±æ€§è¯¦è§£</h4><ul>
<li><p><code>useCache</code>ï¼šæ§åˆ¶æŸ¥è¯¢æ˜¯å¦ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼ˆé»˜è®¤<code>true</code>ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">useCache</span>=<span class="string">&quot;false&quot;</span>&gt;</span> <span class="comment">&lt;!-- ä¸ä½¿ç”¨äºŒçº§ç¼“å­˜ --&gt;</span></span><br><span class="line">    select * from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>flushCache</code>ï¼šæ§åˆ¶æ“ä½œåæ˜¯å¦æ¸…ç©ºäºŒçº§ç¼“å­˜ï¼ˆDML é»˜è®¤<code>true</code>ï¼ŒæŸ¥è¯¢é»˜è®¤<code>false</code>ï¼‰</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span> <span class="attr">flushCache</span>=<span class="string">&quot;true&quot;</span>&gt;</span> <span class="comment">&lt;!-- æŸ¥è¯¢åæ¸…ç©ºäºŒçº§ç¼“å­˜ --&gt;</span></span><br><span class="line">    select * from user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="ä¸ƒã€é«˜çº§ç‰¹æ€§ï¼ˆé€‰å­¦ï¼‰"><a href="#ä¸ƒã€é«˜çº§ç‰¹æ€§ï¼ˆé€‰å­¦ï¼‰" class="headerlink" title="ä¸ƒã€é«˜çº§ç‰¹æ€§ï¼ˆé€‰å­¦ï¼‰"></a>ä¸ƒã€é«˜çº§ç‰¹æ€§ï¼ˆé€‰å­¦ï¼‰</h2><h3 id="7-1-ç±»å‹å¤„ç†å™¨ï¼ˆTypeHandlerï¼‰"><a href="#7-1-ç±»å‹å¤„ç†å™¨ï¼ˆTypeHandlerï¼‰" class="headerlink" title="7.1 ç±»å‹å¤„ç†å™¨ï¼ˆTypeHandlerï¼‰"></a>7.1 ç±»å‹å¤„ç†å™¨ï¼ˆTypeHandlerï¼‰</h3><p>ç”¨äº Java ç±»å‹ä¸ JDBC ç±»å‹çš„è‡ªå®šä¹‰è½¬æ¢ï¼ˆå¦‚ Stringâ†’è‡ªå®šä¹‰å¯¹è±¡ã€Dateâ†’LocalDateï¼‰ã€‚</p>
<h4 id="è‡ªå®šä¹‰ç±»å‹å¤„ç†å™¨ç¤ºä¾‹"><a href="#è‡ªå®šä¹‰ç±»å‹å¤„ç†å™¨ç¤ºä¾‹" class="headerlink" title="è‡ªå®šä¹‰ç±»å‹å¤„ç†å™¨ç¤ºä¾‹"></a>è‡ªå®šä¹‰ç±»å‹å¤„ç†å™¨ç¤ºä¾‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªå®šä¹‰Stringä¸MyStringçš„è½¬æ¢</span></span><br><span class="line"><span class="meta">@MappedJdbcTypes(JdbcType.VARCHAR)</span> <span class="comment">// å…³è”JDBCç±»å‹</span></span><br><span class="line"><span class="meta">@MappedTypes(MyString.class)</span>       <span class="comment">// å…³è”Javaç±»å‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyStringHandler</span> <span class="keyword">extends</span> <span class="title class_">BaseTypeHandler</span>&lt;MyString&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å‚æ•°ï¼ˆJavaâ†’JDBCï¼‰</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNonNullParameter</span><span class="params">(PreparedStatement ps, <span class="type">int</span> i, </span></span><br><span class="line"><span class="params">                                  MyString parameter, JdbcType jdbcType)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        ps.setString(i, parameter.getValue()); <span class="comment">// å­˜å‚¨è‡ªå®šä¹‰å¯¹è±¡çš„å­—ç¬¦ä¸²å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»ç»“æœé›†è·å–ï¼ˆJDBCâ†’Javaï¼‰</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MyString <span class="title function_">getNullableResult</span><span class="params">(ResultSet rs, String columnName)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyString</span>(rs.getString(columnName));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…¶ä»–é‡è½½æ–¹æ³•ï¼ˆæŒ‰åˆ—ç´¢å¼•è·å–ï¼‰</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MyString <span class="title function_">getNullableResult</span><span class="params">(ResultSet rs, <span class="type">int</span> columnIndex)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyString</span>(rs.getString(columnIndex));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MyString <span class="title function_">getNullableResult</span><span class="params">(CallableStatement cs, <span class="type">int</span> columnIndex)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyString</span>(cs.getString(columnIndex));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ³¨å†Œç±»å‹å¤„ç†å™¨"><a href="#æ³¨å†Œç±»å‹å¤„ç†å™¨" class="headerlink" title="æ³¨å†Œç±»å‹å¤„ç†å™¨"></a>æ³¨å†Œç±»å‹å¤„ç†å™¨</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeHandlers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeHandler</span> <span class="attr">handler</span>=<span class="string">&quot;com.example.handler.MyStringHandler&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeHandlers</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2-æ‹¦æˆªå™¨ï¼ˆæ’ä»¶ï¼‰"><a href="#7-2-æ‹¦æˆªå™¨ï¼ˆæ’ä»¶ï¼‰" class="headerlink" title="7.2 æ‹¦æˆªå™¨ï¼ˆæ’ä»¶ï¼‰"></a>7.2 æ‹¦æˆªå™¨ï¼ˆæ’ä»¶ï¼‰</h3><p>ç”¨äºåœ¨ SQL æ‰§è¡Œè¿‡ç¨‹ä¸­æ’å…¥è‡ªå®šä¹‰é€»è¾‘ï¼ˆå¦‚æ—¥å¿—è®°å½•ã€æ€§èƒ½ç›‘æ§ã€SQL æ”¹å†™ï¼‰ã€‚</p>
<h4 id="è‡ªå®šä¹‰æ‹¦æˆªå™¨ç¤ºä¾‹"><a href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨ç¤ºä¾‹" class="headerlink" title="è‡ªå®šä¹‰æ‹¦æˆªå™¨ç¤ºä¾‹"></a>è‡ªå®šä¹‰æ‹¦æˆªå™¨ç¤ºä¾‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Intercepts(&#123; // å£°æ˜æ‹¦æˆªçš„ç›®æ ‡æ–¹æ³•</span></span><br><span class="line"><span class="meta">    @Signature(</span></span><br><span class="line"><span class="meta">        type = Executor.class,       // æ‹¦æˆªçš„æ¥å£</span></span><br><span class="line"><span class="meta">        method = &quot;query&quot;,            // æ‹¦æˆªçš„æ–¹æ³•å</span></span><br><span class="line"><span class="meta">        args = &#123;MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class&#125; // æ–¹æ³•å‚æ•°</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogInterceptor</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹¦æˆªé€»è¾‘</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// 1. å‰ç½®å¤„ç†ï¼ˆå¦‚è®°å½•å¼€å§‹æ—¶é—´ï¼‰</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. æ‰§è¡ŒåŸæ–¹æ³•</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> invocation.proceed();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. åç½®å¤„ç†ï¼ˆå¦‚è®°å½•æ‰§è¡Œæ—¶é—´ï¼‰</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;SQLæ‰§è¡Œæ—¶é—´ï¼š&quot;</span> + (end - start) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”Ÿæˆä»£ç†å¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">plugin</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Plugin.wrap(target, <span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®å±æ€§ï¼ˆä»é…ç½®æ–‡ä»¶è¯»å–ï¼‰</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setProperties</span><span class="params">(Properties properties)</span> &#123;</span><br><span class="line">        <span class="comment">// å¯é€šè¿‡propertiesè·å–é…ç½®å‚æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ³¨å†Œæ‹¦æˆªå™¨"><a href="#æ³¨å†Œæ‹¦æˆªå™¨" class="headerlink" title="æ³¨å†Œæ‹¦æˆªå™¨"></a>æ³¨å†Œæ‹¦æˆªå™¨</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">&quot;com.example.interceptor.LogInterceptor&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- å¯é€‰ï¼šè®¾ç½®æ‹¦æˆªå™¨å±æ€§ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;logLevel&quot;</span> <span class="attr">value</span>=<span class="string">&quot;INFO&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å…«ã€æœ€ä½³å®è·µæ€»ç»“"><a href="#å…«ã€æœ€ä½³å®è·µæ€»ç»“" class="headerlink" title="å…«ã€æœ€ä½³å®è·µæ€»ç»“"></a>å…«ã€æœ€ä½³å®è·µæ€»ç»“</h2><h3 id="8-1-é…ç½®ä¼˜åŒ–"><a href="#8-1-é…ç½®ä¼˜åŒ–" class="headerlink" title="8.1 é…ç½®ä¼˜åŒ–"></a>8.1 é…ç½®ä¼˜åŒ–</h3><ul>
<li><strong>è¿æ¥æ± é…ç½®</strong>ï¼šä½¿ç”¨ POOLED æ•°æ®æºï¼Œå¹¶åˆç†è®¾ç½®è¿æ¥æ± å‚æ•°ï¼ˆåˆå§‹å¤§å°ã€æœ€å¤§æ´»è·ƒæ•°ç­‰ï¼‰</li>
<li><strong>æ—¥å¿—é…ç½®</strong>ï¼šå¼€å‘ç¯å¢ƒå¼€å¯ DEBUG æ—¥å¿—ï¼Œç”Ÿäº§ç¯å¢ƒå…³é—­æˆ–è®¾ä¸º INFOï¼Œä¾¿äºè°ƒè¯•ä¸æ€§èƒ½ä¼˜åŒ–</li>
<li><strong>ç±»å‹åˆ«å</strong>ï¼šä½¿ç”¨åŒ…æ‰«ææ–¹å¼é…ç½®ï¼Œå‡å°‘å…¨ç±»åä¹¦å†™</li>
<li><strong>é©¼å³°æ˜ å°„</strong>ï¼šå¼€å¯<code>mapUnderscoreToCamelCase</code>ï¼Œå‡å°‘ resultMap é…ç½®</li>
</ul>
<h3 id="8-2-å¼€å‘è§„èŒƒ"><a href="#8-2-å¼€å‘è§„èŒƒ" class="headerlink" title="8.2 å¼€å‘è§„èŒƒ"></a>8.2 å¼€å‘è§„èŒƒ</h3><ul>
<li><strong>SQL ä¸ä»£ç åˆ†ç¦»</strong>ï¼šå¤æ‚ SQL å†™åœ¨ XML ä¸­ï¼Œç®€å• SQL ç”¨æ³¨è§£ï¼Œæé«˜å¯ç»´æŠ¤æ€§</li>
<li><strong>å‚æ•°ä¼ é€’</strong>ï¼šå¤šå‚æ•°ä¼˜å…ˆç”¨ @Param æ³¨è§£ï¼Œé¿å… Map ä¼ é€’ï¼ˆå¯è¯»æ€§å·®ï¼‰</li>
<li><strong>ç»“æœæ˜ å°„</strong>ï¼šå­—æ®µä¸ä¸€è‡´æ—¶ä¼˜å…ˆç”¨ resultMapï¼Œè€Œé SQL åˆ«åï¼ˆæ˜ å°„è§„åˆ™é›†ä¸­ç®¡ç†ï¼‰</li>
<li>å‘½åè§„èŒƒï¼š<ul>
<li>Mapper æ¥å£æ–¹æ³•åä¸ XML ä¸­ id ä¿æŒä¸€è‡´</li>
<li>è¡¨åã€åˆ—åç”¨å°å†™ + ä¸‹åˆ’çº¿ï¼Œå®ä½“ç±»ç”¨é©¼å³°å‘½å</li>
<li>æ˜ å°„æ–‡ä»¶ä¸æ¥å£åŒåŒ…åŒåï¼ˆä¾¿äºåŒ…æ‰«æï¼‰</li>
</ul>
</li>
</ul>
<h3 id="8-3-æ€§èƒ½ä¼˜åŒ–"><a href="#8-3-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="8.3 æ€§èƒ½ä¼˜åŒ–"></a>8.3 æ€§èƒ½ä¼˜åŒ–</h3><h4 id="æ‰¹é‡æ“ä½œï¼š"><a href="#æ‰¹é‡æ“ä½œï¼š" class="headerlink" title="æ‰¹é‡æ“ä½œï¼š"></a>æ‰¹é‡æ“ä½œï¼š</h4><ul>
<li>æ‰¹é‡æ’å…¥ &#x2F; æ›´æ–°ä½¿ç”¨<code>ExecutorType.BATCH</code>æ¨¡å¼</li>
<li>é¿å…å¾ªç¯è°ƒç”¨å•æ¡ SQLï¼ˆN æ¬¡ç½‘ç»œè¯·æ±‚ï¼‰</li>
</ul>
<p>ä½¿ç”¨<code>ExecutorType.BATCH</code>æ¨¡å¼çš„å®Œæ•´ç¤ºä¾‹åŠæ—¥å¿—åˆ†æï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">SqlSession</span> <span class="variable">session</span> <span class="operator">=</span> sqlSessionFactory.openSession(ExecutorType.BATCH)) &#123; <span class="comment">// æ‰¹å¤„ç†æ‰§è¡Œå™¨</span></span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> session.getMapper(UserMapper.class);</span><br><span class="line">    <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setName(<span class="string">&quot;user&quot;</span> + i);</span><br><span class="line">        mapper.insertUser(user);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ¯500æ¡æäº¤ä¸€æ¬¡ï¼ˆé¿å…å†…å­˜æº¢å‡ºï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">500</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            session.flushStatements(); <span class="comment">// åˆ·å…¥æ•°æ®åº“ï¼ˆæœªæäº¤äº‹åŠ¡ï¼‰</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    session.commit(); <span class="comment">// æœ€ç»ˆæäº¤</span></span><br><span class="line">    System.out.println(<span class="string">&quot;è€—æ—¶ï¼š&quot;</span> + (System.currentTimeMillis() - start) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ—¥å¿—åˆ†æ</strong>ï¼šæ‰¹å¤„ç†æ¨¡å¼ä¸‹ï¼ŒMyBatis ä¼šå°† SQL è¯­å¥é¢„ç¼–è¯‘ä¸€æ¬¡ï¼Œå¤šæ¬¡è®¾ç½®å‚æ•°åæ‰¹é‡æ‰§è¡Œï¼Œæ—¥å¿—ä¸­åªä¼šå‡ºç°ä¸€æ¬¡<code>Preparing: INSERT INTO user(...)</code>ï¼Œé¿å…äº†å•æ¡æ’å…¥çš„å¤šæ¬¡é¢„ç¼–è¯‘å¼€é”€ã€‚</p>
<h4 id="åˆ†é¡µæŸ¥è¯¢ï¼š"><a href="#åˆ†é¡µæŸ¥è¯¢ï¼š" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢ï¼š"></a>åˆ†é¡µæŸ¥è¯¢ï¼š</h4><p><strong>åˆ†é¡µæŸ¥è¯¢å®ç°ï¼ˆPageHelper æ’ä»¶ï¼‰</strong></p>
<p>Mybatis æœ¬èº«ä¸ç›´æ¥æ”¯æŒåˆ†é¡µï¼Œæ¨èä½¿ç”¨ç¬¬ä¸‰æ–¹æ’ä»¶<code>PageHelper</code>ç®€åŒ–åˆ†é¡µé€»è¾‘ï¼š</p>
<p>â€‹	<strong>æ·»åŠ ä¾èµ–</strong>ï¼ˆMavenï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹	<strong>é…ç½®æ’ä»¶</strong>ï¼ˆåœ¨<code>mybatis-config.xml</code>çš„<code>&lt;plugins&gt;</code>æ ‡ç­¾ä¸­ï¼‰ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span> <span class="attr">interceptor</span>=<span class="string">&quot;com.github.pagehelper.PageInterceptor&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ•°æ®åº“æ–¹è¨€ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨æ£€æµ‹ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;helperDialect&quot;</span> <span class="attr">value</span>=<span class="string">&quot;mysql&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åˆ†é¡µå‚æ•°åˆç†åŒ–ï¼ˆé¡µç &lt;=0æŸ¥ç¬¬ä¸€é¡µï¼Œé¡µç &gt;æ€»é¡µæ•°æŸ¥æœ€åä¸€é¡µï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;reasonable&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>â€‹	<strong>ä½¿ç”¨æ–¹å¼</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">SqlSession</span> <span class="variable">session</span> <span class="operator">=</span> MybatisUtil.openSession()) &#123;</span><br><span class="line">    <span class="type">UserMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> session.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. è®¾ç½®åˆ†é¡µå‚æ•°ï¼ˆé¡µç ä»1å¼€å§‹ï¼Œæ¯é¡µ10æ¡ï¼‰</span></span><br><span class="line">    PageHelper.startPage(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ‰§è¡ŒæŸ¥è¯¢ï¼ˆæ— éœ€ä¿®æ”¹SQLï¼Œæ’ä»¶è‡ªåŠ¨æ‹¼æ¥LIMITï¼‰</span></span><br><span class="line">    List&lt;User&gt; users = mapper.selectAllUser();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. å°è£…åˆ†é¡µç»“æœ</span></span><br><span class="line">    Page&lt;User&gt; page = (Page&lt;User&gt;) users;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ€»æ¡æ•°ï¼š&quot;</span> + page.getTotal());</span><br><span class="line">    System.out.println(<span class="string">&quot;æ€»é¡µæ•°ï¼š&quot;</span> + page.getPages());</span><br><span class="line">    System.out.println(<span class="string">&quot;å½“å‰é¡µæ•°æ®ï¼š&quot;</span> + page.getResult());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç¼“å­˜ç­–ç•¥ï¼š"><a href="#ç¼“å­˜ç­–ç•¥ï¼š" class="headerlink" title="ç¼“å­˜ç­–ç•¥ï¼š"></a>ç¼“å­˜ç­–ç•¥ï¼š</h4><ul>
<li>é«˜é¢‘æŸ¥è¯¢ã€ä½é¢‘ä¿®æ”¹çš„æ•°æ®å¼€å¯äºŒçº§ç¼“å­˜</li>
<li>å®æ—¶æ€§è¦æ±‚é«˜çš„æ•°æ®ç¦ç”¨ç¼“å­˜ï¼ˆ<code>useCache=false</code>ï¼‰</li>
</ul>
<h4 id="æŸ¥è¯¢ä¼˜åŒ–ï¼š"><a href="#æŸ¥è¯¢ä¼˜åŒ–ï¼š" class="headerlink" title="æŸ¥è¯¢ä¼˜åŒ–ï¼š"></a>æŸ¥è¯¢ä¼˜åŒ–ï¼š</h4><ul>
<li>é¿å…<code>SELECT *</code>ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ</li>
<li>å…³è”æŸ¥è¯¢ä¼˜å…ˆç”¨ JOINï¼Œé¿å…åµŒå¥—æŸ¥è¯¢å¯¼è‡´çš„ N+1 é—®é¢˜</li>
<li>åˆ†é¡µæŸ¥è¯¢ä½¿ç”¨ Mybatis åˆ†é¡µæ’ä»¶ï¼ˆå¦‚ PageHelperï¼‰</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šå†…å®¹ï¼Œå¯ä»¥ç³»ç»ŸæŒæ¡ Mybatis çš„æ ¸å¿ƒç”¨æ³•ã€é«˜çº§ç‰¹æ€§åŠæœ€ä½³å®è·µï¼Œåœ¨å®é™…å¼€å‘ä¸­æ ¹æ®åœºæ™¯çµæ´»é€‰æ‹©é…ç½®ä¸å®ç°æ–¹å¼ï¼Œæå‡å¼€å‘æ•ˆç‡ä¸ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<h3 id="ä¹ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"><a href="#ä¹ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¹ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"></a>ä¹ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3><h4 id="9-1-æ˜ å°„æ–‡ä»¶ç›¸å…³é”™è¯¯"><a href="#9-1-æ˜ å°„æ–‡ä»¶ç›¸å…³é”™è¯¯" class="headerlink" title="9.1 æ˜ å°„æ–‡ä»¶ç›¸å…³é”™è¯¯"></a>9.1 æ˜ å°„æ–‡ä»¶ç›¸å…³é”™è¯¯</h4><ul>
<li><p><strong>é”™è¯¯ 1ï¼š<code>org.apache.ibatis.binding.BindingException: Invalid bound statement (not found)</code></strong></p>
<p>åŸå› ï¼šMapper æ¥å£ä¸ XML æ˜ å°„æ–‡ä»¶æœªæ­£ç¡®ç»‘å®š</p>
<p>è§£å†³ï¼š</p>
<ol>
<li>ç¡®ä¿ XML çš„<code>namespace</code>ä¸æ¥å£å…¨ç±»åä¸€è‡´</li>
<li>ç¡®ä¿ XML ä¸­<code>id</code>ä¸æ¥å£æ–¹æ³•åä¸€è‡´</li>
<li>æ£€æŸ¥ XML æ–‡ä»¶æ˜¯å¦åœ¨<code>mybatis-config.xml</code>çš„<code>&lt;mappers&gt;</code>ä¸­æ³¨å†Œ</li>
</ol>
</li>
<li><p><strong>é”™è¯¯ 2ï¼š<code>java.io.IOException: Could not find resource mappers/UserMapper.xml</code></strong></p>
<p>åŸå› ï¼šXML æ–‡ä»¶è·¯å¾„é”™è¯¯æˆ–æœªè¢« Maven æ‰“åŒ…</p>
<p>è§£å†³ï¼š</p>
<ol>
<li>Maven é¡¹ç›®ä¸­ï¼ŒXML æ–‡ä»¶è‹¥æ”¾åœ¨<code>src/main/java</code>ä¸‹ï¼Œéœ€åœ¨<code>pom.xml</code>ä¸­æ·»åŠ èµ„æºè¿‡æ»¤ï¼š</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="9-2-å­—æ®µæ˜ å°„é”™è¯¯"><a href="#9-2-å­—æ®µæ˜ å°„é”™è¯¯" class="headerlink" title="9.2 å­—æ®µæ˜ å°„é”™è¯¯"></a>9.2 å­—æ®µæ˜ å°„é”™è¯¯</h4><ul>
<li><p>é”™è¯¯ï¼šæŸ¥è¯¢ç»“æœå­—æ®µä¸º<code>null</code>ï¼ˆå®ä½“ç±»å±æ€§ä¸æ•°æ®åº“åˆ—åä¸ä¸€è‡´ï¼‰</p>
<p>è§£å†³ï¼š</p>
<ol>
<li>å¼€å¯é©¼å³°æ˜ å°„ï¼ˆ<code>mapUnderscoreToCamelCase=true</code>ï¼‰</li>
<li>ä½¿ç”¨<code>resultMap</code>æ‰‹åŠ¨å®šä¹‰æ˜ å°„å…³ç³»</li>
<li>åœ¨ SQL ä¸­ç»™åˆ—åæ·»åŠ åˆ«åï¼ˆå¦‚<code>id as userId</code>ï¼‰</li>
</ol>
</li>
</ul>
<h4 id="9-3-äº‹åŠ¡ç›¸å…³é”™è¯¯"><a href="#9-3-äº‹åŠ¡ç›¸å…³é”™è¯¯" class="headerlink" title="9.3 äº‹åŠ¡ç›¸å…³é”™è¯¯"></a>9.3 äº‹åŠ¡ç›¸å…³é”™è¯¯</h4><ul>
<li><p>é”™è¯¯ï¼šæ’å…¥æ•°æ®åæ•°æ®åº“æ— è®°å½•ï¼ˆæœªæäº¤äº‹åŠ¡ï¼‰</p>
<p>åŸå› ï¼šMybatis é»˜è®¤å…³é—­è‡ªåŠ¨æäº¤ï¼ŒDML æ“ä½œéœ€æ‰‹åŠ¨<code>commit()</code>è§£å†³ï¼šæ‰§è¡Œ<code>session.commit()</code>æˆ–å¼€å¯è‡ªåŠ¨æäº¤ï¼ˆ<code>openSession(true)</code>ï¼‰</p>
</li>
</ul>
<h3 id="åã€Mybatis-ä¸-Spring-æ•´åˆ"><a href="#åã€Mybatis-ä¸-Spring-æ•´åˆ" class="headerlink" title="åã€Mybatis ä¸ Spring æ•´åˆ"></a>åã€Mybatis ä¸ Spring æ•´åˆ</h3><h4 id="10-1-æ ¸å¿ƒä¾èµ–ï¼ˆMavenï¼‰"><a href="#10-1-æ ¸å¿ƒä¾èµ–ï¼ˆMavenï¼‰" class="headerlink" title="10.1 æ ¸å¿ƒä¾èµ–ï¼ˆMavenï¼‰"></a>10.1 æ ¸å¿ƒä¾èµ–ï¼ˆMavenï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Springæ ¸å¿ƒ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Spring JDBCï¼ˆäº‹åŠ¡ç®¡ç†ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Mybatis-Springæ•´åˆåŒ… --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="10-2-Spring-é…ç½®æ–‡ä»¶ï¼ˆapplicationContext-xmlï¼‰"><a href="#10-2-Spring-é…ç½®æ–‡ä»¶ï¼ˆapplicationContext-xmlï¼‰" class="headerlink" title="10.2 Spring é…ç½®æ–‡ä»¶ï¼ˆapplicationContext.xmlï¼‰"></a>10.2 Spring é…ç½®æ–‡ä»¶ï¼ˆapplicationContext.xmlï¼‰</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1. æ•°æ®æºï¼ˆæ›¿æ¢MybatisåŸç”Ÿæ•°æ®æºï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/test?useSSL=false&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2. SqlSessionFactoryï¼ˆç”±Springç®¡ç†ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åŠ è½½Mybatisæ ¸å¿ƒé…ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ‰«ææ˜ å°„æ–‡ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mapperLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:mappers/*.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 3. Mapperæ¥å£æ‰«æï¼ˆè‡ªåŠ¨ç”Ÿæˆä»£ç†å¯¹è±¡ï¼‰ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.example.mapper&quot;</span>/&gt;</span> <span class="comment">&lt;!-- Mapperæ¥å£æ‰€åœ¨åŒ… --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 4. äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- å¼€å¯äº‹åŠ¡æ³¨è§£ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="10-3-æ•´åˆåä½¿ç”¨æ–¹å¼"><a href="#10-3-æ•´åˆåä½¿ç”¨æ–¹å¼" class="headerlink" title="10.3 æ•´åˆåä½¿ç”¨æ–¹å¼"></a>10.3 æ•´åˆåä½¿ç”¨æ–¹å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. æ³¨å…¥Mapperæ¥å£ï¼ˆSpringè‡ªåŠ¨ç®¡ç†ï¼‰</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. äº‹åŠ¡æ§åˆ¶ï¼ˆé€šè¿‡æ³¨è§£ï¼‰</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        userMapper.insertUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

    
    <section class="post-copyright">
      
      <p class="copyright-item">
        <span>ä½œè€…:</span>
        <span>è€æ±Ÿæ¹–</span>
      </p>
        
      <p class="copyright-item">
        <span>è®¸å¯è¯:</span>
        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
      </p>
       
      <p class="copyright-item">
        <span>å£å·:</span>
        <span><strong>ä»£ç æ˜¯å¼€æºçš„,æˆ‘ä»¬åªæ˜¯å®ƒçš„æ¬è¿å·¥ã€‚</strong></span>
      </p>
       
        <p class="copyright-item">
        <span>å¦‚æœè§‰å¾—æˆ‘çš„æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œè¯·éšæ„è½¬è½½ï¼Œæ„Ÿè°¢æ”¯æŒï¼</span>
      </p>
      
             
        <p class="copyright-item">
        <span>å¦‚æœ‰ä¾µæƒè¯·å‘ŠçŸ¥åˆ é™¤ğŸ™</span>
      </p>
             
        <p class="copyright-item">
        <span>å¦‚æœä½ æœ‰å¾ˆå¥½çš„æƒ³æ³•ğŸ’¡ï¼Œè¯·åŠ¡å¿…è”ç³»æˆ‘ã€‚ </span>
        <br>
         <span>2292360909@qq.com</span>
      </p>
    </section>
    
    <section class="post-tags">
      <div>
        <span>æ ‡ç­¾:</span>
        <span class="tag">
           
          <a href="/tags/Mybatis/"># Mybatis</a>
           
        </span>
      </div>
      <div>
        <a href="javascript:window.history.back();">è¿”å›</a>
        <span>Â· </span>
        <a href="/">é¦–é¡µ</a>
      </div>
    </section>
    <section class="post-nav">
      
      <a class="prev" rel="prev" href="/2025/10/15/java/Mybatis-plus%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/"
        >Mybatis-pluså¿«é€Ÿä¸Šæ‰‹</a
      >
       
      <a class="next" rel="next" href="/2025/10/15/java/Lombok%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/"
        >Lombokå¿«é€Ÿä¸Šæ‰‹</a
      >
      
    </section>

    <!-- Giscus è¯„è®ºåŒºæŒ‚è½½ç‚¹ -->
<div id="giscus-container" style="margin-top: 2.5rem;"></div>

<!-- Giscus åŠ¨æ€åŠ è½½è„šæœ¬ï¼šåˆå§‹åŠ è½½ + æ˜æš—ä¸»é¢˜åˆ‡æ¢ -->
<script>
  function createGiscus(theme) {
    const giscusContainer = document.getElementById('giscus-container');
    if (!giscusContainer) return;

    // æ¸…é™¤æ—§çš„è¯„è®º iframe
    giscusContainer.innerHTML = '';

    const script = document.createElement('script');
    script.src = 'https://giscus.app/client.js';

    // æ›¿æ¢ä¸ºä½ çš„ GitHub ä»“åº“ä¿¡æ¯ï¼ˆæ ¼å¼ï¼šusername/repoï¼‰
    script.setAttribute('data-repo', 'meisijiya/meisijiya.github.io');

   // æ›¿æ¢ä¸ºä½ çš„ repo-id å’Œ category-idï¼ˆåœ¨ giscus.app é…ç½®é¡µé¢ç”Ÿæˆï¼‰
    script.setAttribute('data-repo-id', 'R_kgDOPwTrpQ');
    script.setAttribute('data-category', 'Announcements');
    script.setAttribute('data-category-id', 'DIC_kwDOPwTrpc4CviGR');

    // å…¶ä»–å¸¸è§„æ¨èè®¾ç½®
    script.setAttribute('data-mapping', 'pathname');           // ç”¨é¡µé¢è·¯å¾„åŒ¹é…è¯„è®ºå¸–
    script.setAttribute('data-strict', '0');                   // è‹¥æ— åŒ¹é…å¸–åˆ™åˆ›å»ºæ–°å¸–
    script.setAttribute('data-reactions-enabled', '1');        // å¯ç”¨è¡¨æƒ…ååº”
    script.setAttribute('data-emit-metadata', '0');            // ä¸è¾“å‡ºå…ƒæ•°æ®
    script.setAttribute('data-input-position', 'top');         // è¾“å…¥æ¡†åœ¨è¯„è®ºä¸Šæ–¹
    script.setAttribute('data-theme', theme);                
    script.setAttribute('data-lang', 'zh-CN');                 // ä¸­æ–‡ç•Œé¢
    script.setAttribute('crossorigin', 'anonymous');           // è·¨åŸŸèµ„æºå®‰å…¨
    script.async = true;                                       
     
    giscusContainer.appendChild(script);
  }

  function getCurrentTheme() {
    return document.body.classList.contains('dark-theme') ? 'dark' : 'light';
  }

  document.addEventListener('DOMContentLoaded', () => {
    // é¡µé¢é¦–æ¬¡åŠ è½½ï¼Œæ ¹æ®å½“å‰ä¸»é¢˜æŒ‚è½½è¯„è®º
    createGiscus(getCurrentTheme());

    // ç›‘å¬æŒ‰é’®ç‚¹å‡»åˆ‡æ¢ä¸»é¢˜ â†’ é‡è½½è¯„è®ºåŒº
    const buttons = [
      document.querySelector('.toggleBtn'),
      document.getElementById('mobile-toggle-theme')
    ];
    buttons.forEach(btn => {
      if (!btn) return;
      btn.addEventListener('click', () => {
        setTimeout(() => {
          createGiscus(getCurrentTheme());
        }, 400); // ç¨ä½œå»¶è¿Ÿï¼Œç¡®ä¿ class åˆ‡æ¢å®Œæ¯•
      });
    });

    // ç›‘å¬ body class æ”¹å˜ï¼ˆä¿é™©æ–¹æ¡ˆï¼‰
    const observer = new MutationObserver(() => {
      createGiscus(getCurrentTheme());
    });
    observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });
  });
</script>

  </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© è€æ±Ÿæ¹– | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
<script src="/js/code-copy.js"></script>


    </div>
</body>
<!-- umami -->
<script defer src="https://cloud.umami.is/script.js" data-website-id="91b923f2-ff2d-43d0-ba5f-bc348d82426a"></script>
</html>