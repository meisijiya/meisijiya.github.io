<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="老江湖">


    <meta name="subtitle" content="记录进入房间门后的美好">


    <meta name="description" content="一年前，孤苦伶仃的老江湖，偶然间发现一处房间门，推门而入，从此进入了充满幸福的世界。">


    <meta name="keywords" content="老江湖,博客,房间门">


<title>欢迎来到老江湖的博客</title>



    <link rel="icon" href="/images/%E9%87%91%E6%AF%9B.png?_t=1758006391547">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    
    <link rel="stylesheet" href="/css/search.css">
    

<!-- highlight.js 样式（默认亮色） -->
<link id="hljs-theme" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/github.css">
<!-- highlight.js 自动上色功能 -->
<script src="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/lib/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

<link rel="stylesheet" href="/css/custom.css">



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const pagebody = document.getElementsByTagName('body')[0]

            function setTheme(status) {

                if (status === 'dark') {
                    window.sessionStorage.theme = 'dark'
                    pagebody.classList.add('dark-theme');

                } else if (status === 'light') {
                    window.sessionStorage.theme = 'light'
                    pagebody.classList.remove('dark-theme');
                }
            };

            setTheme(window.sessionStorage.theme)
        })();
    </script>

    <div class="wrapper">
        <header>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-header header-logo">
        <a href="/">老江湖的博客</a>
      </div>
      <div class="menu navbar-right">
        <!-- 在电脑端的导航链接区域添加搜索功能 -->
        <div class="search-container">
          <a href="javascript:;" onclick="toggleSearchInput()">🔍</a>
          <input
            type="text"
            id="nav-search-input-desktop"
            class="nav-search-input"
            placeholder="想知道我什么秘密呢，搜搜看吧"
            oninput="navSearch(this)"
          />
          <div id="nav-search-result-desktop" class="nav-search-result"></div>
        </div>

        
        <a class="menu-item" href="/archives">归档</a>
        
        <a class="menu-item" href="/category">分类</a>
        
        <a class="menu-item" href="/tag">标签</a>
        
        <a class="menu-item" href="/Timer">任务计时器</a>
        
        <a class="menu-item" href="/timeLine">时间线</a>
        
        <a class="menu-item" href="/tongji">网站统计</a>
        
        <a class="menu-item" href="/about">关于</a>
        

        <input id="switch_default" type="checkbox" class="switch_default" />
        <label for="switch_default" class="toggleBtn"></label>
      </div>
    </div>
  </nav>

  
  <nav class="navbar-mobile" id="nav-mobile">
    <div class="container">
      <div class="navbar-header">
        <div>
          <a href="/">老江湖的博客</a
          ><a id="mobile-toggle-theme">·&nbsp;Light</a>
        </div>

        <div class="menu-toggle" onclick="mobileBtn()">
          <svg
            class="menu-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="32"
            height="32"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M4.5 17.27q-.213 0-.356-.145T4 16.768t.144-.356t.356-.143h15q.213 0 .356.144q.144.144.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.144T4 11.999t.144-.356t.356-.143h15q.213 0 .356.144t.144.357t-.144.356t-.356.143zm0-4.77q-.213 0-.356-.143Q4 7.443 4 7.23t.144-.356t.356-.143h15q.213 0 .356.144T20 7.23t-.144.356t-.356.144z"
            />
          </svg>
          <svg
            class="close-icon"
            xmlns="http://www.w3.org/2000/svg"
            width="32"
            height="32"
            viewBox="0 0 24 24"
          >
            <!-- Icon from Material Symbols Light by Google - https://github.com/google/material-design-icons/blob/master/LICENSE -->
            <path
              fill="currentColor"
              d="m12 12.708l-5.246 5.246q-.14.14-.344.15t-.364-.15t-.16-.354t.16-.354L11.292 12L6.046 6.754q-.14-.14-.15-.344t.15-.364t.354-.16t.354.16L12 11.292l5.246-5.246q.14-.14.345-.15q.203-.01.363.15t.16.354t-.16.354L12.708 12l5.246 5.246q.14.14.15.345q.01.203-.15.363t-.354.16t-.354-.16z"
            />
          </svg>
        </div>
      </div>

      <div class="menu" id="mobile-menu">
        
        <a class="menu-item" href="/archives">归档</a>
        
        <a class="menu-item" href="/category">分类</a>
        
        <a class="menu-item" href="/tag">标签</a>
        
        <a class="menu-item" href="/Timer">任务计时器</a>
        
        <a class="menu-item" href="/timeLine">时间线</a>
        
        <a class="menu-item" href="/tongji">网站统计</a>
        
        <a class="menu-item" href="/about">关于</a>
        
        <!-- 手机模式搜索框 -->
        <div class="search-container mobile-container">
          <a class="menu-item" href="javascript:;" onclick="toggleSearchInput()"
            >🔍</a
          >
          <input
            type="text"
            id="nav-search-input-mobile"
            class="nav-search-input"
            placeholder="想知道我什么秘密呢，搜搜看吧"
            oninput="navSearch(this)"
          />
          <div id="nav-search-result-mobile" class="nav-search-result"></div>
        </div>
      </div>
    </div>
  </nav>
</header>
<script>
  var mobileBtn = function f() {
    var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
    var mobileMenu = document.getElementById("mobile-menu");
    if (toggleMenu.classList.contains("active")) {
      toggleMenu.classList.remove("active");
      mobileMenu.classList.remove("active");
    } else {
      toggleMenu.classList.add("active");
      mobileMenu.classList.add("active");
    }
  };

  function toggleSearchInput() {
    const inputs = document.querySelectorAll(".nav-search-input");
    const results = document.querySelectorAll(".nav-search-result");
    inputs.forEach((input) => {
      input.classList.toggle("active");
      if (input.classList.contains("active")) input.focus();
    });
    results.forEach((r) => (r.style.display = "none"));
  }

  // 点击外部区域隐藏搜索框和结果容器的函数
  function handleClickOutsideSearch(event) {
    const searchContainers = document.querySelectorAll(".search-container");
    searchContainers.forEach((container) => {
      const searchInput = container.querySelector(".nav-search-input");
      const searchIcon = container.querySelector("a");

      // 如果点击的元素不是搜索输入框或搜索图标，则隐藏搜索框和结果容器
      if (
        !searchInput.contains(event.target) &&
        !searchIcon.contains(event.target)
      ) {
        searchInput.classList.remove("active");
        searchInput.value = ""
        // 根据输入框ID确定对应的结果容器
        let resultContainer;
        if (searchInput.id === "nav-search-input-mobile") {
          // 移动端结果容器
          resultContainer = document.querySelector(
            ".navbar-mobile .nav-search-result"
          );
        } else {
          // 桌面端结果容器
          resultContainer = document.getElementById(
            "nav-search-result-desktop"
          );
        }

        if (resultContainer) {
          resultContainer.style.display = "none";
          resultContainer.innerHTML = ""; // 清空结果容器内容
        }
      }
    });
  }

  // 添加全局点击事件监听器
  document.addEventListener("click", function (event) {
    handleClickOutsideSearch(event);
  });

  // 新增：搜索功能实现
  let searchData = []; // 全局变量存储搜索数据

  // 页面加载完成后获取搜索数据
  document.addEventListener("DOMContentLoaded", function () {
    fetch("/search.xml")
      .then((res) => res.text())
      .then((xmlText) => {
        const parser = new DOMParser();
        const xml = parser.parseFromString(xmlText, "text/xml");
        const entries = xml.getElementsByTagName("entry");
        for (let entry of entries) {
          searchData.push({
            title: entry.getElementsByTagName("title")[0]?.textContent || "",
            content:
              entry.getElementsByTagName("content")[0]?.textContent || "",
            url: entry.getElementsByTagName("url")[0]?.textContent || "",
          });
        }
      })
      .catch((err) => {
        console.error("Failed to load search data:", err);
      });
  });

  // 新增：导航搜索方法
  function navSearch(inputElement) {
    const keyword = inputElement.value.trim().toLowerCase();
    // 查找对应的搜索结果容器
    let resultContainer;

    if (inputElement.id === "nav-search-input-desktop") {
      // 桌面端
      resultContainer = document.getElementById("nav-search-result-desktop");
    } else if (inputElement.id === "nav-search-input-mobile") {
      // 移动端
      resultContainer =
        inputElement.parentNode.querySelector(".nav-search-result");
    }

    if (!resultContainer) return;

    resultContainer.innerHTML = "";

    if (!keyword) {
      resultContainer.style.display = "none";
      return;
    }

    // 显示结果容器
    resultContainer.style.display = "block";

    // 过滤搜索数据
    const results = searchData.filter(
      (data) =>
        (data.title && data.title.toLowerCase().includes(keyword)) ||
        (data.content && data.content.toLowerCase().includes(keyword))
    );

    if (results.length === 0) {
      resultContainer.innerHTML =
        '<p class="no-result">没有结果哟，换个关键词试试吧</p>';
      return;
    }

    // 限制显示结果数量
    const maxResults = 10;
    const limitedResults = results.slice(0, maxResults);

    // 构建结果HTML
    const html = limitedResults
      .map((item) => {
        // 提取包含关键字的内容片段
        let contentSnippet = "";
        if (item.content) {
          // 找到包含关键字的内容片段
          const contentLower = item.content.toLowerCase();
          const keywordIndex = contentLower.indexOf(keyword);

          // 提取关键字前后的内容
          const start = Math.max(0, keywordIndex - 3 * keyword.length);
          const end = Math.min(
            item.content.length,
            keywordIndex + 3 * keyword.length
          );
          contentSnippet = item.content.substring(start, end);
        // 高亮关键字
      const keywordRegex = new RegExp(`(${keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
      contentSnippet = contentSnippet.replace(
        keywordRegex,
        "<mark>$1</mark>"
      );
        }

        return `<div class="search-result-item">
  <a href="${item.url}">
    <div>标题：${item.title}</div>
    <div>内容：${contentSnippet}</div>
  </a>
</div>`;
      })
      .join("");
    resultContainer.innerHTML = html;
  }
</script>
<style>
  /* 手机端使用flexbox布局搜索容器 */
  .mobile-container {
    display: flex;
    align-items: center;
    flex-direction: row;
    margin-bottom: 10px;
    margin-left: 10px;
    flex-grow: 1;
    max-width: calc(100% - 40px);
  }


  .search-result-item {
  border: 1px solid #ddd; /* 边框 */
  margin: 4px 0; /* 外层间距 */
  padding: 0; /* 无内边距 */
  background: #fff; /* 背景色 */
}

.search-result-item a {
  display: block;
  text-decoration: none;
  color: inherit;
}

.search-result-item div {
  padding: 3px 8px; /* 紧凑的内边距 */
  margin: 0; /* 无外边距 */
  line-height: 1.3; /* 紧凑的行高 */
  word-wrap: break-word; /* 允许长单词换行 */
  white-space: normal; /* 允许正常换行 */
}

.search-result-item div:first-child {
  border-bottom: 1px solid #eee; /* 标题和内容之间的分隔线 */
}


</style>

            <div class="main">
                <div class="container">
    <article class="post-wrap page">
        
        <h2 class="post-title"></h2>
        
        <section class="post-content">
            <!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>任务计时器 | 高效管理你的时间</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        accent: '#F59E0B',
                        danger: '#EF4444',
                        dark: '#1E293B',
                        light: '#F8FAFC'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .timer-shadow {
                box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.1), 0 8px 10px -6px rgba(59, 130, 246, 0.1);
            }
            .card-hover {
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            }
            .progress-bar {
                height: 8px;
                border-radius: 4px;
                background-color: #E5E7EB;
                overflow: hidden;
            }
            .progress-value {
                height: 100%;
                transition: width 0.3s ease;
            }
        }
        
        /* 添加与博客主题一致的样式 */
        body {
            background-color: #fbfbfb;
            color: #161209;
            font-family: 'Microsoft Jhenghei', Lantinghei SC, 'lanting', PingFang SC, Seguo UI, Microsoft Yahei, Arial;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        
        body.dark-theme {
            background-color: #292a2d;
            color: #a9a9b3;
        }
        
        /* 使内容居中并限制最大宽度 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding-left: 1em;
            padding-right: 1em;
        }
        
        /* 头部样式 */
        header {
            background-color: #fbfbfb;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            transition: background-color 0.2s ease;
        }
        
        .dark-theme header {
            background-color: #292a2d;
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        
        /* 按钮样式 */
        .btn {
            transition: all 0.2s ease;
        }
        
        .dark-theme .btn {
            background-color: #3a3a3a;
            color: #e0e0e0;
        }
        
        .dark-theme .btn:hover {
            background-color: #4a4a4a;
        }
        
        /* 卡片样式 */
        .card {
            background-color: #ffffff;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            transition: background-color 0.2s ease, box-shadow 0.2s ease;
        }
        
        .dark-theme .card {
            background-color: #333336;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        /* 表格样式 */
        .dark-theme table thead {
            background-color: #444448;
        }
        
        .dark-theme table td,
        .dark-theme table th {
            border-color: #555559;
        }
        
        /* 进度条样式 */
        .dark-theme .progress-bar {
            background-color: #555559;
        }
        
        /* 输入框样式 */
        .form-input {
            background-color: #ffffff;
            border-color: #d1d5db;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        
        .dark-theme .form-input {
            background-color: #2d2d30;
            border-color: #555559;
            color: #e0e0e0;
        }
        
        .dark-theme .form-input:focus {
            border-color: #3B82F6;
        }
        
        /* 模态框样式 */
        .dark-theme #task-modal {
            background-color: rgba(0, 0, 0, 0.7);
        }
        
        /* 页脚样式 */
        footer {
            background-color: #292a2d;
            color: #a9a9b3;
        }
        
        /* 链接样式 */
        a {
            color: #161209;
            transition: color 0.2s ease;
        }
        
        .dark-theme a {
            color: #a9a9b3;
        }
        
        .dark-theme a:hover {
            color: #ffffff;
        }
    </style>
</head>
<body class="bg-gray-50 text-dark min-h-screen flex flex-col">
    <!-- 顶部导航栏 -->
    <header class="bg-white shadow-sm sticky top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
           <div class="flex items-center space-x-2">
                <i class="fa fa-clock-o text-primary text-2xl"></i>
                <h1 class="text-gray-600 ">任务计时器</h1>
            </div>
            
            <nav class="hidden md:flex items-center space-x-6">
                <a href="#timer" class="text-gray-600 hover:text-primary transition-colors">计时器</a>
                <a href="#tasks" class="text-gray-600 hover:text-primary transition-colors">任务管理</a>
                <a href="#history" class="text-gray-600 hover:text-primary transition-colors">历史记录</a>
            </nav>
            
            <button id="mobile-menu-button" class="md:hidden text-gray-600 hover:text-primary">
                <i class="fa fa-bars text-xl"></i>
            </button>
        </div>
        
        <!-- 移动端菜单 -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100 px-4 py-2">
            <a href="#timer" class="block py-2 text-gray-600 hover:text-primary">计时器</a>
            <a href="#tasks" class="block py-2 text-gray-600 hover:text-primary">任务管理</a>
            <a href="#history" class="block py-2 text-gray-600 hover:text-primary">历史记录</a>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8">
        <!-- 数据存储状态指示器 -->
        <div id="storage-status" class="mb-6 text-right text-sm">
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                <i class="fa fa-check-circle mr-1"></i> 数据已保存
            </span>
        </div>
        
        <!-- 计时器部分 -->
        <section id="timer" class="mb-16">
            <div class="max-w-2xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-2">专注计时器</h2>
                    <p class="text-gray-500">为你的任务设定时间，提高工作效率</p>
                </div>
                
                <div class="bg-white rounded-2xl p-8 timer-shadow card">
                    <!-- 当前任务显示 -->
                    <div class="mb-6 text-center">
                        <h3 id="current-task-name" class="text-xl font-semibold text-gray-700">未选择任务</h3>
                        <p id="current-task-description" class="text-gray-500 text-sm mt-1">请从任务列表中选择一个任务开始计时</p>
                        
                        <!-- 任务进度条 -->
                        <div id="current-task-progress-container" class="mt-4 hidden">
                            <div class="flex justify-between text-sm mb-1">
                                <span id="current-task-progress-text">进度: 0%</span>
                                <span id="current-task-time-info">已用时 / 目标时长</span>
                            </div>
                            <div class="progress-bar">
                                <div id="current-task-progress-bar" class="progress-value bg-primary" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 时间显示 -->
                    <div class="text-center mb-8">
                        <div id="timer-display" class="text-[clamp(2.5rem,8vw,5rem)] font-bold text-primary tracking-tight">
                            00:00:00
                        </div>
                        <div class="flex justify-center mt-2 space-x-2">
                            <span id="timer-status" class="inline-block px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm">
                                准备就绪
                            </span>
                        </div>
                    </div>
                    
                    <!-- 计时器控制按钮 -->
                    <div class="flex flex-wrap justify-center gap-4">
                        <button id="start-timer" class="px-6 py-3 bg-secondary text-white rounded-lg shadow hover:bg-secondary/90 transition-all flex items-center btn">
                            <i class="fa fa-play mr-2"></i> 开始
                        </button>
                        <button id="pause-timer" class="px-6 py-3 bg-accent text-white rounded-lg shadow hover:bg-accent/90 transition-all flex items-center hidden btn">
                            <i class="fa fa-pause mr-2"></i> 暂停
                        </button>
                        <button id="reset-timer" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg shadow hover:bg-gray-300 transition-all flex items-center btn">
                            <i class="fa fa-refresh mr-2"></i> 重置
                        </button>
                        <button id="complete-task" class="px-6 py-3 bg-primary text-white rounded-lg shadow hover:bg-primary/90 transition-all flex items-center hidden btn">
                            <i class="fa fa-check mr-2"></i> 完成
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 任务管理部分 -->
        <section id="tasks" class="mb-16">
            <div class="max-w-4xl mx-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">任务管理</h2>
                    <button id="add-task-button" class="px-4 py-2 bg-primary text-white rounded-lg shadow hover:bg-primary/90 transition-all flex items-center btn">
                        <i class="fa fa-plus mr-2"></i> 添加任务
                    </button>
                </div>
                
                <!-- 任务列表 -->
                <div id="task-list" class="grid gap-4">
                    <!-- 任务卡片将通过JavaScript动态生成 -->
                </div>
                
                <!-- 空状态提示 -->
                <div id="empty-tasks" class="hidden py-16 text-center card">
                    <i class="fa fa-tasks text-gray-300 text-5xl mb-4"></i>
                    <p class="text-gray-500">还没有任务，点击"添加任务"按钮创建你的第一个任务吧</p>
                </div>
            </div>
        </section>
        
        <!-- 历史记录部分 -->
        <section id="history">
            <div class="max-w-4xl mx-auto">
                <h2 class="text-2xl font-bold mb-6">历史记录</h2>
                
                <!-- 历史记录列表 -->
                <div class="bg-white rounded-xl shadow-sm overflow-hidden card">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">任务名称</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">时长</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">开始时间</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="history-list">
                                <!-- 历史记录将通过JavaScript动态生成 -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- 空历史记录提示 -->
                <div id="empty-history" class="hidden py-16 text-center card">
                    <i class="fa fa-history text-gray-300 text-5xl mb-4"></i>
                    <p class="text-gray-500">暂无计时历史记录</p>
                </div>
            </div>
        </section>
    </main>
    
    <!-- 添加/编辑任务模态框 -->
    <div id="task-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4 transform transition-all scale-95 opacity-0" id="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-xl font-bold">添加新任务</h3>
                <button id="close-modal" class="text-gray-500 hover:text-gray-700">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="task-form">
                <input type="hidden" id="task-id">
                
                <div class="mb-4">
                    <label for="task-name" class="block text-sm font-medium text-gray-700 mb-1">任务名称</label>
                    <input type="text" id="task-name" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors form-input" placeholder="输入任务名称" required>
                </div>
                
                <div class="mb-4">
                    <label for="task-description" class="block text-sm font-medium text-gray-700 mb-1">任务描述 (可选)</label>
                    <textarea id="task-description" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors form-input" placeholder="输入任务描述"></textarea>
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-1">目标时长</label>
                    <div class="flex space-x-2">
                        <div class="flex-1">
                            <input type="number" id="task-hours" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors form-input" placeholder="时" min="0">
                        </div>
                        <div class="flex-1">
                            <input type="number" id="task-minutes" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors form-input" placeholder="分" min="0" max="59">
                        </div>
                        <div class="flex-1">
                            <input type="number" id="task-seconds" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors form-input" placeholder="秒" min="0" max="59">
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">设置完成该任务的计划用时</p>
                </div>
                
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancel-task" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors btn">取消</button>
                    <button type="submit" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors btn">保存任务</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- <footer class="bg-dark text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <div class="flex items-center space-x-2">
                        <i class="fa fa-clock-o text-primary"></i>
                        <span class="font-bold">任务计时器</span>
                    </div>
                    <p class="text-gray-400 text-sm mt-1">高效管理你的时间，提升工作效率</p>
                </div>
                
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fa fa-github text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fa fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fa fa-envelope text-xl"></i>
                    </a>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-6 pt-6 text-center text-gray-400 text-sm">
                &copy; 2023 任务计时器 | 用时间创造价值
            </div>
        </div>
    </footer> -->
    
    <script>
        // 全局状态管理
        const state = {
            tasks: [],
            history: [],
            currentTask: null,
            timer: null,
            seconds: 0,
            isRunning: false,
            // 本地存储键名
            storageKey: 'taskTimerData'
        };
        
        // DOM 元素
        const elements = {
            timerDisplay: document.getElementById('timer-display'),
            timerStatus: document.getElementById('timer-status'),
            startTimerBtn: document.getElementById('start-timer'),
            pauseTimerBtn: document.getElementById('pause-timer'),
            resetTimerBtn: document.getElementById('reset-timer'),
            completeTaskBtn: document.getElementById('complete-task'),
            currentTaskName: document.getElementById('current-task-name'),
            currentTaskDescription: document.getElementById('current-task-description'),
            currentTaskProgressContainer: document.getElementById('current-task-progress-container'),
            currentTaskProgressBar: document.getElementById('current-task-progress-bar'),
            currentTaskProgressText: document.getElementById('current-task-progress-text'),
            currentTaskTimeInfo: document.getElementById('current-task-time-info'),
            taskList: document.getElementById('task-list'),
            emptyTasks: document.getElementById('empty-tasks'),
            historyList: document.getElementById('history-list'),
            emptyHistory: document.getElementById('empty-history'),
            addTaskButton: document.getElementById('add-task-button'),
            taskModal: document.getElementById('task-modal'),
            modalContent: document.getElementById('modal-content'),
            modalTitle: document.getElementById('modal-title'),
            closeModal: document.getElementById('close-modal'),
            cancelTask: document.getElementById('cancel-task'),
            taskForm: document.getElementById('task-form'),
            taskId: document.getElementById('task-id'),
            taskName: document.getElementById('task-name'),
            taskDescription: document.getElementById('task-description'),
            taskHours: document.getElementById('task-hours'),
            taskMinutes: document.getElementById('task-minutes'),
            taskSeconds: document.getElementById('task-seconds'),
            mobileMenuButton: document.getElementById('mobile-menu-button'),
            mobileMenu: document.getElementById('mobile-menu'),
            storageStatus: document.getElementById('storage-status')
        };
        
        // 本地存储相关函数
        const saveToLocalStorage = () => {
            try {
                // 准备要保存的数据
                const dataToSave = {
                    tasks: state.tasks,
                    history: state.history
                };
                
                localStorage.setItem(state.storageKey, JSON.stringify(dataToSave));
                
                // 更新存储状态指示器
                updateStorageStatus(true);
            } catch (error) {
                console.error('保存数据到本地存储失败:', error);
                updateStorageStatus(false);
            }
        };
        
        const loadFromLocalStorage = () => {
            try {
                const savedData = localStorage.getItem(state.storageKey);
                if (savedData) {
                    const parsedData = JSON.parse(savedData);
                    
                    // 恢复任务数据
                    if (Array.isArray(parsedData.tasks)) {
                        state.tasks = parsedData.tasks;
                    }
                    
                    // 恢复历史记录
                    if (Array.isArray(parsedData.history)) {
                        state.history = parsedData.history;
                    }
                    
                    return true;
                }
            } catch (error) {
                console.error('从本地存储加载数据失败:', error);
            }
            
            return false;
        };
        
        const updateStorageStatus = (isSaved) => {
            if (isSaved) {
                elements.storageStatus.innerHTML = `
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                        <i class="fa fa-check-circle mr-1"></i> 数据已保存
                    </span>
                `;
            } else {
                elements.storageStatus.innerHTML = `
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                        <i class="fa fa-exclamation-circle mr-1"></i> 数据保存失败
                    </span>
                `;
            }
        };
        
        // 工具函数
        const formatTime = (seconds) => {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;
            return [
                h.toString().padStart(2, '0'),
                m.toString().padStart(2, '0'),
                s.toString().padStart(2, '0')
            ].join(':');
        };
        
        const formatDuration = (seconds) => {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;
            return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        };
        
        // 计算进度百分比
        const calculateProgress = (current, target) => {
            if (target <= 0) return 0;
            return Math.min(100, Math.round((current / target) * 100));
        };
        
        // 获取当前时间的格式化字符串
        const getCurrentTimeString = () => {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            
            // 确定是今天还是昨天
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            if (now >= today) {
                return `今天 ${hours}:${minutes}`;
            } else if (now >= yesterday) {
                return `昨天 ${hours}:${minutes}`;
            } else {
                const month = (now.getMonth() + 1).toString().padStart(2, '0');
                const day = now.getDate().toString().padStart(2, '0');
                return `${month}/${day} ${hours}:${minutes}`;
            }
        };
        
        // 渲染函数
        const renderTimer = () => {
            elements.timerDisplay.textContent = formatTime(state.seconds);
            
            // 更新当前任务进度
            if (state.currentTask && state.currentTask.targetDuration > 0) {
                const totalTime = state.currentTask.duration + state.seconds;
                const progress = calculateProgress(totalTime, state.currentTask.targetDuration);
                
                elements.currentTaskProgressBar.style.width = `${progress}%`;
                elements.currentTaskProgressText.textContent = `进度: ${progress}%`;
                elements.currentTaskTimeInfo.textContent = `${formatDuration(totalTime)} / ${formatDuration(state.currentTask.targetDuration)}`;
                
                // 当进度超过100%时改变颜色
                if (progress >= 100) {
                    elements.currentTaskProgressBar.classList.remove('bg-primary');
                    elements.currentTaskProgressBar.classList.add('bg-accent');
                } else {
                    elements.currentTaskProgressBar.classList.remove('bg-accent');
                    elements.currentTaskProgressBar.classList.add('bg-primary');
                }
            }
            
            if (state.isRunning) {
                elements.timerStatus.textContent = '正在计时';
                elements.timerStatus.className = 'inline-block px-3 py-1 bg-green-100 text-green-600 rounded-full text-sm';
                elements.startTimerBtn.classList.add('hidden');
                elements.pauseTimerBtn.classList.remove('hidden');
                elements.completeTaskBtn.classList.remove('hidden');
            } else {
                if (state.currentTask) {
                    elements.timerStatus.textContent = '已暂停';
                    elements.timerStatus.className = 'inline-block px-3 py-1 bg-yellow-100 text-yellow-600 rounded-full text-sm';
                    elements.startTimerBtn.classList.remove('hidden');
                    elements.pauseTimerBtn.classList.add('hidden');
                    elements.completeTaskBtn.classList.remove('hidden');
                } else {
                    elements.timerStatus.textContent = '准备就绪';
                    elements.timerStatus.className = 'inline-block px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-sm';
                    elements.startTimerBtn.classList.remove('hidden');
                    elements.pauseTimerBtn.classList.add('hidden');
                    elements.completeTaskBtn.classList.add('hidden');
                }
            }
        };
        
        const renderCurrentTask = () => {
            if (state.currentTask) {
                elements.currentTaskName.textContent = state.currentTask.name;
                elements.currentTaskDescription.textContent = state.currentTask.description || '无描述';
                
                // 显示或隐藏进度条
                if (state.currentTask.targetDuration > 0) {
                    elements.currentTaskProgressContainer.classList.remove('hidden');
                } else {
                    elements.currentTaskProgressContainer.classList.add('hidden');
                }
            } else {
                elements.currentTaskName.textContent = '未选择任务';
                elements.currentTaskDescription.textContent = '请从任务列表中选择一个任务开始计时';
                elements.currentTaskProgressContainer.classList.add('hidden');
            }
            
            renderTimer();
        };
        
        const renderTasks = () => {
            elements.taskList.innerHTML = '';
            
            if (state.tasks.length === 0) {
                elements.taskList.classList.add('hidden');
                elements.emptyTasks.classList.remove('hidden');
                return;
            }
            
            elements.taskList.classList.remove('hidden');
            elements.emptyTasks.classList.add('hidden');
            
            state.tasks.forEach(task => {
                const taskCard = document.createElement('div');
                taskCard.className = 'bg-white rounded-xl p-5 shadow-sm card-hover card';
                taskCard.dataset.taskId = task.id;
                
                // 计算任务进度
                const progress = task.targetDuration > 0 ? calculateProgress(task.duration, task.targetDuration) : 0;
                const progressColor = progress >= 100 ? 'bg-accent' : 'bg-primary';
                
                // 格式化目标时长显示
                const targetDurationText = task.targetDuration > 0 ? formatDuration(task.targetDuration) : '未设置';
                
                taskCard.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="w-full">
                            <h3 class="font-semibold text-lg">${task.name}</h3>
                            <p class="text-gray-500 text-sm mt-1">${task.description || '无描述'}</p>
                            
                            ${task.targetDuration > 0 ? `
                            <div class="mt-3">
                                <div class="flex justify-between text-sm mb-1">
                                    <span class="inline-flex items-center text-gray-500">
                                        <i class="fa fa-tasks mr-1"></i> 完成度: ${progress}%
                                    </span>
                                    <span class="inline-flex items-center text-gray-500">
                                        <i class="fa fa-clock-o mr-1"></i> 目标: ${targetDurationText}
                                    </span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-value ${progressColor}" style="width: ${progress}%"></div>
                                </div>
                            </div>
                            ` : ''}
                            
                            <div class="flex items-center mt-3 text-sm">
                                <span class="inline-flex items-center text-gray-500 mr-4">
                                    <i class="fa fa-clock-o mr-1"></i> 已用时: ${formatDuration(task.duration)}
                                </span>
                                <span class="inline-flex items-center text-gray-500">
                                    <i class="fa fa-history mr-1"></i> 最后更新: ${task.lastUpdated || '从未'}
                                </span>
                            </div>
                        </div>
                        <div class="flex space-x-2 ml-4">
                            <button class="start-task-btn p-2 text-secondary hover:bg-secondary/10 rounded-full transition-colors" title="开始此任务">
                                <i class="fa fa-play"></i>
                            </button>
                            <button class="edit-task-btn p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors" title="编辑任务">
                                <i class="fa fa-pencil"></i>
                            </button>
                            <button class="reset-task-btn p-2 text-accent hover:bg-accent/10 rounded-full transition-colors" title="重置进度">
                                <i class="fa fa-refresh"></i>
                            </button>
                            <button class="delete-task-btn p-2 text-danger hover:bg-danger/10 rounded-full transition-colors" title="删除任务">
                                <i class="fa fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                elements.taskList.appendChild(taskCard);
                
                // 添加事件监听
                taskCard.querySelector('.start-task-btn').addEventListener('click', () => {
                    selectTask(task.id);
                });
                
                taskCard.querySelector('.edit-task-btn').addEventListener('click', () => {
                    editTask(task.id);
                });
                
                taskCard.querySelector('.reset-task-btn').addEventListener('click', () => {
                    resetTaskProgress(task.id);
                });
                
                taskCard.querySelector('.delete-task-btn').addEventListener('click', () => {
                    deleteTask(task.id);
                });
            });
        };
        
        const renderHistory = () => {
            elements.historyList.innerHTML = '';
            
            if (state.history.length === 0) {
                elements.historyList.classList.add('hidden');
                elements.emptyHistory.classList.remove('hidden');
                return;
            }
            
            elements.historyList.classList.remove('hidden');
            elements.emptyHistory.classList.add('hidden');
            
            // 按时间倒序显示（最新的在前面）
            const sortedHistory = [...state.history].sort((a, b) => b.id - a.id);
            
            sortedHistory.forEach(record => {
                const row = document.createElement('tr');
                
                const statusClass = record.status === 'completed' 
                    ? 'bg-green-100 text-green-800' 
                    : 'bg-yellow-100 text-yellow-800';
                    
                const statusText = record.status === 'completed' ? '已完成' : '未完成';
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${record.taskName}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-500">${formatDuration(record.duration)}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-500">${record.startTime}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">
                            ${statusText}
                        </span>
                    </td>
                `;
                
                elements.historyList.appendChild(row);
            });
        };
        
        // 计时器控制函数
        const startTimer = () => {
            if (state.isRunning || !state.currentTask) return;
            
            state.isRunning = true;
            state.timer = setInterval(() => {
                state.seconds++;
                renderTimer();
                
                // 每30秒自动保存一次
                if (state.seconds % 30 === 0) {
                    saveToLocalStorage();
                }
            }, 1000);
            
            renderTimer();
        };
        
        const pauseTimer = () => {
            if (!state.isRunning) return;
            
            clearInterval(state.timer);
            state.isRunning = false;
            renderTimer();
            
            // 暂停时保存数据
            saveToLocalStorage();
        };
        
        const resetTimer = () => {
            if (!state.isRunning) return;
            
            clearInterval(state.timer);
            state.isRunning = false;
            state.seconds = 0;
            renderTimer();
            
            // 重置时保存数据
            saveToLocalStorage();
        };
        
        const completeTask = () => {
            if (!state.currentTask) return;
            
            pauseTimer();
            
            // 更新任务总时长
            const taskIndex = state.tasks.findIndex(t => t.id === state.currentTask.id);
            if (taskIndex !== -1) {
                state.tasks[taskIndex].duration += state.seconds;
                state.tasks[taskIndex].lastUpdated = getCurrentTimeString().split(' ')[0];
            }
            
            // 添加到历史记录
            const startTime = getCurrentTimeString();
            
            state.history.push({
                id: Date.now(),
                taskId: state.currentTask.id,
                taskName: state.currentTask.name,
                duration: state.seconds,
                startTime: startTime,
                status: 'completed'
            });
            
            // 重置计时器
            state.currentTask = null;
            state.seconds = 0;
            
            // 重新渲染
            renderCurrentTask();
            renderTimer();
            renderTasks();
            renderHistory();
            
            // 完成任务后保存数据
            saveToLocalStorage();
            
            // 显示完成提示
            alert('任务已完成！');
        };
        
        // 任务管理函数
        const selectTask = (taskId) => {
            // 如果有正在运行的计时器，先暂停
            if (state.isRunning) {
                pauseTimer();
            }
            
            // 查找任务
            const task = state.tasks.find(t => t.id === taskId);
            if (task) {
                state.currentTask = task;
                state.seconds = 0;
                renderCurrentTask();
                
                // 滚动到计时器
                document.getElementById('timer').scrollIntoView({ behavior: 'smooth' });
            }
        };
        
        const addTask = () => {
            elements.modalTitle.textContent = '添加新任务';
            elements.taskId.value = '';
            elements.taskName.value = '';
            elements.taskDescription.value = '';
            elements.taskHours.value = '';
            elements.taskMinutes.value = '';
            elements.taskSeconds.value = '';
            
            openModal();
        };
        
        const editTask = (taskId) => {
            const task = state.tasks.find(t => t.id === taskId);
            if (task) {
                elements.modalTitle.textContent = '编辑任务';
                elements.taskId.value = task.id;
                elements.taskName.value = task.name;
                elements.taskDescription.value = task.description || '';
                
                // 分解目标时长为小时、分钟、秒
                if (task.targetDuration > 0) {
                    const hours = Math.floor(task.targetDuration / 3600);
                    const minutes = Math.floor((task.targetDuration % 3600) / 60);
                    const seconds = task.targetDuration % 60;
                    
                    elements.taskHours.value = hours;
                    elements.taskMinutes.value = minutes;
                    elements.taskSeconds.value = seconds;
                } else {
                    elements.taskHours.value = '';
                    elements.taskMinutes.value = '';
                    elements.taskSeconds.value = '';
                }
                
                openModal();
            }
        };
        
        // 删除任务功能
        const deleteTask = (taskId) => {
            if (confirm('确定要删除这个任务吗？此操作无法撤销。')) {
                // 如果删除的是当前正在计时的任务，先重置计时器
                if (state.currentTask && state.currentTask.id === taskId) {
                    resetTimer();
                    state.currentTask = null;
                    renderCurrentTask();
                }
                
                // 从任务列表中删除任务
                state.tasks = state.tasks.filter(task => task.id !== taskId);
                
                // 从历史记录中删除与该任务相关的记录
                state.history = state.history.filter(record => record.taskId !== taskId);
                
                // 重新渲染界面
                renderTasks();
                renderHistory();
                
                // 保存数据
                saveToLocalStorage();
            }
        };
        
        // 重置任务进度功能
        const resetTaskProgress = (taskId) => {
            if (confirm('确定要重置这个任务的进度吗？这将清除该任务的所有累计时间。')) {
                const taskIndex = state.tasks.findIndex(t => t.id === taskId);
                
                if (taskIndex !== -1) {
                    // 重置任务进度
                    state.tasks[taskIndex].duration = 0;
                    state.tasks[taskIndex].lastUpdated = getCurrentTimeString().split(' ')[0];
                    
                    // 如果是当前任务，也重置计时器
                    if (state.currentTask && state.currentTask.id === taskId) {
                        resetTimer();
                        renderTimer();
                    }
                    
                    // 重新渲染界面
                    renderTasks();
                    
                    // 保存数据
                    saveToLocalStorage();
                }
            }
        };
        
        const saveTask = (e) => {
            e.preventDefault();
            
            const id = elements.taskId.value ? parseInt(elements.taskId.value) : Date.now();
            const name = elements.taskName.value.trim();
            const description = elements.taskDescription.value.trim();
            
            // 计算目标时长（秒）
            const hours = parseInt(elements.taskHours.value) || 0;
            const minutes = parseInt(elements.taskMinutes.value) || 0;
            const seconds = parseInt(elements.taskSeconds.value) || 0;
            const targetDuration = hours * 3600 + minutes * 60 + seconds;
            
            if (!name) return;
            
            const taskIndex = state.tasks.findIndex(t => t.id === id);
            
            if (taskIndex !== -1) {
                // 更新现有任务
                state.tasks[taskIndex].name = name;
                state.tasks[taskIndex].description = description;
                state.tasks[taskIndex].targetDuration = targetDuration;
                state.tasks[taskIndex].lastUpdated = getCurrentTimeString().split(' ')[0];
                
                // 如果是当前任务，更新当前任务信息
                if (state.currentTask && state.currentTask.id === id) {
                    state.currentTask.name = name;
                    state.currentTask.description = description;
                    state.currentTask.targetDuration = targetDuration;
                    renderCurrentTask();
                }
            } else {
                // 添加新任务
                state.tasks.push({
                    id: id,
                    name: name,
                    description: description,
                    duration: 0,
                    targetDuration: targetDuration,
                    lastUpdated: getCurrentTimeString().split(' ')[0]
                });
            }
            
            closeModal();
            renderTasks();
            
            // 保存任务后保存数据
            saveToLocalStorage();
        };
        
        // 模态框控制函数
        const openModal = () => {
            elements.taskModal.classList.remove('hidden');
            // 触发动画
            setTimeout(() => {
                elements.modalContent.classList.remove('scale-95', 'opacity-0');
                elements.modalContent.classList.add('scale-100', 'opacity-100');
            }, 10);
            
            // 聚焦到任务名称输入框
            elements.taskName.focus();
        };
        
        const closeModal = () => {
            elements.modalContent.classList.remove('scale-100', 'opacity-100');
            elements.modalContent.classList.add('scale-95', 'opacity-0');
            
            // 完全隐藏模态框
            setTimeout(() => {
                elements.taskModal.classList.add('hidden');
            }, 300);
        };
        
        // 移动端菜单控制
        const toggleMobileMenu = () => {
            elements.mobileMenu.classList.toggle('hidden');
        };
        
        // 事件监听
        elements.startTimerBtn.addEventListener('click', startTimer);
        elements.pauseTimerBtn.addEventListener('click', pauseTimer);
        elements.resetTimerBtn.addEventListener('click', resetTimer);
        elements.completeTaskBtn.addEventListener('click', completeTask);
        elements.addTaskButton.addEventListener('click', addTask);
        elements.closeModal.addEventListener('click', closeModal);
        elements.cancelTask.addEventListener('click', closeModal);
        elements.taskForm.addEventListener('submit', saveTask);
        elements.mobileMenuButton.addEventListener('click', toggleMobileMenu);
        
        // 点击模态框外部关闭
        elements.taskModal.addEventListener('click', (e) => {
            if (e.target === elements.taskModal) {
                closeModal();
            }
        });
        
        // 页面关闭前保存数据
        window.addEventListener('beforeunload', () => {
            if (state.isRunning) {
                pauseTimer();
                
                // 如果有关联任务，保存当前计时
                if (state.currentTask) {
                    const taskIndex = state.tasks.findIndex(t => t.id === state.currentTask.id);
                    if (taskIndex !== -1) {
                        state.tasks[taskIndex].duration += state.seconds;
                        state.tasks[taskIndex].lastUpdated = getCurrentTimeString().split(' ')[0];
                        
                        // 添加未完成记录
                        const startTime = getCurrentTimeString();
                        state.history.push({
                            id: Date.now(),
                            taskId: state.currentTask.id,
                            taskName: state.currentTask.name,
                            duration: state.seconds,
                            startTime: startTime,
                            status: 'incomplete'
                        });
                    }
                }
            }
            
            saveToLocalStorage();
        });
        
        // 初始化
        const init = () => {
            // 从本地存储加载数据
            const loaded = loadFromLocalStorage();
            
            // // 如果没有加载到数据，添加一些示例任务
            // if (!loaded || state.tasks.length === 0) {
            //     state.tasks = [
            //         { 
            //             id: 1, 
            //             name: '完成项目报告', 
            //             description: '撰写并提交季度项目进展报告', 
            //             duration: 5025, 
            //             targetDuration: 10800, // 3小时
            //             lastUpdated: '今天' 
            //         },
            //         { 
            //             id: 2, 
            //             name: '学习JavaScript', 
            //             description: '学习异步编程和Promise相关知识', 
            //             duration: 11722, 
            //             targetDuration: 14400, // 4小时
            //             lastUpdated: '昨天' 
            //         }
            //     ];
                
            //     state.history = [
            //         { id: 1, taskId: 1, taskName: '完成项目报告', duration: 6330, startTime: '今天 09:30', status: 'completed' },
            //         { id: 2, taskId: 2, taskName: '学习JavaScript', duration: 7510, startTime: '昨天 14:20', status: 'completed' },
            //         { id: 3, taskId: 3, taskName: '准备会议材料', duration: 3322, startTime: '昨天 10:15', status: 'incomplete' }
            //     ];
                
            //     // 保存示例数据
            //     saveToLocalStorage();
            // }
            
            renderTimer();
            renderCurrentTask();
            renderTasks();
            renderHistory();
        };
        
        // 启动应用
        init();
    </script>
</body>
</html>
        </section>
    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© 老江湖 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>
<script src="/js/code-copy.js"></script>


    </div>
</body>
<!-- umami -->
<script defer src="https://cloud.umami.is/script.js" data-website-id="91b923f2-ff2d-43d0-ba5f-bc348d82426a"></script>
</html>